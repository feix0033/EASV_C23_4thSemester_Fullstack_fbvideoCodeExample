"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[179],{445:(Kd,Wv,Qd)=>{var Do={};function He(t){return"function"==typeof t}function Kv(t){const n=t(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}Qd.r(Do),Qd.d(Do,{FirebaseError:()=>yi,SDK_VERSION:()=>vg,_DEFAULT_ENTRY_NAME:()=>br,_addComponent:()=>ll,_addOrOverwriteComponent:()=>mI,_apps:()=>Ir,_clearComponents:()=>E$,_components:()=>pa,_getProvider:()=>yI,_registerComponent:()=>Ls,_removeServiceInstance:()=>w$,deleteApp:()=>vI,getApp:()=>I$,getApps:()=>S$,initializeApp:()=>_g,onLog:()=>_I,registerVersion:()=>Sr,setLogLevel:()=>DI});const Yd=Kv(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function Zd(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class wn{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(He(r))try{r()}catch(s){e=s instanceof Yd?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{Zv(s)}catch(o){e=e??[],o instanceof Yd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Yd(e)}}add(e){var n;if(e&&e!==this)if(this.closed)Zv(e);else{if(e instanceof wn){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Zd(n,e)}remove(e){const{_finalizers:n}=this;n&&Zd(n,e),e instanceof wn&&e._removeParent(this)}}wn.EMPTY=(()=>{const t=new wn;return t.closed=!0,t})();const Qv=wn.EMPTY;function Yv(t){return t instanceof wn||t&&"closed"in t&&He(t.remove)&&He(t.add)&&He(t.unsubscribe)}function Zv(t){He(t)?t():t.unsubscribe()}const Jr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Tu={setTimeout(t,e,...n){const{delegate:r}=Tu;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){const{delegate:e}=Tu;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Xv(t){Tu.setTimeout(()=>{const{onUnhandledError:e}=Jr;if(!e)throw t;e(t)})}function Jv(){}const mN=Xd("C",void 0,void 0);function Xd(t,e,n){return{kind:t,value:e,error:n}}let ei=null;function Au(t){if(Jr.useDeprecatedSynchronousErrorHandling){const e=!ei;if(e&&(ei={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:r}=ei;if(ei=null,n)throw r}}else t()}class Jd extends wn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Yv(e)&&e.add(this)):this.destination=CN}static create(e,n,r){return new wo(e,n,r)}next(e){this.isStopped?th(function vN(t){return Xd("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?th(function yN(t){return Xd("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?th(mN,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const DN=Function.prototype.bind;function eh(t,e){return DN.call(t,e)}class wN{constructor(e){this.partialObserver=e}next(e){const{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Mu(r)}}error(e){const{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Mu(r)}else Mu(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Mu(n)}}}class wo extends Jd{constructor(e,n,r){let i;if(super(),He(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Jr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&eh(e.next,s),error:e.error&&eh(e.error,s),complete:e.complete&&eh(e.complete,s)}):i=e}this.destination=new wN(i)}}function Mu(t){Jr.useDeprecatedSynchronousErrorHandling?function _N(t){Jr.useDeprecatedSynchronousErrorHandling&&ei&&(ei.errorThrown=!0,ei.error=t)}(t):Xv(t)}function th(t,e){const{onStoppedNotification:n}=Jr;n&&Tu.setTimeout(()=>n(t,e))}const CN={closed:!0,next:Jv,error:function EN(t){throw t},complete:Jv},nh="function"==typeof Symbol&&Symbol.observable||"@@observable";function e_(t){return t}let Ct=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){const s=function IN(t){return t&&t instanceof Jd||function bN(t){return t&&He(t.next)&&He(t.error)&&He(t.complete)}(t)&&Yv(t)}(n)?n:new wo(n,r,i);return Au(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=n_(r))((i,s)=>{const o=new wo({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[nh](){return this}pipe(...n){return function t_(t){return 0===t.length?e_:1===t.length?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}(n)(this)}toPromise(n){return new(n=n_(n))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function n_(t){var e;return null!==(e=t??Jr.Promise)&&void 0!==e?e:Promise}const SN=Kv(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let rh=(()=>{class t extends Ct{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new r_(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new SN}next(n){Au(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){Au(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Au(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:i,observers:s}=this;return r||i?Qv:(this.currentObservers=null,s.push(n),new wn(()=>{this.currentObservers=null,Zd(s,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){const n=new Ct;return n.source=this,n}}return t.create=(e,n)=>new r_(e,n),t})();class r_ extends rh{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,e)}error(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==r?r:Qv}}function Eo(t){return e=>{if(function TN(t){return He(t?.lift)}(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Co(t,e,n,r,i){return new AN(t,e,n,r,i)}class AN extends Jd{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function ih(t,e){return Eo((n,r)=>{let i=0;n.subscribe(Co(r,s=>{r.next(t.call(e,s,i++))}))})}function ti(t){return this instanceof ti?(this.v=t,this):new ti(t)}function FN(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=function o_(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=t[s]&&function(o){return new Promise(function(a,u){!function i(s,o,a,u){Promise.resolve(u).then(function(c){s({value:c,done:a})},o)}(a,u,(o=t[s](o)).done,o.value)})}}}const a_=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function u_(t){return He(t?.then)}function c_(t){return He(t[nh])}function l_(t){return Symbol.asyncIterator&&He(t?.[Symbol.asyncIterator])}function d_(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const h_=function PN(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function f_(t){return He(t?.[h_])}function p_(t){return function NN(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(h){r[h]&&(i[h]=function(f){return new Promise(function(p,g){s.push([h,f,p,g])>1||a(h,f)})})}function a(h,f){try{!function u(h){h.value instanceof ti?Promise.resolve(h.value.v).then(c,l):d(s[0][2],h)}(r[h](f))}catch(p){d(s[0][3],p)}}function c(h){a("next",h)}function l(h){a("throw",h)}function d(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:r,done:i}=yield ti(n.read());if(i)return yield ti(void 0);yield yield ti(r)}}finally{n.releaseLock()}})}function g_(t){return He(t?.getReader)}function Un(t){if(t instanceof Ct)return t;if(null!=t){if(c_(t))return function RN(t){return new Ct(e=>{const n=t[nh]();if(He(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(a_(t))return function kN(t){return new Ct(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(u_(t))return function LN(t){return new Ct(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Xv)})}(t);if(l_(t))return m_(t);if(f_(t))return function VN(t){return new Ct(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(g_(t))return function BN(t){return m_(p_(t))}(t)}throw d_(t)}function m_(t){return new Ct(e=>{(function jN(t,e){var n,r,i,s;return function MN(t,e,n,r){return new(n||(n=Promise))(function(s,o){function a(l){try{c(r.next(l))}catch(d){o(d)}}function u(l){try{c(r.throw(l))}catch(d){o(d)}}function c(l){l.done?s(l.value):function i(s){return s instanceof n?s:new n(function(o){o(s)})}(l.value).then(a,u)}c((r=r.apply(t,e||[])).next())})}(this,void 0,void 0,function*(){try{for(n=FN(t);!(r=yield n.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function pr(t,e,n,r=0,i=!1){const s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function y_(t,e,n=1/0){return He(e)?y_((r,i)=>ih((s,o)=>e(r,s,i,o))(Un(t(r,i))),n):("number"==typeof e&&(n=e),Eo((r,i)=>function UN(t,e,n,r,i,s,o,a){const u=[];let c=0,l=0,d=!1;const h=()=>{d&&!u.length&&!c&&e.complete()},f=g=>c<r?p(g):u.push(g),p=g=>{s&&e.next(g),c++;let m=!1;Un(n(g,l++)).subscribe(Co(e,w=>{i?.(w),s?f(w):e.next(w)},()=>{m=!0},void 0,()=>{if(m)try{for(c--;u.length&&c<r;){const w=u.shift();o?pr(e,o,()=>p(w)):p(w)}h()}catch(w){e.error(w)}}))};return t.subscribe(Co(e,f,()=>{d=!0,h()})),()=>{a?.()}}(r,i,t,n)))}const v_=new Ct(t=>t.complete());function oh(t){return t[t.length-1]}function __(t,e=0){return Eo((n,r)=>{n.subscribe(Co(r,i=>pr(r,t,()=>r.next(i),e),()=>pr(r,t,()=>r.complete(),e),i=>pr(r,t,()=>r.error(i),e)))})}function D_(t,e=0){return Eo((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function w_(t,e){if(!t)throw new Error("Iterable cannot be null");return new Ct(n=>{pr(n,e,()=>{const r=t[Symbol.asyncIterator]();pr(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function E_(t,e){return e?function JN(t,e){if(null!=t){if(c_(t))return function KN(t,e){return Un(t).pipe(D_(e),__(e))}(t,e);if(a_(t))return function YN(t,e){return new Ct(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}(t,e);if(u_(t))return function QN(t,e){return Un(t).pipe(D_(e),__(e))}(t,e);if(l_(t))return w_(t,e);if(f_(t))return function ZN(t,e){return new Ct(n=>{let r;return pr(n,e,()=>{r=t[h_](),pr(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void n.error(o)}s?n.complete():n.next(i)},0,!0)}),()=>He(r?.return)&&r.return()})}(t,e);if(g_(t))return function XN(t,e){return w_(p_(t),e)}(t,e)}throw d_(t)}(t,e):Un(t)}function e1(...t){const e=function zN(t){return function GN(t){return t&&He(t.schedule)}(oh(t))?t.pop():void 0}(t),n=function WN(t,e){return"number"==typeof oh(t)?t.pop():e}(t,1/0),r=t;return r.length?1===r.length?Un(r[0]):function $N(t=1/0){return y_(e_,t)}(n)(E_(r,e)):v_}function ah(t,e,...n){if(!0===e)return void t();if(!1===e)return;const r=new wo({next:()=>{r.unsubscribe(),t()}});return Un(e(...n)).subscribe(r)}function ge(t){for(let e in t)if(t[e]===ge)return e;throw Error("Could not find renamed property on target object.")}function uh(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function me(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(me).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function ch(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const n1=ge({__forward_ref__:ge});function ye(t){return t.__forward_ref__=ye,t.toString=function(){return me(this())},t}function V(t){return lh(t)?t():t}function lh(t){return"function"==typeof t&&t.hasOwnProperty(n1)&&t.__forward_ref__===ye}function dh(t){return t&&!!t.\u0275providers}class M extends Error{constructor(e,n){super(xu(e,n)),this.code=e}}function xu(t,e){return`NG0${Math.abs(t)}${e?": "+e.trim():""}`}function z(t){return"string"==typeof t?t:null==t?"":String(t)}function Nu(t,e){throw new M(-201,!1)}function tn(t,e){null==t&&function le(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function ve(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function $n(t){return{providers:t.providers||[],imports:t.imports||[]}}function Fu(t){return b_(t,Ou)||b_(t,S_)}function b_(t,e){return t.hasOwnProperty(e)?t[e]:null}function I_(t){return t&&(t.hasOwnProperty(hh)||t.hasOwnProperty(c1))?t[hh]:null}const Ou=ge({\u0275prov:ge}),hh=ge({\u0275inj:ge}),S_=ge({ngInjectableDef:ge}),c1=ge({ngInjectorDef:ge});var U=(()=>((U=U||{})[U.Default=0]="Default",U[U.Host=1]="Host",U[U.Self=2]="Self",U[U.SkipSelf=4]="SkipSelf",U[U.Optional=8]="Optional",U))();let fh;function nn(t){const e=fh;return fh=t,e}function T_(t,e,n){const r=Fu(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&U.Optional?null:void 0!==e?e:void Nu(me(t))}const De=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),bo={},ph="__NG_DI_FLAG__",Pu="ngTempTokenPath",d1="ngTokenPath",h1=/\n/gm,f1="\u0275",A_="__source";let Io;function Zi(t){const e=Io;return Io=t,e}function p1(t,e=U.Default){if(void 0===Io)throw new M(-203,!1);return null===Io?T_(t,void 0,e):Io.get(t,e&U.Optional?null:void 0,e)}function ae(t,e=U.Default){return(function l1(){return fh}()||p1)(V(t),e)}function Ru(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function gh(t){const e=[];for(let n=0;n<t.length;n++){const r=V(t[n]);if(Array.isArray(r)){if(0===r.length)throw new M(900,!1);let i,s=U.Default;for(let o=0;o<r.length;o++){const a=r[o],u=g1(a);"number"==typeof u?-1===u?i=a.token:s|=u:i=a}e.push(ae(i,s))}else e.push(ae(r))}return e}function So(t,e){return t[ph]=e,t.prototype[ph]=e,t}function g1(t){return t[ph]}function Hn(t){return{toString:t}.toString()}var En=(()=>((En=En||{})[En.OnPush=0]="OnPush",En[En.Default=1]="Default",En))(),Cn=(()=>{return(t=Cn||(Cn={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",Cn;var t})();const Gn={},ue=[],ku=ge({\u0275cmp:ge}),mh=ge({\u0275dir:ge}),yh=ge({\u0275pipe:ge}),N_=ge({\u0275mod:ge}),qn=ge({\u0275fac:ge}),To=ge({__NG_ELEMENT_ID__:ge});let v1=0;function F_(t){return Hn(()=>{const e=P_(t),n={...e,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===En.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,data:t.data||{},encapsulation:t.encapsulation||Cn.Emulated,id:"c"+v1++,styles:t.styles||ue,_:null,schemas:t.schemas||null,tView:null};R_(n);const r=t.dependencies;return n.directiveDefs=Lu(r,!1),n.pipeDefs=Lu(r,!0),n})}function D1(t){return de(t)||dt(t)}function w1(t){return null!==t}function mr(t){return Hn(()=>({type:t.type,bootstrap:t.bootstrap||ue,declarations:t.declarations||ue,imports:t.imports||ue,exports:t.exports||ue,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function O_(t,e){if(null==t)return Gn;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,e&&(e[i]=s)}return n}function W(t){return Hn(()=>{const e=P_(t);return R_(e),e})}function Rt(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function de(t){return t[ku]||null}function dt(t){return t[mh]||null}function kt(t){return t[yh]||null}function P_(t){const e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,exportAs:t.exportAs||null,standalone:!0===t.standalone,selectors:t.selectors||ue,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:O_(t.inputs,e),outputs:O_(t.outputs)}}function R_(t){t.features?.forEach(e=>e(t))}function Lu(t,e){if(!t)return null;const n=e?kt:D1;return()=>("function"==typeof t?t():t).map(r=>n(r)).filter(w1)}const zn=0,N=1,Z=2,Ne=3,ln=4,ni=5,ht=6,Xi=7,Le=8,Vu=9,Bu=10,J=11,vh=12,Mo=13,k_=14,Ji=15,ft=16,xo=17,es=18,bn=19,No=20,L_=21,we=22,_h=1,V_=2,ju=7,Uu=8,ts=9,bt=10;function Wt(t){return Array.isArray(t)&&"object"==typeof t[_h]}function dn(t){return Array.isArray(t)&&!0===t[_h]}function Dh(t){return 0!=(4&t.flags)}function Fo(t){return t.componentOffset>-1}function $u(t){return 1==(1&t.flags)}function hn(t){return!!t.template}function C1(t){return 0!=(256&t[Z])}function ri(t,e){return t.hasOwnProperty(qn)?t[qn]:null}class S1{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function Wn(){return U_}function U_(t){return t.type.prototype.ngOnChanges&&(t.setInput=A1),T1}function T1(){const t=H_(this),e=t?.current;if(e){const n=t.previous;if(n===Gn)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function A1(t,e,n,r){const i=this.declaredInputs[n],s=H_(t)||function M1(t,e){return t[$_]=e}(t,{previous:Gn,current:null}),o=s.current||(s.current={}),a=s.previous,u=a[i];o[i]=new S1(u&&u.currentValue,e,a===Gn),t[r]=e}Wn.ngInherit=!0;const $_="__ngSimpleChanges__";function H_(t){return t[$_]||null}const rn=function(t,e,n){};function st(t){for(;Array.isArray(t);)t=t[zn];return t}function Hu(t,e){return st(e[t])}function Kt(t,e){return st(e[t.index])}function z_(t,e){return t.data[e]}function Lt(t,e){const n=e[t];return Wt(n)?n:n[zn]}function Gu(t){return 64==(64&t[Z])}function yr(t,e){return null==e?null:t[e]}function W_(t){t[es]=0}function Eh(t,e){t[ni]+=e;let n=t,r=t[Ne];for(;null!==r&&(1===e&&1===n[ni]||-1===e&&0===n[ni]);)r[ni]+=e,n=r,r=r[Ne]}const K={lFrame:rD(null),bindingsEnabled:!0};function Q_(){return K.bindingsEnabled}function C(){return K.lFrame.lView}function re(){return K.lFrame.tView}function ot(){let t=Y_();for(;null!==t&&64===t.type;)t=t.parent;return t}function Y_(){return K.lFrame.currentTNode}function In(t,e){const n=K.lFrame;n.currentTNode=t,n.isParent=e}function Ch(){return K.lFrame.isParent}function rs(){return K.lFrame.bindingIndex++}function G1(t,e){const n=K.lFrame;n.bindingIndex=n.bindingRootIndex=t,Ih(e)}function Ih(t){K.lFrame.currentDirectiveIndex=t}function Th(t){K.lFrame.currentQueryIndex=t}function z1(t){const e=t[N];return 2===e.type?e.declTNode:1===e.type?t[ht]:null}function tD(t,e,n){if(n&U.SkipSelf){let i=e,s=t;for(;!(i=i.parent,null!==i||n&U.Host||(i=z1(s),null===i||(s=s[Ji],10&i.type))););if(null===i)return!1;e=i,t=s}const r=K.lFrame=nD();return r.currentTNode=e,r.lView=t,!0}function Ah(t){const e=nD(),n=t[N];K.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function nD(){const t=K.lFrame,e=null===t?null:t.child;return null===e?rD(t):e}function rD(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function iD(){const t=K.lFrame;return K.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const sD=iD;function Mh(){const t=iD();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function St(){return K.lFrame.selectedIndex}function ii(t){K.lFrame.selectedIndex=t}function qu(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:l}=s;o&&(t.contentHooks??(t.contentHooks=[])).push(-n,o),a&&((t.contentHooks??(t.contentHooks=[])).push(n,a),(t.contentCheckHooks??(t.contentCheckHooks=[])).push(n,a)),u&&(t.viewHooks??(t.viewHooks=[])).push(-n,u),c&&((t.viewHooks??(t.viewHooks=[])).push(n,c),(t.viewCheckHooks??(t.viewCheckHooks=[])).push(n,c)),null!=l&&(t.destroyHooks??(t.destroyHooks=[])).push(n,l)}}function zu(t,e,n){oD(t,e,3,n)}function Wu(t,e,n,r){(3&t[Z])===n&&oD(t,e,n,r)}function xh(t,e){let n=t[Z];(3&n)===e&&(n&=2047,n+=1,t[Z]=n)}function oD(t,e,n,r){const s=r??-1,o=e.length-1;let a=0;for(let u=void 0!==r?65535&t[es]:0;u<o;u++)if("number"==typeof e[u+1]){if(a=e[u],null!=r&&a>=r)break}else e[u]<0&&(t[es]+=65536),(a<s||-1==s)&&(tF(t,n,e,u),t[es]=(4294901760&t[es])+u+2),u++}function tF(t,e,n,r){const i=n[r]<0,s=n[r+1],a=t[i?-n[r]:n[r]];if(i){if(t[Z]>>11<t[es]>>16&&(3&t[Z])===e){t[Z]+=2048,rn(4,a,s);try{s.call(a)}finally{rn(5,a,s)}}}else{rn(4,a,s);try{s.call(a)}finally{rn(5,a,s)}}}const is=-1;class Po{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function Fh(t,e,n){let r=0;for(;r<n.length;){const i=n[r];if("number"==typeof i){if(0!==i)break;r++;const s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{const s=i,o=n[++r];uD(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function aD(t){return 3===t||4===t||6===t}function uD(t){return 64===t.charCodeAt(0)}function Ro(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||cD(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function cD(t,e,n,r,i){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const a=t[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<t.length;){const a=t[s];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==i&&(t[s+1]=i));if(r===t[s+1])return void(t[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==r&&t.splice(s++,0,r),null!==i&&t.splice(s++,0,i)}function lD(t){return t!==is}function Ku(t){return 32767&t}function Qu(t,e){let n=function sF(t){return t>>16}(t),r=e;for(;n>0;)r=r[Ji],n--;return r}let Oh=!0;function Yu(t){const e=Oh;return Oh=t,e}const dD=255,hD=5;let oF=0;const Sn={};function Zu(t,e){const n=fD(t,e);if(-1!==n)return n;const r=e[N];r.firstCreatePass&&(t.injectorIndex=e.length,Ph(r.data,t),Ph(e,null),Ph(r.blueprint,null));const i=Rh(t,e),s=t.injectorIndex;if(lD(i)){const o=Ku(i),a=Qu(i,e),u=a[N].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|u[o+c]}return e[s+8]=i,s}function Ph(t,e){t.push(0,0,0,0,0,0,0,0,e)}function fD(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function Rh(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){if(r=DD(i),null===r)return is;if(n++,i=i[Ji],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return is}function kh(t,e,n){!function aF(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(To)&&(r=n[To]),null==r&&(r=n[To]=oF++);const i=r&dD;e.data[t+(i>>hD)]|=1<<i}(t,e,n)}function pD(t,e,n){if(n&U.Optional||void 0!==t)return t;Nu()}function gD(t,e,n,r){if(n&U.Optional&&void 0===r&&(r=null),!(n&(U.Self|U.Host))){const i=t[Vu],s=nn(void 0);try{return i?i.get(e,r,n&U.Optional):T_(e,r,n&U.Optional)}finally{nn(s)}}return pD(r,0,n)}function mD(t,e,n,r=U.Default,i){if(null!==t){if(1024&e[Z]){const o=function hF(t,e,n,r,i){let s=t,o=e;for(;null!==s&&null!==o&&1024&o[Z]&&!(256&o[Z]);){const a=yD(s,o,n,r|U.Self,Sn);if(a!==Sn)return a;let u=s.parent;if(!u){const c=o[L_];if(c){const l=c.get(n,Sn,r);if(l!==Sn)return l}u=DD(o),o=o[Ji]}s=u}return i}(t,e,n,r,Sn);if(o!==Sn)return o}const s=yD(t,e,n,r,Sn);if(s!==Sn)return s}return gD(e,n,r,i)}function yD(t,e,n,r,i){const s=function lF(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(To)?t[To]:void 0;return"number"==typeof e?e>=0?e&dD:dF:e}(n);if("function"==typeof s){if(!tD(e,t,r))return r&U.Host?pD(i,0,r):gD(e,n,r,i);try{const o=s(r);if(null!=o||r&U.Optional)return o;Nu()}finally{sD()}}else if("number"==typeof s){let o=null,a=fD(t,e),u=is,c=r&U.Host?e[ft][ht]:null;for((-1===a||r&U.SkipSelf)&&(u=-1===a?Rh(t,e):e[a+8],u!==is&&_D(r,!1)?(o=e[N],a=Ku(u),e=Qu(u,e)):a=-1);-1!==a;){const l=e[N];if(vD(s,a,l.data)){const d=cF(a,e,n,o,r,c);if(d!==Sn)return d}u=e[a+8],u!==is&&_D(r,e[N].data[a+8]===c)&&vD(s,a,e)?(o=l,a=Ku(u),e=Qu(u,e)):a=-1}}return i}function cF(t,e,n,r,i,s){const o=e[N],a=o.data[t+8],l=function Xu(t,e,n,r,i){const s=t.providerIndexes,o=e.data,a=1048575&s,u=t.directiveStart,l=s>>20,h=i?a+l:t.directiveEnd;for(let f=r?a:a+l;f<h;f++){const p=o[f];if(f<u&&n===p||f>=u&&p.type===n)return f}if(i){const f=o[u];if(f&&hn(f)&&f.type===n)return u}return null}(a,o,n,null==r?Fo(a)&&Oh:r!=o&&0!=(3&a.type),i&U.Host&&s===a);return null!==l?si(e,o,l,a):Sn}function si(t,e,n,r){let i=t[n];const s=e.data;if(function nF(t){return t instanceof Po}(i)){const o=i;o.resolving&&function r1(t,e){const n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new M(-200,`Circular dependency in DI detected for ${t}${n}`)}(function ce(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():z(t)}(s[n]));const a=Yu(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?nn(o.injectImpl):null;tD(t,r,U.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&function eF(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=U_(e);(n.preOrderHooks??(n.preOrderHooks=[])).push(t,o),(n.preOrderCheckHooks??(n.preOrderCheckHooks=[])).push(t,o)}i&&(n.preOrderHooks??(n.preOrderHooks=[])).push(0-t,i),s&&((n.preOrderHooks??(n.preOrderHooks=[])).push(t,s),(n.preOrderCheckHooks??(n.preOrderCheckHooks=[])).push(t,s))}(n,s[n],e)}finally{null!==u&&nn(u),Yu(a),o.resolving=!1,sD()}}return i}function vD(t,e,n){return!!(n[e+(t>>hD)]&1<<t)}function _D(t,e){return!(t&U.Self||t&U.Host&&e)}class ss{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return mD(this._tNode,this._lView,e,Ru(r),n)}}function dF(){return new ss(ot(),C())}function Lh(t){return lh(t)?()=>{const e=Lh(V(t));return e&&e()}:ri(t)}function DD(t){const e=t[N],n=e.type;return 2===n?e.declTNode:1===n?t[ht]:null}const as="__parameters__";function cs(t,e,n){return Hn(()=>{const r=function Bh(t){return function(...n){if(t){const r=t(...n);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(u,c,l){const d=u.hasOwnProperty(as)?u[as]:Object.defineProperty(u,as,{value:[]})[as];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}class ${constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=ve({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function oi(t,e){t.forEach(n=>Array.isArray(n)?oi(n,e):e(n))}function ED(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Ju(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Qt(t,e,n){let r=ls(t,e);return r>=0?t[1|r]=n:(r=~r,function mF(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function Uh(t,e){const n=ls(t,e);if(n>=0)return t[1|n]}function ls(t,e){return function CD(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){const s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}(t,e,1)}const tc=So(cs("Optional"),8),nc=So(cs("SkipSelf"),4);var Vt=(()=>((Vt=Vt||{})[Vt.Important=1]="Important",Vt[Vt.DashCase=2]="DashCase",Vt))();const Wh=new Map;let VF=0;const Qh="__ngContext__";function gt(t,e){Wt(e)?(t[Qh]=e[No],function jF(t){Wh.set(t[No],t)}(e)):t[Qh]=e}let Yh;function Zh(t,e){return Yh(t,e)}function $o(t){const e=t[Ne];return dn(e)?e[Ne]:e}function Xh(t){return HD(t[Mo])}function Jh(t){return HD(t[ln])}function HD(t){for(;null!==t&&!dn(t);)t=t[ln];return t}function hs(t,e,n,r,i){if(null!=r){let s,o=!1;dn(r)?s=r:Wt(r)&&(o=!0,r=r[zn]);const a=st(r);0===t&&null!==n?null==i?QD(e,n,a):ai(e,n,a,i||null,!0):1===t&&null!==n?ai(e,n,a,i||null,!0):2===t?function af(t,e,n){const r=sc(t,e);r&&function oO(t,e,n,r){t.removeChild(e,n,r)}(t,r,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function cO(t,e,n,r,i){const s=n[ju];s!==st(n)&&hs(e,t,r,s,i);for(let a=bt;a<n.length;a++){const u=n[a];Ho(u[N],u,t,e,r,s)}}(e,t,s,n,i)}}function tf(t,e,n){return t.createElement(e,n)}function qD(t,e){const n=t[ts],r=n.indexOf(e),i=e[Ne];512&e[Z]&&(e[Z]&=-513,Eh(i,-1)),n.splice(r,1)}function nf(t,e){if(t.length<=bt)return;const n=bt+e,r=t[n];if(r){const i=r[xo];null!==i&&i!==t&&qD(i,r),e>0&&(t[n-1][ln]=r[ln]);const s=Ju(t,bt+e);!function XF(t,e){Ho(t,e,e[J],2,null,null),e[zn]=null,e[ht]=null}(r[N],r);const o=s[bn];null!==o&&o.detachView(s[N]),r[Ne]=null,r[ln]=null,r[Z]&=-65}return r}function zD(t,e){if(!(128&e[Z])){const n=e[J];n.destroyNode&&Ho(t,e,n,3,null,null),function tO(t){let e=t[Mo];if(!e)return rf(t[N],t);for(;e;){let n=null;if(Wt(e))n=e[Mo];else{const r=e[bt];r&&(n=r)}if(!n){for(;e&&!e[ln]&&e!==t;)Wt(e)&&rf(e[N],e),e=e[Ne];null===e&&(e=t),Wt(e)&&rf(e[N],e),n=e&&e[ln]}e=n}}(e)}}function rf(t,e){if(!(128&e[Z])){e[Z]&=-65,e[Z]|=128,function sO(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const i=e[n[r]];if(!(i instanceof Po)){const s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],u=s[o+1];rn(4,a,u);try{u.call(a)}finally{rn(5,a,u)}}else{rn(4,i,s);try{s.call(i)}finally{rn(5,i,s)}}}}}(t,e),function iO(t,e){const n=t.cleanup,r=e[Xi];let i=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+3];o>=0?r[i=o]():r[i=-o].unsubscribe(),s+=2}else{const o=r[i=n[s+1]];n[s].call(o)}if(null!==r){for(let s=i+1;s<r.length;s++)(0,r[s])();e[Xi]=null}}(t,e),1===e[N].type&&e[J].destroy();const n=e[xo];if(null!==n&&dn(e[Ne])){n!==e[Ne]&&qD(n,e);const r=e[bn];null!==r&&r.detachView(t)}!function UF(t){Wh.delete(t[No])}(e)}}function WD(t,e,n){return function KD(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[zn];{const{componentOffset:i}=r;if(i>-1){const{encapsulation:s}=t.data[r.directiveStart+i];if(s===Cn.None||s===Cn.Emulated)return null}return Kt(r,n)}}(t,e.parent,n)}function ai(t,e,n,r,i){t.insertBefore(e,n,r,i)}function QD(t,e,n){t.appendChild(e,n)}function YD(t,e,n,r,i){null!==r?ai(t,e,n,r,i):QD(t,e,n)}function sc(t,e){return t.parentNode(e)}let sf,lf,JD=function XD(t,e,n){return 40&t.type?Kt(t,n):null};function oc(t,e,n,r){const i=WD(t,r,e),s=e[J],a=function ZD(t,e,n){return JD(t,e,n)}(r.parent||e[ht],r,e);if(null!=i)if(Array.isArray(n))for(let u=0;u<n.length;u++)YD(s,i,n[u],a,!1);else YD(s,i,n,a,!1);void 0!==sf&&sf(s,r,e,n,i)}function ac(t,e){if(null!==e){const n=e.type;if(3&n)return Kt(e,t);if(4&n)return of(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return ac(t,r);{const i=t[e.index];return dn(i)?of(-1,i):st(i)}}if(32&n)return Zh(e,t)()||st(t[e.index]);{const r=tw(t,e);return null!==r?Array.isArray(r)?r[0]:ac($o(t[ft]),r):ac(t,e.next)}}return null}function tw(t,e){return null!==e?t[ft][ht].projection[e.projection]:null}function of(t,e){const n=bt+t+1;if(n<e.length){const r=e[n],i=r[N].firstChild;if(null!==i)return ac(r,i)}return e[ju]}function uf(t,e,n,r,i,s,o){for(;null!=n;){const a=r[n.index],u=n.type;if(o&&0===e&&(a&&gt(st(a),r),n.flags|=2),32!=(32&n.flags))if(8&u)uf(t,e,n.child,r,i,s,!1),hs(e,t,i,a,s);else if(32&u){const c=Zh(n,r);let l;for(;l=c();)hs(e,t,i,l,s);hs(e,t,i,a,s)}else 16&u?nw(t,e,r,n,i,s):hs(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Ho(t,e,n,r,i,s){uf(n,r,t.firstChild,e,i,s,!1)}function nw(t,e,n,r,i,s){const o=n[ft],u=o[ht].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++)hs(e,t,i,u[c],s);else uf(t,e,u,o[Ne],i,s,!0)}function rw(t,e,n){""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function iw(t,e,n){const{mergedAttrs:r,classes:i,styles:s}=n;null!==r&&Fh(t,e,r),null!==i&&rw(t,e,i),null!==s&&function dO(t,e,n){t.setAttribute(e,"style",n)}(t,e,s)}class cw{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}const vw=new $("ENVIRONMENT_INITIALIZER"),_w=new $("INJECTOR",-1),Dw=new $("INJECTOR_DEF_TYPES");class ww{get(e,n=bo){if(n===bo){const r=new Error(`NullInjectorError: No provider for ${me(e)}!`);throw r.name="NullInjectorError",r}return n}}function BO(...t){return{\u0275providers:Ew(0,t),\u0275fromNgModule:!0}}function Ew(t,...e){const n=[],r=new Set;let i;return oi(e,s=>{const o=s;mf(o,n,[],r)&&(i||(i=[]),i.push(o))}),void 0!==i&&Cw(i,n),n}function Cw(t,e){for(let n=0;n<t.length;n++){const{providers:i}=t[n];yf(i,s=>{e.push(s)})}}function mf(t,e,n,r){if(!(t=V(t)))return!1;let i=null,s=I_(t);const o=!s&&de(t);if(s||o){if(o&&!o.standalone)return!1;i=t}else{const u=t.ngModule;if(s=I_(u),!s)return!1;i=u}const a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of u)mf(c,e,n,r)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;r.add(i);try{oi(s.imports,l=>{mf(l,e,n,r)&&(c||(c=[]),c.push(l))})}finally{}void 0!==c&&Cw(c,e)}if(!a){const c=ri(i)||(()=>new i);e.push({provide:i,useFactory:c,deps:ue},{provide:Dw,useValue:i,multi:!0},{provide:vw,useValue:()=>ae(i),multi:!0})}const u=s.providers;null==u||a||yf(u,l=>{e.push(l)})}}return i!==t&&void 0!==t.providers}function yf(t,e){for(let n of t)dh(n)&&(n=n.\u0275providers),Array.isArray(n)?yf(n,e):e(n)}const jO=ge({provide:String,useValue:ge});function vf(t){return null!==t&&"object"==typeof t&&jO in t}function ui(t){return"function"==typeof t}const _f=new $("Set Injector scope."),dc={},$O={};let Df;function hc(){return void 0===Df&&(Df=new ww),Df}class ps{}class Sw extends ps{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ef(e,o=>this.processProvider(o)),this.records.set(_w,gs(void 0,this)),i.has("environment")&&this.records.set(ps,gs(void 0,this));const s=this.records.get(_f);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Dw.multi,ue,U.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const n=Zi(this),r=nn(void 0);try{return e()}finally{Zi(n),nn(r)}}get(e,n=bo,r=U.Default){this.assertNotDestroyed(),r=Ru(r);const i=Zi(this),s=nn(void 0);try{if(!(r&U.SkipSelf)){let a=this.records.get(e);if(void 0===a){const u=function WO(t){return"function"==typeof t||"object"==typeof t&&t instanceof $}(e)&&Fu(e);a=u&&this.injectableDefInScope(u)?gs(wf(e),dc):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(r&U.Self?hc():this.parent).get(e,n=r&U.Optional&&n===bo?null:n)}catch(o){if("NullInjectorError"===o.name){if((o[Pu]=o[Pu]||[]).unshift(me(e)),i)throw o;return function m1(t,e,n,r){const i=t[Pu];throw e[A_]&&i.unshift(e[A_]),t.message=function y1(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&t.charAt(1)==f1?t.slice(2):t;let i=me(e);if(Array.isArray(e))i=e.map(me).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):me(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(h1,"\n  ")}`}("\n"+t.message,i,n,r),t[d1]=i,t[Pu]=null,t}(o,e,"R3InjectorError",this.source)}throw o}finally{nn(s),Zi(i)}}resolveInjectorInitializers(){const e=Zi(this),n=nn(void 0);try{const r=this.get(vw.multi,ue,U.Self);for(const i of r)i()}finally{Zi(e),nn(n)}}toString(){const e=[],n=this.records;for(const r of n.keys())e.push(me(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new M(205,!1)}processProvider(e){let n=ui(e=V(e))?e:V(e&&e.provide);const r=function GO(t){return vf(t)?gs(void 0,t.useValue):gs(Tw(t),dc)}(e);if(ui(e)||!0!==e.multi)this.records.get(n);else{let i=this.records.get(n);i||(i=gs(void 0,dc,!0),i.factory=()=>gh(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===dc&&(n.value=$O,n.value=n.factory()),"object"==typeof n.value&&n.value&&function zO(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=V(e.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}}function wf(t){const e=Fu(t),n=null!==e?e.factory:ri(t);if(null!==n)return n;if(t instanceof $)throw new M(204,!1);if(t instanceof Function)return function HO(t){const e=t.length;if(e>0)throw function Vo(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}(e,"?"),new M(204,!1);const n=function u1(t){return t&&(t[Ou]||t[S_])||null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new M(204,!1)}function Tw(t,e,n){let r;if(ui(t)){const i=V(t);return ri(i)||wf(i)}if(vf(t))r=()=>V(t.useValue);else if(function Iw(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...gh(t.deps||[]));else if(function bw(t){return!(!t||!t.useExisting)}(t))r=()=>ae(V(t.useExisting));else{const i=V(t&&(t.useClass||t.provide));if(!function qO(t){return!!t.deps}(t))return ri(i)||wf(i);r=()=>new i(...gh(t.deps))}return r}function gs(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Ef(t,e){for(const n of t)Array.isArray(n)?Ef(n,e):n&&dh(n)?Ef(n.\u0275providers,e):e(n)}class KO{}class Aw{}class YO{resolveComponentFactory(e){throw function QO(t){const e=Error(`No component factory found for ${me(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(e)}}let fc=(()=>{class t{}return t.NULL=new YO,t})();function ZO(){return ms(ot(),C())}function ms(t,e){return new fn(Kt(t,e))}let fn=(()=>{class t{constructor(n){this.nativeElement=n}}return t.__NG_ELEMENT_ID__=ZO,t})();class xw{}let ci=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function JO(){const t=C(),n=Lt(ot().index,t);return(Wt(n)?n:t)[J]}(),t})(),eP=(()=>{class t{}return t.\u0275prov=ve({token:t,providedIn:"root",factory:()=>null}),t})();class pc{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const tP=new pc("15.2.8"),Cf={},bf="ngOriginalError";function If(t){return t[bf]}class ys{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&If(e);for(;n&&If(n);)n=If(n);return n||null}}function Fw(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}const Ow="ng-template";function hP(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if("string"==typeof s&&i){const o=t[r++];if(n&&"class"===s&&-1!==Fw(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;r<t.length&&"string"==typeof(s=t[r++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(i=!1)}}return!1}function Pw(t){return 4===t.type&&t.value!==Ow}function fP(t,e,n){return e===(4!==t.type||n?t.value:Ow)}function pP(t,e,n){let r=4;const i=t.attrs||[],s=function yP(t){for(let e=0;e<t.length;e++)if(aD(t[e]))return e;return t.length}(i);let o=!1;for(let a=0;a<e.length;a++){const u=e[a];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!fP(t,u,n)||""===u&&1===e.length){if(pn(r))return!1;o=!0}}else{const c=8&r?u:e[++a];if(8&r&&null!==t.attrs){if(!hP(t.attrs,c,n)){if(pn(r))return!1;o=!0}continue}const d=gP(8&r?"class":u,i,Pw(t),n);if(-1===d){if(pn(r))return!1;o=!0;continue}if(""!==c){let h;h=d>s?"":i[d+1].toLowerCase();const f=8&r?h:null;if(f&&-1!==Fw(f,c,0)||2&r&&c!==h){if(pn(r))return!1;o=!0}}}}else{if(!o&&!pn(r)&&!pn(u))return!1;if(o&&pn(u))continue;o=!1,r=u|1&r}}return pn(r)||o}function pn(t){return 0==(1&t)}function gP(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){const o=e[i];if(o===t)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function vP(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function Rw(t,e,n=!1){for(let r=0;r<e.length;r++)if(pP(t,e[r],n))return!0;return!1}function kw(t,e){return t?":not("+e.trim()+")":e}function DP(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&r){const a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!pn(o)&&(e+=kw(s,i),i=""),r=o,s=s||!pn(r);n++}return""!==i&&(e+=kw(s,i)),e}const Q={};function gc(t){Lw(re(),C(),St()+t,!1)}function Lw(t,e,n,r){if(!r)if(3==(3&e[Z])){const s=t.preOrderCheckHooks;null!==s&&zu(e,s,n)}else{const s=t.preOrderHooks;null!==s&&Wu(e,s,0,n)}ii(n)}function Uw(t,e=null,n=null,r){const i=$w(t,e,n,r);return i.resolveInjectorInitializers(),i}function $w(t,e=null,n=null,r,i=new Set){const s=[n||ue,BO(t)];return r=r||("object"==typeof t?void 0:me(t)),new Sw(s,e||hc(),r||null,i)}let _r=(()=>{class t{static create(n,r){if(Array.isArray(n))return Uw({name:""},r,n,"");{const i=n.name??"";return Uw({name:i},n.parent,n.providers,i)}}}return t.THROW_IF_NOT_FOUND=bo,t.NULL=new ww,t.\u0275prov=ve({token:t,providedIn:"any",factory:()=>ae(_w)}),t.__NG_ELEMENT_ID__=-1,t})();function S(t,e=U.Default){const n=C();return null===n?ae(t,e):mD(ot(),n,V(t),e)}function Qw(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const s=n[r+1];if(-1!==s){const o=t.data[s];Th(n[r]),o.contentQueries(2,e[s],s)}}}function yc(t,e,n,r,i,s,o,a,u,c,l){const d=e.blueprint.slice();return d[zn]=i,d[Z]=76|r,(null!==l||t&&1024&t[Z])&&(d[Z]|=1024),W_(d),d[Ne]=d[Ji]=t,d[Le]=n,d[Bu]=o||t&&t[Bu],d[J]=a||t&&t[J],d[vh]=u||t&&t[vh]||null,d[Vu]=c||t&&t[Vu]||null,d[ht]=s,d[No]=function BF(){return VF++}(),d[L_]=l,d[ft]=2==e.type?t[ft]:d,d}function Ds(t,e,n,r,i){let s=t.data[e];if(null===s)s=function xf(t,e,n,r,i){const s=Y_(),o=Ch(),u=t.data[e]=function WP(t,e,n,r,i,s){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=u),null!==s&&(o?null==s.child&&null!==u.parent&&(s.child=u):null===s.next&&(s.next=u,u.prev=s)),u}(t,e,n,r,i),function H1(){return K.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const o=function Oo(){const t=K.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return In(s,!0),s}function Wo(t,e,n,r){if(0===n)return-1;const i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function Nf(t,e,n){Ah(e);try{const r=t.viewQuery;null!==r&&jf(1,r,n);const i=t.template;null!==i&&Yw(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Qw(t,e),t.staticViewQueries&&jf(2,t.viewQuery,n);const s=t.components;null!==s&&function GP(t,e){for(let n=0;n<e.length;n++)fR(t,e[n])}(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[Z]&=-5,Mh()}}function vc(t,e,n,r){const i=e[Z];if(128!=(128&i)){Ah(e);try{W_(e),function X_(t){return K.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&Yw(t,e,n,2,r);const o=3==(3&i);if(o){const c=t.preOrderCheckHooks;null!==c&&zu(e,c,null)}else{const c=t.preOrderHooks;null!==c&&Wu(e,c,0,null),xh(e,0)}if(function dR(t){for(let e=Xh(t);null!==e;e=Jh(e)){if(!e[V_])continue;const n=e[ts];for(let r=0;r<n.length;r++){const i=n[r];512&i[Z]||Eh(i[Ne],1),i[Z]|=512}}}(e),function lR(t){for(let e=Xh(t);null!==e;e=Jh(e))for(let n=bt;n<e.length;n++){const r=e[n],i=r[N];Gu(r)&&vc(i,r,i.template,r[Le])}}(e),null!==t.contentQueries&&Qw(t,e),o){const c=t.contentCheckHooks;null!==c&&zu(e,c)}else{const c=t.contentHooks;null!==c&&Wu(e,c,1),xh(e,1)}!function $P(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const i=n[r];if(i<0)ii(~i);else{const s=i,o=n[++r],a=n[++r];G1(o,s),a(2,e[s])}}}finally{ii(-1)}}(t,e);const a=t.components;null!==a&&function HP(t,e){for(let n=0;n<e.length;n++)hR(t,e[n])}(e,a);const u=t.viewQuery;if(null!==u&&jf(2,u,r),o){const c=t.viewCheckHooks;null!==c&&zu(e,c)}else{const c=t.viewHooks;null!==c&&Wu(e,c,2),xh(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),e[Z]&=-41,512&e[Z]&&(e[Z]&=-513,Eh(e[Ne],-1))}finally{Mh()}}}function Yw(t,e,n,r,i){const s=St(),o=2&r;try{ii(-1),o&&e.length>we&&Lw(t,e,we,!1),rn(o?2:0,i),n(r,i)}finally{ii(s),rn(o?3:1,i)}}function Ff(t,e,n){if(Dh(e)){const i=e.directiveEnd;for(let s=e.directiveStart;s<i;s++){const o=t.data[s];o.contentQueries&&o.contentQueries(1,n[s],s)}}}function Of(t,e,n){Q_()&&(function eR(t,e,n,r){const i=n.directiveStart,s=n.directiveEnd;Fo(n)&&function aR(t,e,n){const r=Kt(e,t),i=Zw(n),s=t[Bu],o=_c(t,yc(t,i,null,n.onPush?32:16,r,e,s,s.createRenderer(r,n),null,null,null));t[e.index]=o}(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Zu(n,e),gt(r,e);const o=n.initialInputs;for(let a=i;a<s;a++){const u=t.data[a],c=si(e,t,a,n);gt(c,e),null!==o&&uR(0,a-i,c,u,0,o),hn(u)&&(Lt(n.index,e)[Le]=si(e,t,a,n))}}(t,e,n,Kt(n,e)),64==(64&n.flags)&&nE(t,e,n))}function Pf(t,e,n=Kt){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?n(e,t):t[o];t[i++]=a}}}function Zw(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Rf(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Rf(t,e,n,r,i,s,o,a,u,c){const l=we+r,d=l+i,h=function qP(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:Q);return n}(l,d),f="function"==typeof c?c():c;return h[N]={type:t,blueprint:h,template:n,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:f,incompleteFirstPass:!1}}function Jw(t,e,n,r){for(let i in t)if(t.hasOwnProperty(i)){n=null===n?{}:n;const s=t[i];null===r?eE(n,e,i,s):r.hasOwnProperty(i)&&eE(n,e,r[i],s)}return n}function eE(t,e,n,r){t.hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}function kf(t,e,n,r){if(Q_()){const i=null===r?null:{"":-1},s=function nR(t,e){const n=t.directiveRegistry;let r=null,i=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];if(Rw(e,o.selectors,!1))if(r||(r=[]),hn(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o),Lf(t,e,a.length)}else r.unshift(o),Lf(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return null===r?null:[r,i]}(t,n);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&tE(t,e,n,o,i,a),i&&function rR(t,e,n){if(e){const r=t.localNames=[];for(let i=0;i<e.length;i+=2){const s=n[e[i+1]];if(null==s)throw new M(-301,!1);r.push(e[i],s)}}}(n,r,i)}n.mergedAttrs=Ro(n.mergedAttrs,n.attrs)}function tE(t,e,n,r,i,s){for(let c=0;c<r.length;c++)kh(Zu(n,e),t,r[c].type);!function sR(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}(n,t.data.length,r.length);for(let c=0;c<r.length;c++){const l=r[c];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,u=Wo(t,e,r.length,null);for(let c=0;c<r.length;c++){const l=r[c];n.mergedAttrs=Ro(n.mergedAttrs,l.hostAttrs),oR(t,n,e,u,l),iR(u,l,i),null!==l.contentQueries&&(n.flags|=4),(null!==l.hostBindings||null!==l.hostAttrs||0!==l.hostVars)&&(n.flags|=64);const d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??(t.preOrderHooks=[])).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(n.index),a=!0),u++}!function KP(t,e,n){const i=e.directiveEnd,s=t.data,o=e.attrs,a=[];let u=null,c=null;for(let l=e.directiveStart;l<i;l++){const d=s[l],h=n?n.get(d):null,p=h?h.outputs:null;u=Jw(d.inputs,l,u,h?h.inputs:null),c=Jw(d.outputs,l,c,p);const g=null===u||null===o||Pw(e)?null:cR(u,l,o);a.push(g)}null!==u&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=c}(t,n,s)}function nE(t,e,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,o=function q1(){return K.lFrame.currentDirectiveIndex}();try{ii(s);for(let a=r;a<i;a++){const u=t.data[a],c=e[a];Ih(a),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&tR(u,c)}}finally{ii(-1),Ih(o)}}function tR(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function Lf(t,e,n){e.componentOffset=n,(t.components??(t.components=[])).push(e.index)}function iR(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;hn(e)&&(n[""]=t)}}function oR(t,e,n,r,i){t.data[r]=i;const s=i.factory||(i.factory=ri(i.type)),o=new Po(s,hn(i),S);t.blueprint[r]=o,n[r]=o,function XP(t,e,n,r,i){const s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;null===o&&(o=t.hostBindingOpCodes=[]);const a=~e.index;(function JP(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(o)!=a&&o.push(a),o.push(n,r,s)}}(t,e,r,Wo(t,n,i.hostVars,Q),i)}function uR(t,e,n,r,i,s){const o=s[e];if(null!==o){const a=r.setInput;for(let u=0;u<o.length;){const c=o[u++],l=o[u++],d=o[u++];null!==a?r.setInput(n,d,c,l):n[l]=d}}}function cR(t,e,n){let r=null,i=0;for(;i<n.length;){const s=n[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(t.hasOwnProperty(s)){null===r&&(r=[]);const o=t[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){r.push(s,o[a+1],n[i+1]);break}}i+=2}else i+=2;else i+=4}return r}function rE(t,e,n,r){return[t,!0,!1,e,null,0,r,n,null,null]}function hR(t,e){const n=Lt(e,t);if(Gu(n)){const r=n[N];48&n[Z]?vc(r,n,r.template,n[Le]):n[ni]>0&&Bf(n)}}function Bf(t){for(let r=Xh(t);null!==r;r=Jh(r))for(let i=bt;i<r.length;i++){const s=r[i];if(Gu(s))if(512&s[Z]){const o=s[N];vc(o,s,o.template,s[Le])}else s[ni]>0&&Bf(s)}const n=t[N].components;if(null!==n)for(let r=0;r<n.length;r++){const i=Lt(n[r],t);Gu(i)&&i[ni]>0&&Bf(i)}}function fR(t,e){const n=Lt(e,t),r=n[N];(function pR(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])})(r,n),Nf(r,n,n[Le])}function _c(t,e){return t[Mo]?t[k_][ln]=e:t[Mo]=e,t[k_]=e,e}function Dc(t){for(;t;){t[Z]|=32;const e=$o(t);if(C1(t)&&!e)return t;t=e}return null}function wc(t,e,n,r=!0){const i=e[Bu];i.begin&&i.begin();try{vc(t,e,t.template,n)}catch(o){throw r&&aE(e,o),o}finally{i.end&&i.end()}}function jf(t,e,n){Th(0),e(t,n)}function iE(t){return t[Xi]||(t[Xi]=[])}function sE(t){return t.cleanup||(t.cleanup=[])}function aE(t,e){const n=t[Vu],r=n?n.get(ys,null):null;r&&r.handleError(e)}function Uf(t,e,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],u=e[o],c=t.data[o];null!==c.setInput?c.setInput(u,i,r,a):u[a]=i}}function Ec(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=ch(i,a):2==s&&(r=ch(r,a+": "+e[++o]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}function Cc(t,e,n,r,i=!1){for(;null!==n;){const s=e[n.index];if(null!==s&&r.push(st(s)),dn(s))for(let a=bt;a<s.length;a++){const u=s[a],c=u[N].firstChild;null!==c&&Cc(u[N],u,c,r)}const o=n.type;if(8&o)Cc(t,e,n.child,r);else if(32&o){const a=Zh(n,e);let u;for(;u=a();)r.push(u)}else if(16&o){const a=tw(e,n);if(Array.isArray(a))r.push(...a);else{const u=$o(e[ft]);Cc(u[N],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}class Ko{get rootNodes(){const e=this._lView,n=e[N];return Cc(n,e,n.firstChild,[])}constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Le]}set context(e){this._lView[Le]=e}get destroyed(){return 128==(128&this._lView[Z])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Ne];if(dn(e)){const n=e[Uu],r=n?n.indexOf(this):-1;r>-1&&(nf(e,r),Ju(n,r))}this._attachedToViewContainer=!1}zD(this._lView[N],this._lView)}onDestroy(e){!function Xw(t,e,n,r){const i=iE(e);null===n?i.push(r):(i.push(n),t.firstCreatePass&&sE(t).push(r,i.length-1))}(this._lView[N],this._lView,null,e)}markForCheck(){Dc(this._cdRefInjectingView||this._lView)}detach(){this._lView[Z]&=-65}reattach(){this._lView[Z]|=64}detectChanges(){wc(this._lView[N],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new M(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function eO(t,e){Ho(t,e,e[J],2,null,null)}(this._lView[N],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new M(902,!1);this._appRef=e}}class gR extends Ko{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;wc(e[N],e,e[Le],!1)}checkNoChanges(){}get context(){return null}}class uE extends fc{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=de(e);return new Qo(n,this.ngModule)}}function cE(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}class yR{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Ru(r);const i=this.injector.get(e,Cf,r);return i!==Cf||n===Cf?i:this.parentInjector.get(e,n,r)}}class Qo extends Aw{get inputs(){return cE(this.componentDef.inputs)}get outputs(){return cE(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function wP(t){return t.map(DP).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=(i=i||this.ngModule)instanceof ps?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new yR(e,s):e,a=o.get(xw,null);if(null===a)throw new M(407,!1);const u=o.get(eP,null),c=a.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",d=r?function zP(t,e,n){return t.selectRootElement(e,n===Cn.ShadowDom)}(c,r,this.componentDef.encapsulation):tf(c,l,function mR(t){const e=t.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(l)),h=this.componentDef.onPush?288:272,f=Rf(0,null,null,1,0,null,null,null,null,null),p=yc(null,f,null,h,null,null,a,c,u,o,null);let g,m;Ah(p);try{const w=this.componentDef;let I,_=null;w.findHostDirectiveDefs?(I=[],_=new Map,w.findHostDirectiveDefs(w,I,_),I.push(w)):I=[w];const O=function _R(t,e){const n=t[N],r=we;return t[r]=e,Ds(n,r,2,"#host",null)}(p,d),j=function DR(t,e,n,r,i,s,o,a){const u=i[N];!function wR(t,e,n,r){for(const i of t)e.mergedAttrs=Ro(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(Ec(e,e.mergedAttrs,!0),null!==n&&iw(r,n,e))}(r,t,e,o);const c=s.createRenderer(e,n),l=yc(i,Zw(n),null,n.onPush?32:16,i[t.index],t,s,c,a||null,null,null);return u.firstCreatePass&&Lf(u,t,r.length-1),_c(i,l),i[t.index]=l}(O,d,w,I,p,a,c);m=z_(f,we),d&&function CR(t,e,n,r){if(r)Fh(t,n,["ng-version",tP.full]);else{const{attrs:i,classes:s}=function EP(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let s=t[r];if("string"==typeof s)2===i?""!==s&&e.push(s,t[++r]):8===i&&n.push(s);else{if(!pn(i))break;i=s}r++}return{attrs:e,classes:n}}(e.selectors[0]);i&&Fh(t,n,i),s&&s.length>0&&rw(t,n,s.join(" "))}}(c,w,d,r),void 0!==n&&function bR(t,e,n){const r=t.projection=[];for(let i=0;i<e.length;i++){const s=n[i];r.push(null!=s?Array.from(s):null)}}(m,this.ngContentSelectors,n),g=function ER(t,e,n,r,i,s){const o=ot(),a=i[N],u=Kt(o,i);tE(a,i,o,n,null,r);for(let l=0;l<n.length;l++)gt(si(i,a,o.directiveStart+l,o),i);nE(a,i,o),u&&gt(u,i);const c=si(i,a,o.directiveStart+o.componentOffset,o);if(t[Le]=i[Le]=c,null!==s)for(const l of s)l(c,e);return Ff(a,o,t),c}(j,w,I,_,p,[IR]),Nf(f,p,null)}finally{Mh()}return new vR(this.componentType,g,ms(m,p),p,m)}}class vR extends KO{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.instance=n,this.hostView=this.changeDetectorRef=new gR(i),this.componentType=e}setInput(e,n){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[e])){const s=this._rootLView;Uf(s[N],s,i,e,n),Dc(Lt(this._tNode.index,s))}}get injector(){return new ss(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function IR(){const t=ot();qu(C()[N],t)}function he(t){let e=function lE(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),n=!0;const r=[t];for(;e;){let i;if(hn(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new M(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);const o=t;o.inputs=$f(t.inputs),o.declaredInputs=$f(t.declaredInputs),o.outputs=$f(t.outputs);const a=i.hostBindings;a&&MR(t,a);const u=i.viewQuery,c=i.contentQueries;if(u&&TR(t,u),c&&AR(t,c),uh(t.inputs,i.inputs),uh(t.declaredInputs,i.declaredInputs),uh(t.outputs,i.outputs),hn(i)&&i.data.animation){const l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(t),a===he&&(n=!1)}}e=Object.getPrototypeOf(e)}!function SR(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Ro(i.hostAttrs,n=Ro(n,i.hostAttrs))}}(r)}function $f(t){return t===Gn?{}:t===ue?[]:t}function TR(t,e){const n=t.viewQuery;t.viewQuery=n?(r,i)=>{e(r,i),n(r,i)}:e}function AR(t,e){const n=t.contentQueries;t.contentQueries=n?(r,i,s)=>{e(r,i,s),n(r,i,s)}:e}function MR(t,e){const n=t.hostBindings;t.hostBindings=n?(r,i)=>{e(r,i),n(r,i)}:e}function bc(t){return!!function Hf(t){return null!==t&&("function"==typeof t||"object"==typeof t)}(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function mt(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Sc(t,e,n){const r=C();return mt(r,rs(),e)&&function Yt(t,e,n,r,i,s,o,a){const u=Kt(e,n);let l,c=e.inputs;!a&&null!=c&&(l=c[r])?(Uf(t,n,l,r,i),Fo(e)&&function YP(t,e){const n=Lt(e,t);16&n[Z]||(n[Z]|=32)}(n,e.index)):3&e.type&&(r=function QP(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),i=null!=o?o(i,e.value||"",r):i,s.setProperty(u,r,i))}(re(),function Me(){const t=K.lFrame;return z_(t.tView,t.selectedIndex)}(),r,t,e,r[J],n,!1),Sc}function Gf(t,e,n,r,i){const o=i?"class":"style";Uf(t,n,e.inputs[o],o,r)}function di(t,e,n,r){const i=C(),s=re(),o=we+t,a=i[J],u=s.firstCreatePass?function $R(t,e,n,r,i,s){const o=e.consts,u=Ds(e,t,2,r,yr(o,i));return kf(e,n,u,yr(o,s)),null!==u.attrs&&Ec(u,u.attrs,!1),null!==u.mergedAttrs&&Ec(u,u.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,u),u}(o,s,i,e,n,r):s.data[o],c=i[o]=tf(a,e,function J1(){return K.lFrame.currentNamespace}()),l=$u(u);return In(u,!0),iw(a,c,u),32!=(32&u.flags)&&oc(s,i,c,u),0===function R1(){return K.lFrame.elementDepthCount}()&&gt(c,i),function k1(){K.lFrame.elementDepthCount++}(),l&&(Of(s,i,u),Ff(s,u,i)),null!==r&&Pf(i,u),di}function hi(){let t=ot();Ch()?function bh(){K.lFrame.isParent=!1}():(t=t.parent,In(t,!1));const e=t;!function L1(){K.lFrame.elementDepthCount--}();const n=re();return n.firstCreatePass&&(qu(n,t),Dh(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function rF(t){return 0!=(8&t.flags)}(e)&&Gf(n,e,C(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function iF(t){return 0!=(16&t.flags)}(e)&&Gf(n,e,C(),e.stylesWithoutHost,!1),hi}function Tc(t){return!!t&&"function"==typeof t.then}const TE=function SE(t){return!!t&&"function"==typeof t.subscribe};function Zt(t,e,n,r){const i=C(),s=re(),o=ot();return function ME(t,e,n,r,i,s,o){const a=$u(r),c=t.firstCreatePass&&sE(t),l=e[Le],d=iE(e);let h=!0;if(3&r.type||o){const g=Kt(r,e),m=o?o(g):g,w=d.length,I=o?O=>o(st(O[r.index])):r.index;let _=null;if(!o&&a&&(_=function qR(t,e,n,r){const i=t.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===n&&i[s+1]===r){const a=e[Xi],u=i[s+2];return a.length>u?a[u]:null}"string"==typeof o&&(s+=2)}return null}(t,e,i,r.index)),null!==_)(_.__ngLastListenerFn__||_).__ngNextListenerFn__=s,_.__ngLastListenerFn__=s,h=!1;else{s=NE(r,e,l,s,!1);const O=n.listen(m,i,s);d.push(s,O),c&&c.push(i,I,w,w+1)}}else s=NE(r,e,l,s,!1);const f=r.outputs;let p;if(h&&null!==f&&(p=f[i])){const g=p.length;if(g)for(let m=0;m<g;m+=2){const j=e[p[m]][p[m+1]].subscribe(s),H=d.length;d.push(s,j),c&&c.push(i,r.index,H,-(H+1))}}}(s,i,i[J],o,t,e,r),Zt}function xE(t,e,n,r){try{return rn(6,e,n),!1!==n(r)}catch(i){return aE(t,i),!1}finally{rn(7,e,n)}}function NE(t,e,n,r,i){return function s(o){if(o===Function)return r;Dc(t.componentOffset>-1?Lt(t.index,e):e);let u=xE(e,n,r,o),c=s.__ngNextListenerFn__;for(;c;)u=xE(e,n,c,o)&&u,c=c.__ngNextListenerFn__;return i&&!1===u&&(o.preventDefault(),o.returnValue=!1),u}}function Ac(t,e){return t<<17|e<<2}function Dr(t){return t>>17&32767}function Kf(t){return 2|t}function fi(t){return(131068&t)>>2}function Qf(t,e){return-131069&t|e<<2}function Yf(t){return 1|t}function UE(t,e,n,r,i){const s=t[n+1],o=null===e;let a=r?Dr(s):fi(s),u=!1;for(;0!==a&&(!1===u||o);){const l=t[a+1];tk(t[a],e)&&(u=!0,t[a+1]=r?Yf(l):Kf(l)),a=r?Dr(l):fi(l)}u&&(t[n+1]=r?Kf(s):Yf(s))}function tk(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&ls(t,e)>=0}function Mc(t,e){return function gn(t,e,n,r){const i=C(),s=re(),o=function Qn(t){const e=K.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}(2);s.firstUpdatePass&&function YE(t,e,n,r){const i=t.data;if(null===i[n+1]){const s=i[St()],o=function QE(t,e){return e>=t.expandoStartIndex}(t,n);(function eC(t,e){return 0!=(t.flags&(e?8:16))})(s,r)&&null===e&&!o&&(e=!1),e=function lk(t,e,n,r){const i=function Sh(t){const e=K.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(n=Zo(n=Zf(null,t,e,n,r),e.attrs,r),s=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==i)if(n=Zf(i,t,e,n,r),null===s){let u=function dk(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==fi(r))return t[Dr(r)]}(t,e,r);void 0!==u&&Array.isArray(u)&&(u=Zf(null,t,e,u[1],r),u=Zo(u,e.attrs,r),function hk(t,e,n,r){t[Dr(n?e.classBindings:e.styleBindings)]=r}(t,e,r,u))}else s=function fk(t,e,n){let r;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)r=Zo(r,t[s].hostAttrs,n);return Zo(r,e.attrs,n)}(t,e,r)}return void 0!==s&&(r?e.residualClasses=s:e.residualStyles=s),n}(i,s,e,r),function JR(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Dr(o),u=fi(o);t[r]=n;let l,c=!1;if(Array.isArray(n)?(l=n[1],(null===l||ls(n,l)>0)&&(c=!0)):l=n,i)if(0!==u){const h=Dr(t[a+1]);t[r+1]=Ac(h,a),0!==h&&(t[h+1]=Qf(t[h+1],r)),t[a+1]=function ZR(t,e){return 131071&t|e<<17}(t[a+1],r)}else t[r+1]=Ac(a,0),0!==a&&(t[a+1]=Qf(t[a+1],r)),a=r;else t[r+1]=Ac(u,0),0===a?a=r:t[u+1]=Qf(t[u+1],r),u=r;c&&(t[r+1]=Kf(t[r+1])),UE(t,l,r,!0),UE(t,l,r,!1),function ek(t,e,n,r,i){const s=i?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&ls(s,e)>=0&&(n[r+1]=Yf(n[r+1]))}(e,l,t,r,s),o=Ac(a,u),s?e.classBindings=o:e.styleBindings=o}(i,s,e,n,o,r)}}(s,t,o,r),e!==Q&&mt(i,o,e)&&function XE(t,e,n,r,i,s,o,a){if(!(3&e.type))return;const u=t.data,c=u[a+1],l=function XR(t){return 1==(1&t)}(c)?JE(u,e,n,i,fi(c),o):void 0;xc(l)||(xc(s)||function YR(t){return 2==(2&t)}(c)&&(s=JE(u,null,n,i,a,o)),function lO(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=-1===r.indexOf("-")?void 0:Vt.DashCase;null==i?t.removeStyle(n,r,s):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Vt.Important),t.setStyle(n,r,i,s))}}(r,o,Hu(St(),n),i,s))}(s,s.data[St()],i,i[J],t,i[o+1]=function yk(t,e){return null==t||""===t||("string"==typeof e?t+=e:"object"==typeof t&&(t=me(function vr(t){return t instanceof cw?t.changingThisBreaksApplicationSecurity:t}(t)))),t}(e,n),r,o)}(t,e,null,!0),Mc}function Zf(t,e,n,r,i){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=e[a],r=Zo(r,s.hostAttrs,i),s!==t);)a++;return null!==t&&(n.directiveStylingLast=a),r}function Zo(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Qt(t,o,!!n||e[++s]))}return void 0===t?null:t}function JE(t,e,n,r,i,s){const o=null===e;let a;for(;i>0;){const u=t[i],c=Array.isArray(u),l=c?u[1]:u,d=null===l;let h=n[i+1];h===Q&&(h=d?ue:void 0);let f=d?Uh(h,r):l===r?h:void 0;if(c&&!xc(f)&&(f=Uh(u,r)),xc(f)&&(a=f,o))return a;const p=t[i+1];i=o?Dr(p):fi(p)}if(null!==e){let u=s?e.residualClasses:e.residualStyles;null!=u&&(a=Uh(u,r))}return a}function xc(t){return void 0!==t}function Nc(t,e=""){const n=C(),r=re(),i=t+we,s=r.firstCreatePass?Ds(r,i,1,e,null):r.data[i],o=n[i]=function ef(t,e){return t.createText(e)}(n[J],e);oc(r,n,o,s),In(s,!1)}function Fc(t,e,n){const r=C(),i=function Es(t,e,n,r){return mt(t,rs(),n)?e+z(n)+r:Q}(r,t,e,n);return i!==Q&&function Xn(t,e,n){const r=Hu(e,t);!function GD(t,e,n){t.setValue(e,n)}(t[J],r,n)}(r,St(),i),Fc}const Fs="en-US";let CC=Fs;function ep(t,e,n,r,i){if(t=V(t),Array.isArray(t))for(let s=0;s<t.length;s++)ep(t[s],e,n,r,i);else{const s=re(),o=C();let a=ui(t)?t:V(t.provide),u=Tw(t);const c=ot(),l=1048575&c.providerIndexes,d=c.directiveStart,h=c.providerIndexes>>20;if(ui(t)||!t.multi){const f=new Po(u,i,S),p=np(a,e,i?l:l+h,d);-1===p?(kh(Zu(c,o),s,a),tp(s,t,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{const f=np(a,e,l+h,d),p=np(a,e,l,l+h),m=p>=0&&n[p];if(i&&!m||!i&&!(f>=0&&n[f])){kh(Zu(c,o),s,a);const w=function RL(t,e,n,r,i){const s=new Po(t,n,S);return s.multi=[],s.index=e,s.componentProviders=0,KC(s,i,r&&!n),s}(i?PL:OL,n.length,i,r,u);!i&&m&&(n[p].providerFactory=w),tp(s,t,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,i&&(c.providerIndexes+=1048576),n.push(w),o.push(w)}else tp(s,t,f>-1?f:p,KC(n[i?p:f],u,!i&&r));!i&&r&&m&&n[p].componentProviders++}}}function tp(t,e,n,r){const i=ui(e),s=function UO(t){return!!t.useClass}(e);if(i||s){const u=(s?V(e.useClass):e).prototype.ngOnDestroy;if(u){const c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){const l=c.indexOf(n);-1===l?c.push(n,[r,u]):c[l+1].push(r,u)}else c.push(n,u)}}}function KC(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function np(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function OL(t,e,n,r){return rp(this.multi,[])}function PL(t,e,n,r){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=si(n,n[N],this.providerFactory.index,r);s=a.slice(0,o),rp(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],rp(i,s);return s}function rp(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function Ie(t,e=[]){return n=>{n.providersResolver=(r,i)=>function FL(t,e,n){const r=re();if(r.firstCreatePass){const i=hn(t);ep(n,r.data,r.blueprint,i,!0),ep(e,r.data,r.blueprint,i,!1)}}(r,i?i(t):t,e)}}class Os{}class kL{}class QC extends Os{constructor(e,n){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new uE(this);const r=function zt(t,e){const n=t[N_]||null;if(!n&&!0===e)throw new Error(`Type ${me(t)} does not have '\u0275mod' property.`);return n}(e);this._bootstrapComponents=function Zn(t){return t instanceof Function?t():t}(r.bootstrap),this._r3Injector=$w(e,n,[{provide:Os,useValue:this},{provide:fc,useValue:this.componentFactoryResolver}],me(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class ip extends kL{constructor(e){super(),this.moduleType=e}create(e){return new QC(this.moduleType,e)}}function rb(t,e,n,r,i,s){const o=e+n;return mt(t,o,i)?function An(t,e,n){return t[e]=n}(t,o+1,s?r.call(s,i):r(i)):function ra(t,e){const n=t[e];return n===Q?void 0:n}(t,o+1)}function cb(t,e,n){const r=t+we,i=C(),s=function ns(t,e){return t[e]}(i,r);return function ia(t,e){return t[N].data[e].pure}(i,r)?rb(i,function It(){const t=K.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}(),e,s.transform,n,s):s.transform(n)}function op(t){return e=>{setTimeout(t,void 0,e)}}const yt=class lV extends rh{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&"object"==typeof e){const u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=op(s),i&&(i=op(i)),o&&(o=op(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof wn&&e.add(a),a}};let er=(()=>{class t{}return t.__NG_ELEMENT_ID__=pV,t})();const hV=er,fV=class extends hV{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}createEmbeddedView(e,n){const r=this._declarationTContainer.tView,i=yc(this._declarationLView,r,e,16,null,r.declTNode,null,null,null,null,n||null);i[xo]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[bn];return null!==o&&(i[bn]=o.createEmbeddedView(r)),Nf(r,i,e),new Ko(i)}};function pV(){return function Lc(t,e){return 4&t.type?new fV(e,t,ms(t,e)):null}(ot(),C())}let Nn=(()=>{class t{}return t.__NG_ELEMENT_ID__=gV,t})();function gV(){return function hb(t,e){let n;const r=e[t.index];if(dn(r))n=r;else{let i;if(8&t.type)i=st(r);else{const s=e[J];i=s.createComment("");const o=Kt(t,e);ai(s,sc(s,o),i,function aO(t,e){return t.nextSibling(e)}(s,o),!1)}e[t.index]=n=rE(r,e,i,t),_c(e,n)}return new lb(n,t,e)}(ot(),C())}const mV=Nn,lb=class extends mV{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return ms(this._hostTNode,this._hostLView)}get injector(){return new ss(this._hostTNode,this._hostLView)}get parentInjector(){const e=Rh(this._hostTNode,this._hostLView);if(lD(e)){const n=Qu(e,this._hostLView),r=Ku(e);return new ss(n[N].data[r+8],n)}return new ss(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=db(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-bt}createEmbeddedView(e,n,r){let i,s;"number"==typeof r?i=r:null!=r&&(i=r.index,s=r.injector);const o=e.createEmbeddedView(n||{},s);return this.insert(o,i),o}createComponent(e,n,r,i,s){const o=e&&!function Lo(t){return"function"==typeof t}(e);let a;if(o)a=n;else{const d=n||{};a=d.index,r=d.injector,i=d.projectableNodes,s=d.environmentInjector||d.ngModuleRef}const u=o?e:new Qo(de(e)),c=r||this.parentInjector;if(!s&&null==u.ngModule){const h=(o?c:this.parentInjector).get(ps,null);h&&(s=h)}const l=u.create(c,i,void 0,s);return this.insert(l.hostView,a),l}insert(e,n){const r=e._lView,i=r[N];if(function P1(t){return dn(t[Ne])}(r)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const d=r[Ne],h=new lb(d,d[ht],d[Ne]);h.detach(h.indexOf(e))}}const s=this._adjustIndex(n),o=this._lContainer;!function nO(t,e,n,r){const i=bt+r,s=n.length;r>0&&(n[i-1][ln]=e),r<s-bt?(e[ln]=n[i],ED(n,bt+r,e)):(n.push(e),e[ln]=null),e[Ne]=n;const o=e[xo];null!==o&&n!==o&&function rO(t,e){const n=t[ts];e[ft]!==e[Ne][Ne][ft]&&(t[V_]=!0),null===n?t[ts]=[e]:n.push(e)}(o,e);const a=e[bn];null!==a&&a.insertView(t),e[Z]|=64}(i,r,o,s);const a=of(s,o),u=r[J],c=sc(u,o[ju]);return null!==c&&function JF(t,e,n,r,i,s){r[zn]=i,r[ht]=e,Ho(t,r,n,1,i,s)}(i,o[ht],u,r,c,a),e.attachToViewContainerRef(),ED(up(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=db(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=nf(this._lContainer,n);r&&(Ju(up(this._lContainer),n),zD(r[N],r))}detach(e){const n=this._adjustIndex(e,-1),r=nf(this._lContainer,n);return r&&null!=Ju(up(this._lContainer),n)?new Ko(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function db(t){return t[Uu]}function up(t){return t[Uu]||(t[Uu]=[])}function Bc(...t){}const kb=new $("Application Initializer");let jc=(()=>{class t{constructor(n){this.appInits=n,this.resolve=Bc,this.reject=Bc,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i})}runInitializers(){if(this.initialized)return;const n=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const s=this.appInits[i]();if(Tc(s))n.push(s);else if(TE(s)){const o=new Promise((a,u)=>{s.subscribe({complete:a,error:u})});n.push(o)}}Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}}return t.\u0275fac=function(n){return new(n||t)(ae(kb,8))},t.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const oa=new $("AppId",{providedIn:"root",factory:function Lb(){return`${vp()}${vp()}${vp()}`}});function vp(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Vb=new $("Platform Initializer"),Bb=new $("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),tr=new $("LocaleId",{providedIn:"root",factory:()=>function x_(t,e=U.Default){return ae(t,Ru(e))}(tr,U.Optional|U.SkipSelf)||function WV(){return typeof $localize<"u"&&$localize.locale||Fs}()}),XV=(()=>Promise.resolve(0))();function _p(t){typeof Zone>"u"?XV.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class vt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new yt(!1),this.onMicrotaskEmpty=new yt(!1),this.onStable=new yt(!1),this.onError=new yt(!1),typeof Zone>"u")throw new M(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function JV(){let t=De.requestAnimationFrame,e=De.cancelAnimationFrame;if(typeof Zone<"u"&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function nB(t){const e=()=>{!function tB(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(De,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,wp(t),t.isCheckStableRunning=!0,Dp(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),wp(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{try{return $b(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),Hb(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return $b(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),Hb(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,wp(t),Dp(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!vt.isInAngularZone())throw new M(909,!1)}static assertNotInAngularZone(){if(vt.isInAngularZone())throw new M(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,eB,Bc,Bc);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const eB={};function Dp(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function wp(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function $b(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Hb(t){t._nesting--,Dp(t)}class rB{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new yt,this.onMicrotaskEmpty=new yt,this.onStable=new yt,this.onError=new yt}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}}const Gb=new $(""),Uc=new $("");let bp,Ep=(()=>{class t{constructor(n,r,i){this._ngZone=n,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,bp||(function iB(t){bp=t}(i),i.addToWindow(r)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{vt.assertNotInAngularZone(),_p(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())_p(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:i})}whenStable(n,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,r,i){return[]}}return t.\u0275fac=function(n){return new(n||t)(ae(vt),ae(Cp),ae(Uc))},t.\u0275prov=ve({token:t,factory:t.\u0275fac}),t})(),Cp=(()=>{class t{constructor(){this._applications=new Map}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return bp?.findTestabilityInTree(this,n,r)??null}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();const nr=!1;let wr=null;const qb=new $("AllowMultipleToken"),Ip=new $("PlatformDestroyListeners"),sB=new $("appBootstrapListener");function Wb(t,e,n=[]){const r=`Platform: ${e}`,i=new $(r);return(s=[])=>{let o=Sp();if(!o||o.injector.get(qb,!1)){const a=[...n,...s,{provide:i,useValue:!0}];t?t(a):function uB(t){if(wr&&!wr.get(qb,!1))throw new M(400,!1);wr=t;const e=t.get(Qb);(function zb(t){const e=t.get(Vb,null);e&&e.forEach(n=>n())})(t)}(function Kb(t=[],e){return _r.create({name:e,providers:[{provide:_f,useValue:"platform"},{provide:Ip,useValue:new Set([()=>wr=null])},...t]})}(a,r))}return function lB(t){const e=Sp();if(!e)throw new M(401,!1);return e}()}}function Sp(){return wr?.get(Qb)??null}let Qb=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const i=function Zb(t,e){let n;return n="noop"===t?new rB:("zone.js"===t?void 0:t)||new vt(e),n}(r?.ngZone,function Yb(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!t||!t.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!t||!t.ngZoneRunCoalescing)||!1}}(r)),s=[{provide:vt,useValue:i}];return i.run(()=>{const o=_r.create({providers:s,parent:this.injector,name:n.moduleType.name}),a=n.create(o),u=a.injector.get(ys,null);if(!u)throw new M(402,!1);return i.runOutsideAngular(()=>{const c=i.onError.subscribe({next:l=>{u.handleError(l)}});a.onDestroy(()=>{$c(this._modules,a),c.unsubscribe()})}),function Xb(t,e,n){try{const r=n();return Tc(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(u,i,()=>{const c=a.injector.get(jc);return c.runInitializers(),c.donePromise.then(()=>(function bC(t){tn(t,"Expected localeId to be defined"),"string"==typeof t&&(CC=t.toLowerCase().replace(/_/g,"-"))}(a.injector.get(tr,Fs)||Fs),this._moduleDoBootstrap(a),a))})})}bootstrapModule(n,r=[]){const i=Jb({},r);return function oB(t,e,n){const r=new ip(n);return Promise.resolve(r)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(n){const r=n.injector.get(Tp);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new M(-403,!1);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new M(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const n=this._injector.get(Ip,null);n&&(n.forEach(r=>r()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(n){return new(n||t)(ae(_r))},t.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function Jb(t,e){return Array.isArray(e)?e.reduce(Jb,t):{...t,...e}}let Tp=(()=>{class t{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(n,r,i){this._zone=n,this._injector=r,this._exceptionHandler=i,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new Ct(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),o=new Ct(a=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{vt.assertNotInAngularZone(),_p(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{vt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{u.unsubscribe(),c.unsubscribe()}});this.isStable=e1(s,o.pipe(function t1(t={}){const{connector:e=(()=>new rh),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,c=0,l=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=u=void 0,l=d=!1},p=()=>{const g=o;f(),g?.unsubscribe()};return Eo((g,m)=>{c++,!d&&!l&&h();const w=u=u??e();m.add(()=>{c--,0===c&&!d&&!l&&(a=ah(p,i))}),w.subscribe(m),!o&&c>0&&(o=new wo({next:I=>w.next(I),error:I=>{d=!0,h(),a=ah(f,n,I),w.error(I)},complete:()=>{l=!0,h(),a=ah(f,r),w.complete()}}),Un(g).subscribe(o))})(s)}}()))}bootstrap(n,r){const i=n instanceof Aw;if(!this._injector.get(jc).done){!i&&function Ao(t){const e=de(t)||dt(t)||kt(t);return null!==e&&e.standalone}(n);throw new M(405,nr)}let o;o=i?n:this._injector.get(fc).resolveComponentFactory(n),this.componentTypes.push(o.componentType);const a=function aB(t){return t.isBoundToModule}(o)?void 0:this._injector.get(Os),c=o.create(_r.NULL,[],r||o.selector,a),l=c.location.nativeElement,d=c.injector.get(Gb,null);return d?.registerApplication(l),c.onDestroy(()=>{this.detachView(c.hostView),$c(this.components,c),d?.unregisterApplication(l)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new M(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;$c(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const r=this._injector.get(sB,[]);r.push(...this._bootstrapListeners),r.forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>$c(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new M(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return t.\u0275fac=function(n){return new(n||t)(ae(vt),ae(ps),ae(ys))},t.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function $c(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}let n0=(()=>{class t{}return t.__NG_ELEMENT_ID__=hB,t})();function hB(t){return function fB(t,e,n){if(Fo(t)&&!n){const r=Lt(t.index,e);return new Ko(r,r)}return 47&t.type?new Ko(e[ft],e):null}(ot(),C(),16==(16&t))}class o0{constructor(){}supports(e){return bc(e)}create(e){return new _B(e)}}const vB=(t,e)=>e;class _B{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||vB}forEachItem(e){let n;for(n=this._itHead;null!==n;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){const o=!r||n&&n.currentIndex<u0(r,i,s)?n:r,a=u0(o,i,s),u=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,null==o.previousIndex)i++;else{s||(s=[]);const c=a-i,l=u-i;if(c!=l){for(let h=0;h<c;h++){const f=h<s.length?s[h]:s[h]=0,p=f+h;l<=p&&p<c&&(s[h]=f+1)}s[o.previousIndex]=l-c}}a!==u&&e(o,a,u)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)e(n)}diff(e){if(null==e&&(e=[]),!bc(e))throw new M(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,s,o,n=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==n&&Object.is(n.trackById,o)?(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)):(n=this._mismatch(n,s,o,a),r=!0),n=n._next}else i=0,function kR(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Symbol.iterator]();let r;for(;!(r=n.next()).done;)e(r.value)}}(e,a=>{o=this._trackByFn(i,a),null!==n&&Object.is(n.trackById,o)?(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)):(n=this._mismatch(n,a,o,i),r=!0),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new DB(n,r),s,i),e}_verifyReinsertion(e,n,r,i){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==s?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const n=e._next;this._addToRemovals(this._unlink(e)),e=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,s=e._nextRemoved;return null===i?this._removalsHead=s:i._nextRemoved=s,null===s?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){const i=null===n?this._itHead:n._next;return e._next=i,e._prev=n,null===i?this._itTail=e:i._prev=e,null===n?this._itHead=e:n._next=e,null===this._linkedRecords&&(this._linkedRecords=new a0),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const n=e._prev,r=e._next;return null===n?this._itHead=r:n._next=r,null===r?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new a0),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class DB{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class wB{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===n||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const n=e._prevDup,r=e._nextDup;return null===n?this._head=r:n._nextDup=r,null===r?this._tail=n:r._prevDup=n,null===this._head}}class a0{constructor(){this.map=new Map}put(e){const n=e.trackById;let r=this.map.get(n);r||(r=new wB,this.map.set(n,r)),r.add(e)}get(e,n){const i=this.map.get(e);return i?i.get(e,n):null}remove(e){const n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function u0(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function l0(){return new qc([new o0])}let qc=(()=>{class t{constructor(n){this.factories=n}static create(n,r){if(null!=r){const i=r.factories.slice();n=n.concat(i)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||l0()),deps:[[t,new nc,new tc]]}}find(n){const r=this.factories.find(i=>i.supports(n));if(null!=r)return r;throw new M(901,!1)}}return t.\u0275prov=ve({token:t,providedIn:"root",factory:l0}),t})();const SB=Wb(null,"core",[]);let TB=(()=>{class t{constructor(n){}}return t.\u0275fac=function(n){return new(n||t)(ae(Tp))},t.\u0275mod=mr({type:t}),t.\u0275inj=$n({}),t})();let Op=null;function ks(){return Op}class xB{}const rr=new $("DocumentToken");class v2{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let b0=(()=>{class t{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,r,i){this._viewContainer=n,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const r=this._viewContainer;n.forEachOperation((i,s,o)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new v2(i.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===s?void 0:s);else if(null!==s){const a=r.get(s);r.move(a,o),I0(a,i)}});for(let i=0,s=r.length;i<s;i++){const a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}n.forEachIdentityChange(i=>{I0(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(n,r){return!0}}return t.\u0275fac=function(n){return new(n||t)(S(Nn),S(er),S(qc))},t.\u0275dir=W({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),t})();function I0(t,e){t.context.$implicit=e.item}let A0=(()=>{class t{transform(n){return JSON.stringify(n,null,2)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275pipe=Rt({name:"json",type:t,pure:!1,standalone:!0}),t})(),q2=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=mr({type:t}),t.\u0275inj=$n({}),t})();class Cj extends xB{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Yp extends Cj{static makeCurrent(){!function MB(t){Op||(Op=t)}(new Yp)}onAndCancel(e,n,r){return e.addEventListener(n,r,!1),()=>{e.removeEventListener(n,r,!1)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function bj(){return da=da||document.querySelector("base"),da?da.getAttribute("href"):null}();return null==n?null:function Ij(t){rl=rl||document.createElement("a"),rl.setAttribute("href",t);const e=rl.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){da=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function g2(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[i,s]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let rl,da=null;const k0=new $("TRANSITION_ID"),Tj=[{provide:kb,useFactory:function Sj(t,e,n){return()=>{n.get(jc).donePromise.then(()=>{const r=ks(),i=e.querySelectorAll(`style[ng-transition="${t}"]`);for(let s=0;s<i.length;s++)r.remove(i[s])})}},deps:[k0,rr,_r],multi:!0}];let Mj=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ve({token:t,factory:t.\u0275fac}),t})();const il=new $("EventManagerPlugins");let sl=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>{i.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}addGlobalEventListener(n,r,i){return this._findPluginFor(r).addGlobalEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){const r=this._eventNameToPlugin.get(n);if(r)return r;const i=this._plugins;for(let s=0;s<i.length;s++){const o=i[s];if(o.supports(n))return this._eventNameToPlugin.set(n,o),o}throw new Error(`No event manager plugin found for event ${n}`)}}return t.\u0275fac=function(n){return new(n||t)(ae(il),ae(vt))},t.\u0275prov=ve({token:t,factory:t.\u0275fac}),t})();class L0{constructor(e){this._doc=e}addGlobalEventListener(e,n,r){const i=ks().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${n}`);return this.addEventListener(i,n,r)}}let V0=(()=>{class t{constructor(){this.usageCount=new Map}addStyles(n){for(const r of n)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(n){for(const r of n)0===this.changeUsageCount(r,-1)&&this.onStyleRemoved(r)}onStyleRemoved(n){}onStyleAdded(n){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(n,r){const i=this.usageCount;let s=i.get(n)??0;return s+=r,s>0?i.set(n,s):i.delete(n),s}ngOnDestroy(){for(const n of this.getAllStyles())this.onStyleRemoved(n);this.usageCount.clear()}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ve({token:t,factory:t.\u0275fac}),t})(),ha=(()=>{class t extends V0{constructor(n){super(),this.doc=n,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(n){for(const r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){const r=this.styleRef;r.get(n)?.forEach(s=>s.remove()),r.delete(n)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}addStyleToHost(n,r){const i=this.doc.createElement("style");i.textContent=r,n.appendChild(i);const s=this.styleRef.get(r);s?s.push(i):this.styleRef.set(r,[i])}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}}return t.\u0275fac=function(n){return new(n||t)(ae(rr))},t.\u0275prov=ve({token:t,factory:t.\u0275fac}),t})();const Zp={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Xp=/%COMP%/g,U0=new $("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function $0(t,e){return e.flat(100).map(n=>n.replace(Xp,t))}function H0(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let Jp=(()=>{class t{constructor(n,r,i,s){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new eg(n)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;const i=this.getOrCreateRenderer(n,r);return i instanceof z0?i.applyToHost(n):i instanceof tg&&i.applyStyles(),i}getOrCreateRenderer(n,r){const i=this.rendererByCompId;let s=i.get(r.id);if(!s){const o=this.eventManager,a=this.sharedStylesHost,u=this.removeStylesOnCompDestory;switch(r.encapsulation){case Cn.Emulated:s=new z0(o,a,r,this.appId,u);break;case Cn.ShadowDom:return new kj(o,a,n,r);default:s=new tg(o,a,r,u)}s.onDestroy=()=>i.delete(r.id),i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return t.\u0275fac=function(n){return new(n||t)(ae(sl),ae(ha),ae(oa),ae(U0))},t.\u0275prov=ve({token:t,factory:t.\u0275fac}),t})();class eg{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,n){return n?document.createElementNS(Zp[n]||n,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,n){(q0(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(q0(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;const s=Zp[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const i=Zp[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Vt.DashCase|Vt.Important)?e.style.setProperty(n,r,i&Vt.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Vt.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e[n]=r}setValue(e,n){e.nodeValue=n}listen(e,n,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,n,H0(r)):this.eventManager.addEventListener(e,n,H0(r))}}function q0(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class kj extends eg{constructor(e,n,r,i){super(e),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=$0(i.id,i.styles);for(const o of s){const a=document.createElement("style");a.textContent=o,this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class tg extends eg{constructor(e,n,r,i,s=r.id){super(e),this.sharedStylesHost=n,this.removeStylesOnCompDestory=i,this.rendererUsageCount=0,this.styles=$0(s,r.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class z0 extends tg{constructor(e,n,r,i,s){const o=i+"-"+r.id;super(e,n,r,s,o),this.contentAttr=function Oj(t){return"_ngcontent-%COMP%".replace(Xp,t)}(o),this.hostAttr=function Pj(t){return"_nghost-%COMP%".replace(Xp,t)}(o)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}let Lj=(()=>{class t extends L0{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}}return t.\u0275fac=function(n){return new(n||t)(ae(rr))},t.\u0275prov=ve({token:t,factory:t.\u0275fac}),t})();const W0=["alt","control","meta","shift"],Vj={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Bj={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let jj=(()=>{class t extends L0{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,i){const s=t.parseEventName(r),o=t.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ks().onAndCancel(n,s.domEventName,o))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=t._normalizeKey(r.pop());let o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),W0.forEach(c=>{const l=r.indexOf(c);l>-1&&(r.splice(l,1),o+=c+".")}),o+=s,0!=r.length||0===s.length)return null;const u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(n,r){let i=Vj[n.key]||n.key,s="";return r.indexOf("code.")>-1&&(i=n.code,s="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),W0.forEach(o=>{o!==i&&(0,Bj[o])(n)&&(s+=o+".")}),s+=i,s===r)}static eventCallback(n,r,i){return s=>{t.matchEventFullKeyCode(s,n)&&i.runGuarded(()=>r(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return t.\u0275fac=function(n){return new(n||t)(ae(rr))},t.\u0275prov=ve({token:t,factory:t.\u0275fac}),t})();const Q0=[{provide:Bb,useValue:"browser"},{provide:Vb,useValue:function Uj(){Yp.makeCurrent()},multi:!0},{provide:rr,useFactory:function Hj(){return function gO(t){lf=t}(document),document},deps:[]}],Gj=Wb(SB,"browser",Q0),Y0=new $(""),Z0=[{provide:Uc,useClass:class Aj{addToWindow(e){De.getAngularTestability=(r,i=!0)=>{const s=e.findTestabilityInTree(r,i);if(null==s)throw new Error("Could not find testability for element.");return s},De.getAllAngularTestabilities=()=>e.getAllTestabilities(),De.getAllAngularRootElements=()=>e.getAllRootElements(),De.frameworkStabilizers||(De.frameworkStabilizers=[]),De.frameworkStabilizers.push(r=>{const i=De.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(u){o=o||u,s--,0==s&&r(o)};i.forEach(function(u){u.whenStable(a)})})}findTestabilityInTree(e,n,r){return null==n?null:e.getTestability(n)??(r?ks().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},deps:[]},{provide:Gb,useClass:Ep,deps:[vt,Cp,Uc]},{provide:Ep,useClass:Ep,deps:[vt,Cp,Uc]}],X0=[{provide:_f,useValue:"root"},{provide:ys,useFactory:function $j(){return new ys},deps:[]},{provide:il,useClass:Lj,multi:!0,deps:[rr,vt,Bb]},{provide:il,useClass:jj,multi:!0,deps:[rr]},{provide:Jp,useClass:Jp,deps:[sl,ha,oa,U0]},{provide:xw,useExisting:Jp},{provide:V0,useExisting:ha},{provide:ha,useClass:ha,deps:[rr]},{provide:sl,useClass:sl,deps:[il,vt]},{provide:class Y2{},useClass:Mj,deps:[]},[]];let qj=(()=>{class t{constructor(n){}static withServerTransition(n){return{ngModule:t,providers:[{provide:oa,useValue:n.appId},{provide:k0,useExisting:oa},Tj]}}}return t.\u0275fac=function(n){return new(n||t)(ae(Y0,12))},t.\u0275mod=mr({type:t}),t.\u0275inj=$n({providers:[...X0,...Z0],imports:[q2,TB]}),t})();typeof window<"u"&&window;const tI=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},nI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0;let h=(15&a)<<2|c>>6,f=63&c;u||(f=64,o||(h=64)),r.push(n[s>>2],n[(3&s)<<4|a>>4],n[h],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(tI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const u=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(1023&u))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const d=i<t.length?n[t.charAt(i)]:64;if(++i,null==s||null==a||null==c||null==d)throw new nU;r.push(s<<2|a>>4),64!==c&&(r.push(a<<4&240|c>>2),64!==d&&r.push(c<<6&192|d))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class nU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ol=function(t){return function(t){const e=tI(t);return nI.encodeByteArray(e,!0)}(t).replace(/\./g,"")};function fa(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!iU(n)||(t[n]=fa(t[n],e[n]));return t}function iU(t){return"__proto__"!==t}const al=()=>{try{return function sU(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&function(t){try{return nI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null}(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},lU=()=>{var t;return null===(t=al())||void 0===t?void 0:t.config};class rI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(n):e(n,r))}}}function mi(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function iI(){try{return"object"==typeof indexedDB}catch{return!1}}class yi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,yi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ul.prototype.create)}}class ul{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?function yU(t,e){return t.replace(vU,(n,r)=>{const i=e[r];return null!=i?String(i):`<${r}?>`})}(s,r):"Error";return new yi(i,`${this.serviceName}: ${o} (${i}).`,r)}}const vU=/\{\$([^}]+)}/g;function oI(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function og(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(aI(s)&&aI(o)){if(!og(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function aI(t){return null!==t&&"object"==typeof t}function _U(t,e){const n=new DU(t,e);return n.subscribe.bind(n)}class DU{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(void 0===e&&void 0===n&&void 0===r)throw new Error("Missing Observer.");i=function wU(t,e){if("object"!=typeof t||null===t)return!1;for(const n of e)if(n in t&&"function"==typeof t[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:n,complete:r},void 0===i.next&&(i.next=ag),void 0===i.error&&(i.error=ag),void 0===i.complete&&(i.complete=ag);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ag(){}function We(t){return t&&t._delegate?t._delegate:t}function uI(t,e,n,r,i,s,o){try{var a=t[s](o),u=a.value}catch(c){return void n(c)}a.done?e(u):Promise.resolve(u).then(r,i)}function D(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function o(u){uI(s,r,i,o,a,"next",u)}function a(u){uI(s,r,i,o,a,"throw",u)}o(void 0)})}}class vi{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const _i="[DEFAULT]";class TU{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new rI;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e?.identifier),i=null!==(n=e?.optional)&&void 0!==n&&n;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function MU(t){return"EAGER"===t.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:_i})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=_i){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return D(function*(){const n=Array.from(e.instances.values());yield Promise.all([...n.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...n.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=_i){return this.instances.has(e)}getOptions(e=_i){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(s)&&o.resolve(i);return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=null!==(r=this.onInitCallbacks.get(i))&&void 0!==r?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(t=e,t===_i?void 0:t),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}var t;return r||null}normalizeInstanceIdentifier(e=_i){return this.component?this.component.multipleInstances?e:_i:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class xU{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new TU(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}const cg=[];var oe=(()=>{return(t=oe||(oe={}))[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",oe;var t})();const cI={debug:oe.DEBUG,verbose:oe.VERBOSE,info:oe.INFO,warn:oe.WARN,error:oe.ERROR,silent:oe.SILENT},NU=oe.INFO,FU={[oe.DEBUG]:"log",[oe.VERBOSE]:"log",[oe.INFO]:"info",[oe.WARN]:"warn",[oe.ERROR]:"error"},OU=(t,e,...n)=>{if(e<t.logLevel)return;const r=(new Date).toISOString(),i=FU[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${r}]  ${t.name}:`,...n)};class lg{constructor(e){this.name=e,this._logLevel=NU,this._logHandler=OU,this._userLogHandler=null,cg.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in oe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?cI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,oe.DEBUG,...e),this._logHandler(this,oe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,oe.VERBOSE,...e),this._logHandler(this,oe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,oe.INFO,...e),this._logHandler(this,oe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,oe.WARN,...e),this._logHandler(this,oe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,oe.ERROR,...e),this._logHandler(this,oe.ERROR,...e)}}const kU=(t,e)=>e.some(n=>t instanceof n);let lI,dI;const hI=new WeakMap,dg=new WeakMap,fI=new WeakMap,hg=new WeakMap,fg=new WeakMap;let pg={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return dg.get(t);if("objectStoreNames"===e)return t.objectStoreNames||fI.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Cr(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function HU(t){return"function"==typeof t?function $U(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function VU(){return dI||(dI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(t)?function(...e){return t.apply(gg(this),e),Cr(hI.get(this))}:function(...e){return Cr(t.apply(gg(this),e))}:function(e,...n){const r=t.call(gg(this),e,...n);return fI.set(r,e.sort?e.sort():[e]),Cr(r)}}(t):(t instanceof IDBTransaction&&function jU(t){if(dg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});dg.set(t,e)}(t),kU(t,function LU(){return lI||(lI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(t,pg):t)}function Cr(t){if(t instanceof IDBRequest)return function BU(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Cr(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&hI.set(n,t)}).catch(()=>{}),fg.set(e,t),e}(t);if(hg.has(t))return hg.get(t);const e=HU(t);return e!==t&&(hg.set(t,e),fg.set(e,t)),e}const gg=t=>fg.get(t),qU=["get","getKey","getAll","getAllKeys","count"],zU=["put","add","delete","clear"],mg=new Map;function pI(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(mg.get(e))return mg.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=zU.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!qU.includes(n))return;const s=function(){var o=D(function*(a,...u){const c=this.transaction(a,i?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(u.shift())),(yield Promise.all([l[n](...u),i&&c.done]))[0]});return function(u){return o.apply(this,arguments)}}();return mg.set(e,s),s}!function UU(t){pg=t(pg)}(t=>({...t,get:(e,n,r)=>pI(e,n)||t.get(e,n,r),has:(e,n)=>!!pI(e,n)||t.has(e,n)}));class WU{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(function KU(t){return"VERSION"===t.getComponent()?.type}(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}return null}).filter(n=>n).join(" ")}}const yg="@firebase/app",Di=new lg("@firebase/app"),br="[DEFAULT]",D$={[yg]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Ir=new Map,pa=new Map;function ll(t,e){try{t.container.addComponent(e)}catch(n){Di.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function mI(t,e){t.container.addOrOverwriteComponent(e)}function Ls(t){const e=t.name;if(pa.has(e))return Di.debug(`There were multiple attempts to register component ${e}.`),!1;pa.set(e,t);for(const n of Ir.values())ll(n,t);return!0}function yI(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function w$(t,e,n=br){yI(t,e).clearInstance(n)}function E$(){pa.clear()}const sr=new ul("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class b${constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new vi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw sr.create("app-deleted",{appName:this._name})}}const vg="9.20.0";function _g(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const r=Object.assign({name:br,automaticDataCollectionEnabled:!1},e),i=r.name;if("string"!=typeof i||!i)throw sr.create("bad-app-name",{appName:String(i)});if(n||(n=lU()),!n)throw sr.create("no-options");const s=Ir.get(i);if(s){if(og(n,s.options)&&og(r,s.config))return s;throw sr.create("duplicate-app",{appName:i})}const o=new xU(i);for(const u of pa.values())o.addComponent(u);const a=new b$(n,r,o);return Ir.set(i,a),a}function I$(t=br){const e=Ir.get(t);if(!e&&t===br)return _g();if(!e)throw sr.create("no-app",{appName:t});return e}function S$(){return Array.from(Ir.values())}function vI(t){return Dg.apply(this,arguments)}function Dg(){return(Dg=D(function*(t){const e=t.name;Ir.has(e)&&(Ir.delete(e),yield Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)})).apply(this,arguments)}function Sr(t,e,n){var r;let i=null!==(r=D$[t])&&void 0!==r?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];return s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void Di.warn(a.join(" "))}Ls(new vi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function _I(t,e){if(null!==t&&"function"!=typeof t)throw sr.create("invalid-log-argument");!function RU(t,e){for(const n of cg){let r=null;e&&e.level&&(r=cI[e.level]),n.userLogHandler=null===t?null:(i,s,...o)=>{const a=o.map(u=>{if(null==u)return null;if("string"==typeof u)return u;if("number"==typeof u||"boolean"==typeof u)return u.toString();if(u instanceof Error)return u.message;try{return JSON.stringify(u)}catch{return null}}).filter(u=>u).join(" ");s>=(r??i.logLevel)&&t({level:oe[s].toLowerCase(),message:a,args:o,type:i.name})}}}(t,e)}function DI(t){!function PU(t){cg.forEach(e=>{e.setLogLevel(t)})}(t)}const T$="firebase-heartbeat-database",A$=1,ga="firebase-heartbeat-store";let wg=null;function wI(){return wg||(wg=function GU(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Cr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Cr(o.result),u.oldVersion,u.newVersion,Cr(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}(T$,A$,{upgrade:(t,e)=>{0===e&&t.createObjectStore(ga)}}).catch(t=>{throw sr.create("idb-open",{originalErrorMessage:t.message})})),wg}function Eg(){return(Eg=D(function*(t){try{return(yield wI()).transaction(ga).objectStore(ga).get(CI(t))}catch(e){if(e instanceof yi)Di.warn(e.message);else{const n=sr.create("idb-get",{originalErrorMessage:e?.message});Di.warn(n.message)}}})).apply(this,arguments)}function EI(t,e){return Cg.apply(this,arguments)}function Cg(){return(Cg=D(function*(t,e){try{const r=(yield wI()).transaction(ga,"readwrite");return yield r.objectStore(ga).put(e,CI(t)),r.done}catch(n){if(n instanceof yi)Di.warn(n.message);else{const r=sr.create("idb-set",{originalErrorMessage:n?.message});Di.warn(r.message)}}})).apply(this,arguments)}function CI(t){return`${t.name}!${t.options.appId}`}class F${constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new P$(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var e=this;return D(function*(){const r=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=bI();if(null===e._heartbeatsCache&&(e._heartbeatsCache=yield e._heartbeatsCachePromise),e._heartbeatsCache.lastSentHeartbeatDate!==i&&!e._heartbeatsCache.heartbeats.some(s=>s.date===i))return e._heartbeatsCache.heartbeats.push({date:i,agent:r}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(s=>{const o=new Date(s.date).valueOf();return Date.now()-o<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return D(function*(){if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null===e._heartbeatsCache||0===e._heartbeatsCache.heartbeats.length)return"";const n=bI(),{heartbeatsToSend:r,unsentEntries:i}=function O$(t,e=1024){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),II(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),II(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(e._heartbeatsCache.heartbeats),s=ol(JSON.stringify({version:2,heartbeats:r}));return e._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(e._heartbeatsCache.heartbeats=i,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),s})()}}function bI(){return(new Date).toISOString().substring(0,10)}class P${constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return D(function*(){return!!iI()&&function gU(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e((null===(s=i.error)||void 0===s?void 0:s.message)||"")}}catch(n){e(n)}})}().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return D(function*(){return(yield e._canUseIndexedDBPromise)&&(yield function M$(t){return Eg.apply(this,arguments)}(e.app))||{heartbeats:[]}})()}overwrite(e){var n=this;return D(function*(){var r;if(yield n._canUseIndexedDBPromise){const s=yield n.read();return EI(n.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var n=this;return D(function*(){var r;if(yield n._canUseIndexedDBPromise){const s=yield n.read();return EI(n.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}})()}}function II(t){return ol(JSON.stringify({version:2,heartbeats:t})).length}!function R$(t){Ls(new vi("platform-logger",e=>new WU(e),"PRIVATE")),Ls(new vi("heartbeat",e=>new F$(e),"PRIVATE")),Sr(yg,"0.9.8",t),Sr(yg,"0.9.8","esm2017"),Sr("fire-js","")}("");class k${constructor(e,n){this._delegate=e,this.firebase=n,ll(e,new vi("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),vI(this._delegate)))}_getService(e,n=br){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&"EXPLICIT"===(null===(r=i.getComponent())||void 0===r?void 0:r.instantiationMode)&&i.initialize(),i.getImmediate({identifier:n})}_removeServiceInstance(e,n=br){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){ll(this._delegate,e)}_addOrOverwriteComponent(e){mI(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const SI=new ul("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),B$=function TI(){const t=function V$(t){const e={},n={__esModule:!0,initializeApp:function s(c,l={}){const d=_g(c,l);if(oI(e,d.name))return e[d.name];const h=new t(d,n);return e[d.name]=h,h},app:i,registerVersion:Sr,setLogLevel:DI,onLog:_I,apps:null,SDK_VERSION:vg,INTERNAL:{registerComponent:function a(c){const l=c.name,d=l.replace("-compat","");if(Ls(c)&&"PUBLIC"===c.type){const h=(f=i())=>{if("function"!=typeof f[d])throw SI.create("invalid-app-argument",{appName:l});return f[d]()};void 0!==c.serviceProps&&fa(h,c.serviceProps),n[d]=h,t.prototype[d]=function(...f){return this._getService.bind(this,l).apply(this,c.multipleInstances?f:[])}}return"PUBLIC"===c.type?n[d]:null},removeApp:function r(c){delete e[c]},useAsService:function u(c,l){return"serverAuth"===l?null:l},modularAPIs:Do}};function i(c){if(!oI(e,c=c||br))throw SI.create("no-app",{appName:c});return e[c]}return n.default=n,Object.defineProperty(n,"apps",{get:function o(){return Object.keys(e).map(c=>e[c])}}),i.App=t,n}(k$);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:TI,extendNamespace:function e(n){fa(t,n)},createSubscribe:_U,ErrorFactory:ul,deepExtend:fa}),t}(),AI=new lg("@firebase/app-compat");if(function fU(){return"object"==typeof self&&self.self===self}()&&void 0!==self.firebase){AI.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&AI.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const dl=B$;!function $$(t){Sr("@firebase/app-compat","0.2.8",t)}(),dl.registerVersion("firebase","9.20.0","app-compat");var P,q$=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},or={},bg=bg||{},G=q$||self;function hl(){}function fl(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function ma(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Ig="closure_uid_"+(1e9*Math.random()>>>0),W$=0;function K$(t,e,n){return t.call.apply(t.bind,arguments)}function Q$(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function _t(t,e,n){return(_t=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?K$:Q$).apply(null,arguments)}function pl(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function at(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Wb=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Tr(){this.s=this.s,this.o=this.o}Tr.prototype.s=!1,Tr.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function z$(t){Object.prototype.hasOwnProperty.call(t,Ig)&&t[Ig]||(t[Ig]=++W$)}(this)},Tr.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const MI=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Sg(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function xI(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(fl(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Dt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Dt.prototype.h=function(){this.defaultPrevented=!0};var Z$=function(){if(!G.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{G.addEventListener("test",hl,e),G.removeEventListener("test",hl,e)}catch{}return t}();function gl(t){return/^[\s\xa0]*$/.test(t)}var NI=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Tg(t,e){return t<e?-1:t>e?1:0}function ml(){var t=G.navigator;return t&&(t=t.userAgent)?t:""}function Fn(t){return-1!=ml().indexOf(t)}function Ag(t){return Ag[" "](t),t}Ag[" "]=hl;var yl,t,J$=Fn("Opera"),Vs=Fn("Trident")||Fn("MSIE"),FI=Fn("Edge"),Mg=FI||Vs,OI=Fn("Gecko")&&!(-1!=ml().toLowerCase().indexOf("webkit")&&!Fn("Edge"))&&!(Fn("Trident")||Fn("MSIE"))&&!Fn("Edge"),eH=-1!=ml().toLowerCase().indexOf("webkit")&&!Fn("Edge");function PI(){var t=G.document;return t?t.documentMode:void 0}e:{var xg="",Ng=(t=ml(),OI?/rv:([^\);]+)(\)|;)/.exec(t):FI?/Edge\/([\d\.]+)/.exec(t):Vs?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):eH?/WebKit\/(\S+)/.exec(t):J$?/(?:Version)[ \/]?(\S+)/.exec(t):void 0);if(Ng&&(xg=Ng?Ng[1]:""),Vs){var Fg=PI();if(null!=Fg&&Fg>parseFloat(xg)){yl=String(Fg);break e}}yl=xg}var tH={};var rH=G.document&&Vs&&(PI()||parseInt(yl,10))||void 0;function ya(t,e){if(Dt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(OI){e:{try{Ag(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:iH[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ya.X.h.call(this)}}at(ya,Dt);var iH={2:"touch",3:"pen",4:"mouse"};ya.prototype.h=function(){ya.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var va="closure_listenable_"+(1e6*Math.random()|0),sH=0;function oH(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ha=i,this.key=++sH,this.ba=this.ea=!1}function vl(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function Pg(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function kI(t){const e={};for(const n in t)e[n]=t[n];return e}const LI="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function VI(t,e){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(let s=0;s<LI.length;s++)n=LI[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function _l(t){this.src=t,this.g={},this.h=0}function Rg(t,e){var n=e.type;if(n in t.g){var s,r=t.g[n],i=MI(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(vl(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function kg(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.ba&&s.listener==e&&s.capture==!!n&&s.ha==r)return i}return-1}_l.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=kg(t,e,r,i);return-1<o?(e=t[o],n||(e.ea=!1)):((e=new oH(e,this.src,s,!!r,i)).ea=n,t.push(e)),e};var Lg="closure_lm_"+(1e6*Math.random()|0),Vg={};function BI(t,e,n,r,i){if(r&&r.once)return UI(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)BI(t,e[s],n,r,i);return null}return n=$g(n),t&&t[va]?t.N(e,n,ma(r)?!!r.capture:!!r,i):jI(t,e,n,!1,r,i)}function jI(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=ma(i)?!!i.capture:!!i,a=jg(t);if(a||(t[Lg]=a=new _l(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function aH(){const e=uH;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Z$||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(HI(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function UI(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)UI(t,e[s],n,r,i);return null}return n=$g(n),t&&t[va]?t.O(e,n,ma(r)?!!r.capture:!!r,i):jI(t,e,n,!0,r,i)}function $I(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)$I(t,e[s],n,r,i);else r=ma(r)?!!r.capture:!!r,n=$g(n),t&&t[va]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=kg(s=t.g[e],n,r,i))&&(vl(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=jg(t))&&(e=t.g[e.toString()],t=-1,e&&(t=kg(e,n,r,i)),(n=-1<t?e[t]:null)&&Bg(n))}function Bg(t){if("number"!=typeof t&&t&&!t.ba){var e=t.src;if(e&&e[va])Rg(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(HI(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jg(e))?(Rg(n,t),0==n.h&&(n.src=null,e[Lg]=null)):vl(t)}}}function HI(t){return t in Vg?Vg[t]:Vg[t]="on"+t}function uH(t,e){if(t.ba)t=!0;else{e=new ya(e,this);var n=t.listener,r=t.ha||t.src;t.ea&&Bg(t),t=n.call(r,e)}return t}function jg(t){return(t=t[Lg])instanceof _l?t:null}var Ug="__closure_events_fn_"+(1e9*Math.random()>>>0);function $g(t){return"function"==typeof t?t:(t[Ug]||(t[Ug]=function(e){return t.handleEvent(e)}),t[Ug])}function et(){Tr.call(this),this.i=new _l(this),this.P=this,this.I=null}function ut(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new Dt(e,t);else if(e instanceof Dt)e.target=e.target||t;else{var i=e;VI(e=new Dt(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Dl(o,r,!0,e)&&i}if(i=Dl(o=e.g=t,r,!0,e)&&i,i=Dl(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=Dl(o=e.g=n[s],r,!1,e)&&i}function Dl(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ba&&o.capture==n){var a=o.listener,u=o.ha||o.src;o.ea&&Rg(t.i,o),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}at(et,Tr),et.prototype[va]=!0,et.prototype.removeEventListener=function(t,e,n,r){$I(this,t,e,n,r)},et.prototype.M=function(){if(et.X.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)vl(n[r]);delete t.g[e],t.h--}}this.I=null},et.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},et.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Hg=G.JSON.stringify;function cH(){var t=zI;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Gg,GI=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new dH,t=>t.reset());class dH{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function hH(t){G.setTimeout(()=>{throw t},0)}function qI(t,e){Gg||function fH(){var t=G.Promise.resolve(void 0);Gg=function(){t.then(pH)}}(),qg||(Gg(),qg=!0),zI.add(t,e)}var qg=!1,zI=new class lH{constructor(){this.h=this.g=null}add(e,n){const r=GI.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}};function pH(){for(var t;t=cH();){try{t.h.call(t.g)}catch(n){hH(n)}var e=GI;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}qg=!1}function wl(t,e){et.call(this),this.h=t||1,this.g=e||G,this.j=_t(this.lb,this),this.l=Date.now()}function zg(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}function Wg(t,e,n){if("function"==typeof t)n&&(t=_t(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_t(t.handleEvent,t)}return 2147483647<Number(e)?-1:G.setTimeout(t,e||0)}function WI(t){t.g=Wg(()=>{t.g=null,t.i&&(t.i=!1,WI(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}at(wl,et),(P=wl.prototype).ca=!1,P.R=null,P.lb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),ut(this,"tick"),this.ca&&(zg(this),this.start()))}},P.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},P.M=function(){wl.X.M.call(this),zg(this),delete this.g};class gH extends Tr{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:WI(this)}M(){super.M(),this.g&&(G.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _a(t){Tr.call(this),this.h=t,this.g={}}at(_a,Tr);var KI=[];function QI(t,e,n,r){Array.isArray(n)||(n&&(KI[0]=n.toString()),n=KI);for(var i=0;i<n.length;i++){var s=BI(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function YI(t){Pg(t.g,function(e,n){this.g.hasOwnProperty(n)&&Bg(e)},t),t.g={}}function El(){this.g=!0}function Bs(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function _H(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Hg(n)}catch{return e}}(t,n)+(r?" "+r:"")})}_a.prototype.M=function(){_a.X.M.call(this),YI(this)},_a.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},El.prototype.Aa=function(){this.g=!1},El.prototype.info=function(){};var wi={},ZI=null;function Cl(){return ZI=ZI||new et}function XI(t){Dt.call(this,wi.Pa,t)}function Da(t){const e=Cl();ut(e,new XI(e))}function JI(t,e){Dt.call(this,wi.STAT_EVENT,t),this.stat=e}function Mt(t){const e=Cl();ut(e,new JI(e,t))}function eS(t,e){Dt.call(this,wi.Qa,t),this.size=e}function wa(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return G.setTimeout(function(){t()},e)}wi.Pa="serverreachability",at(XI,Dt),wi.STAT_EVENT="statevent",at(JI,Dt),wi.Qa="timingevent",at(eS,Dt);var bl={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},tS={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function Kg(){}function rS(){}Kg.prototype.h=null;var Zg,Ea={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function Qg(){Dt.call(this,"d")}function Yg(){Dt.call(this,"c")}function Il(){}function Ca(t,e,n,r){this.l=t,this.j=e,this.m=n,this.U=r||1,this.S=new _a(this),this.O=DH,this.T=new wl(t=Mg?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new iS}function iS(){this.i=null,this.g="",this.h=!1}at(Qg,Dt),at(Yg,Dt),at(Il,Kg),Il.prototype.g=function(){return new XMLHttpRequest},Il.prototype.i=function(){return{}},Zg=new Il;var DH=45e3,Xg={},Sl={};function Jg(t,e,n){t.K=1,t.v=xl(ar(e)),t.s=n,t.P=!0,sS(t,null)}function sS(t,e){t.F=Date.now(),ba(t),t.A=ar(t.v);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),gS(n.i,"t",r),t.C=0,n=t.l.H,t.h=new iS,t.g=BS(t.l,n?e:null,!t.s),0<t.N&&(t.L=new gH(_t(t.La,t,t.g),t.N)),QI(t.S,t.g,"readystatechange",t.ib),e=t.H?kI(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),Da(),function mH(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var d=l.split("_");o=2<=d.length&&"type"==d[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o})}(t.j,t.u,t.A,t.m,t.U,t.s)}function oS(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Da}function aS(t,e,n){let i,r=!0;for(;!t.I&&t.C<n.length;){if(i=wH(t,n),i==Sl){4==e&&(t.o=4,Mt(14),r=!1),Bs(t.j,t.m,null,"[Incomplete Response]");break}if(i==Xg){t.o=4,Mt(15),Bs(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}Bs(t.j,t.m,i,null),em(t,i)}oS(t)&&i!=Sl&&i!=Xg&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Mt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.$&&(t.$=!0,(e=t.l).g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),um(e),e.K=!0,Mt(11))):(Bs(t.j,t.m,n,"[Invalid Chunked Response]"),Ei(t),Ia(t))}function wH(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Sl:(n=Number(e.substring(n,r)),isNaN(n)?Xg:(r+=1)+n>e.length?Sl:(e=e.substr(r,n),t.C=r+n,e))}function ba(t){t.V=Date.now()+t.O,uS(t,t.O)}function uS(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=wa(_t(t.gb,t),e)}function Tl(t){t.B&&(G.clearTimeout(t.B),t.B=null)}function Ia(t){0==t.l.G||t.I||RS(t.l,t)}function Ei(t){Tl(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,zg(t.T),YI(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function em(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||tm(n.h,t)))if(!t.J&&tm(n.h,t)&&3==n.G){try{var r=n.Fa.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break e;kl(n),Pl(n)}am(n),Mt(18)}}else n.Ba=i[1],0<n.Ba-n.T&&37500>i[2]&&n.L&&0==n.A&&!n.v&&(n.v=wa(_t(n.cb,n),6e3));if(1>=vS(n.h)&&n.ja){try{n.ja()}catch{}n.ja=void 0}}else bi(n,11)}else if((t.J||n.g==t)&&kl(n),!gl(e))for(i=n.Fa.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.I=c[1],n.ka=c[2];const l=c[3];null!=l&&(n.ma=l,n.j.info("VER="+n.ma));const d=c[4];null!=d&&(n.Ca=d,n.j.info("SVER="+n.Ca));const h=c[5];null!=h&&"number"==typeof h&&0<h&&(n.J=r=1.5*h,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.h;s.g||-1==p.indexOf("spdy")&&-1==p.indexOf("quic")&&-1==p.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(nm(s,s.h),s.h=null))}if(r.D){const g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.za=g,Se(r.F,r.D,g))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-t.F,n.j.info("Handshake RTT: "+n.P+"ms"));var o=t;if((r=n).sa=VS(r,r.H?r.ka:null,r.V),o.J){_S(r.h,o);var a=o,u=r.J;u&&a.setTimeout(u),a.B&&(Tl(a),ba(a)),r.g=o}else OS(r);0<n.i.length&&Rl(n)}else"stop"!=c[0]&&"close"!=c[0]||bi(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?bi(n,7):om(n):"noop"!=c[0]&&n.l&&n.l.wa(c),n.A=0)}Da()}catch{}}function cS(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(fl(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function CH(t){if(t.oa&&"function"==typeof t.oa)return t.oa();if(!t.W||"function"!=typeof t.W){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(fl(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function EH(t){if(t.W&&"function"==typeof t.W)return t.W();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(fl(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}(P=Ca.prototype).setTimeout=function(t){this.O=t},P.ib=function(t){t=t.target;const e=this.L;e&&3==ur(t)?e.l():this.La(t)},P.La=function(t){try{if(t==this.g)e:{const l=ur(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>l)&&(3!=l||Mg||this.g&&(this.h.h||this.g.fa()||TS(this.g)))){this.I||4!=l||7==e||Da(),Tl(this);var n=this.g.aa();this.Y=n;t:if(oS(this)){var r=TS(this.g);t="";var i=r.length,s=4==ur(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Ei(this),Ia(this);var o="";break t}this.h.i=new G.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==n,function yH(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.U,l,n),this.i){if(this.Z&&!this.J){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!gl(a)){var c=a;break t}}c=null}if(!(n=c)){this.i=!1,this.o=3,Mt(12),Ei(this),Ia(this);break e}Bs(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,em(this,n)}this.P?(aS(this,l,o),Mg&&this.i&&3==l&&(QI(this.S,this.T,"tick",this.hb),this.T.start())):(Bs(this.j,this.m,o,null),em(this,o)),4==l&&Ei(this),this.i&&!this.I&&(4==l?RS(this.l,this):(this.i=!1,ba(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Mt(12)):(this.o=0,Mt(13)),Ei(this),Ia(this)}}}catch{}},P.hb=function(){if(this.g){var t=ur(this.g),e=this.g.fa();this.C<e.length&&(Tl(this),aS(this,t,e),this.i&&4!=t&&ba(this))}},P.cancel=function(){this.I=!0,Ei(this)},P.gb=function(){this.B=null;const t=Date.now();0<=t-this.V?(function vH(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Da(),Mt(17)),Ei(this),this.o=2,Ia(this)):uS(this,this.V-t)};var lS=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ci(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ci){this.h=void 0!==e?e:t.h,Al(this,t.j),this.s=t.s,this.g=t.g,Ml(this,t.m),this.l=t.l,e=t.i;var n=new Aa;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),dS(this,n),this.o=t.o}else t&&(n=String(t).match(lS))?(this.h=!!e,Al(this,n[1]||"",!0),this.s=Sa(n[2]||""),this.g=Sa(n[3]||"",!0),Ml(this,n[4]),this.l=Sa(n[5]||"",!0),dS(this,n[6]||"",!0),this.o=Sa(n[7]||"")):(this.h=!!e,this.i=new Aa(null,this.h))}function ar(t){return new Ci(t)}function Al(t,e,n){t.j=n?Sa(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Ml(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function dS(t,e,n){e instanceof Aa?(t.i=e,function xH(t,e){e&&!t.j&&(Ar(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(fS(this,r),gS(this,i,n))},t)),t.j=e}(t.i,t.h)):(n||(e=Ta(e,AH)),t.i=new Aa(e,t.h))}function Se(t,e,n){t.i.set(e,n)}function xl(t){return Se(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Sa(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ta(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,IH),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function IH(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ci.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ta(e,hS,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Ta(e,hS,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ta(n,"/"==n.charAt(0)?TH:SH,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Ta(n,MH)),t.join("")};var hS=/[#\/\?@]/g,SH=/[#\?:]/g,TH=/[#\?]/g,AH=/[#\?@]/g,MH=/#/g;function Aa(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ar(t){t.g||(t.g=new Map,t.h=0,t.i&&function bH(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function fS(t,e){Ar(t),e=js(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function pS(t,e){return Ar(t),e=js(t,e),t.g.has(e)}function gS(t,e,n){fS(t,e),0<n.length&&(t.i=null,t.g.set(js(t,e),Sg(n)),t.h+=n.length)}function js(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function mS(t){this.l=t||FH,t=G.PerformanceNavigationTiming?0<(t=G.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(G.g&&G.g.Ga&&G.g.Ga()&&G.g.Ga().$b),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(P=Aa.prototype).add=function(t,e){Ar(this),this.i=null,t=js(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},P.forEach=function(t,e){Ar(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)},P.oa=function(){Ar(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n},P.W=function(t){Ar(this);let e=[];if("string"==typeof t)pS(this,t)&&(e=e.concat(this.g.get(js(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},P.set=function(t,e){return Ar(this),this.i=null,pS(this,t=js(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},P.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},P.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};var FH=10;function yS(t){return!!t.h||!!t.g&&t.g.size>=t.j}function vS(t){return t.h?1:t.g?t.g.size:0}function tm(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function nm(t,e){t.g?t.g.add(e):t.h=e}function _S(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function DS(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return Sg(t.i)}function rm(){}function OH(){this.g=new rm}function PH(t,e,n){const r=n||"";try{cS(t,function(i,s){let o=i;ma(i)&&(o=Hg(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Nl(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Ma(t){this.l=t.ac||null,this.j=t.jb||!1}function Fl(t,e){et.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=im,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}mS.prototype.cancel=function(){if(this.i=DS(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},rm.prototype.stringify=function(t){return G.JSON.stringify(t,void 0)},rm.prototype.parse=function(t){return G.JSON.parse(t,void 0)},at(Ma,Kg),Ma.prototype.g=function(){return new Fl(this.l,this.j)},Ma.prototype.i=function(t){return function(){return t}}({}),at(Fl,et);var im=0;function wS(t){t.j.read().then(t.Ta.bind(t)).catch(t.ga.bind(t))}function xa(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Na(t)}function Na(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(P=Fl.prototype).open=function(t,e){if(this.readyState!=im)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Na(this)},P.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||G).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},P.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,xa(this)),this.readyState=im},P.Wa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Na(this)),this.g&&(this.readyState=3,Na(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof G.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;wS(this)}else t.text().then(this.Va.bind(this),this.ga.bind(this))},P.Ta=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?xa(this):Na(this),3==this.readyState&&wS(this)}},P.Va=function(t){this.g&&(this.response=this.responseText=t,xa(this))},P.Ua=function(t){this.g&&(this.response=t,xa(this))},P.ga=function(){this.g&&xa(this)},P.setRequestHeader=function(t,e){this.v.append(t,e)},P.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},P.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Fl.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var kH=G.JSON.parse;function Oe(t){et.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=ES,this.K=this.L=!1}at(Oe,et);var ES="",LH=/^https?$/i,VH=["POST","PUT"];function CS(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,bS(t),Ol(t)}function bS(t){t.D||(t.D=!0,ut(t,"complete"),ut(t,"error"))}function IS(t){if(t.h&&typeof bg<"u"&&(!t.C[1]||4!=ur(t)||2!=t.aa()))if(t.v&&4==ur(t))Wg(t.Ha,0,t);else if(ut(t,"readystatechange"),4==ur(t)){t.h=!1;try{const a=t.aa();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=0===a){var i=String(t.H).match(lS)[1]||null;if(!i&&G.self&&G.self.location){var s=G.self.location.protocol;i=s.substr(0,s.length-1)}r=!LH.test(i?i.toLowerCase():"")}n=r}if(n)ut(t,"complete"),ut(t,"success");else{t.m=6;try{var o=2<ur(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.aa()+"]",bS(t)}}finally{Ol(t)}}}function Ol(t,e){if(t.g){SS(t);const n=t.g,r=t.C[0]?hl:null;t.g=null,t.C=null,e||ut(t,"ready");try{n.onreadystatechange=r}catch{}}}function SS(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(G.clearTimeout(t.A),t.A=null)}function ur(t){return t.g?t.g.readyState:0}function TS(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case ES:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function AS(t){let e="";return Pg(t,function(n,r){e+=r,e+=":",e+=n,e+="\r\n"}),e}function sm(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=AS(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Se(t,e,n))}function Fa(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function MS(t){this.Ca=0,this.i=[],this.j=new El,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Fa("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Fa("baseRetryDelayMs",5e3,t),this.bb=Fa("retryDelaySeedMs",1e4,t),this.$a=Fa("forwardChannelMaxRetries",2,t),this.ta=Fa("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Zb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new mS(t&&t.concurrentRequestLimit),this.Fa=new OH,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=t&&t.Xb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function om(t){if(xS(t),3==t.G){var e=t.U++,n=ar(t.F);Se(n,"SID",t.I),Se(n,"RID",e),Se(n,"TYPE","terminate"),Oa(t,n),(e=new Ca(t,t.j,e,void 0)).K=2,e.v=xl(ar(n)),n=!1,G.navigator&&G.navigator.sendBeacon&&(n=G.navigator.sendBeacon(e.v.toString(),"")),!n&&G.Image&&((new Image).src=e.v,n=!0),n||(e.g=BS(e.l,null),e.g.da(e.v)),e.F=Date.now(),ba(e)}LS(t)}function Pl(t){t.g&&(um(t),t.g.cancel(),t.g=null)}function xS(t){Pl(t),t.u&&(G.clearTimeout(t.u),t.u=null),kl(t),t.h.cancel(),t.m&&("number"==typeof t.m&&G.clearTimeout(t.m),t.m=null)}function Rl(t){yS(t.h)||t.m||(t.m=!0,qI(t.Ja,t),t.C=0)}function NS(t,e){var n;n=e?e.m:t.U++;const r=ar(t.F);Se(r,"SID",t.I),Se(r,"RID",n),Se(r,"AID",t.T),Oa(t,r),t.o&&t.s&&sm(r,t.o,t.s),n=new Ca(t,t.j,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.i=e.D.concat(t.i)),e=FS(t,n,1e3),n.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),nm(t.h,n),Jg(n,r,e)}function Oa(t,e){t.ia&&Pg(t.ia,function(n,r){Se(e,r,n)}),t.l&&cS({},function(n,r){Se(e,r,n)})}function FS(t,e,n){n=Math.min(t.i.length,n);var r=t.l?_t(t.l.Ra,t.l,t):null;e:{var i=t.i;let s=-1;for(;;){const o=["count="+n];-1==s?0<n?(s=i[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let c=i[u].h;const l=i[u].g;if(c-=s,0>c)s=Math.max(0,i[u].h-100),a=!1;else try{PH(l,o,"req"+c+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.i.splice(0,n),e.D=t,r}function OS(t){t.g||t.u||(t.Z=1,qI(t.Ia,t),t.A=0)}function am(t){return!(t.g||t.u||3<=t.A||(t.Z++,t.u=wa(_t(t.Ia,t),kS(t,t.A)),t.A++,0))}function um(t){null!=t.B&&(G.clearTimeout(t.B),t.B=null)}function PS(t){t.g=new Ca(t,t.j,"rpc",t.Z),null===t.o&&(t.g.H=t.s),t.g.N=0;var e=ar(t.sa);Se(e,"RID","rpc"),Se(e,"SID",t.I),Se(e,"CI",t.L?"0":"1"),Se(e,"AID",t.T),Se(e,"TYPE","xmlhttp"),Oa(t,e),t.o&&t.s&&sm(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var n=t.g;t=t.ka,n.K=1,n.v=xl(ar(e)),n.s=null,n.P=!0,sS(n,t)}function kl(t){null!=t.v&&(G.clearTimeout(t.v),t.v=null)}function RS(t,e){var n=null;if(t.g==e){kl(t),um(t),t.g=null;var r=2}else{if(!tm(t.h,e))return;n=e.D,_S(t.h,e),r=1}if(0!=t.G)if(t.pa=e.Y,e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;ut(r=Cl(),new eS(r,n)),Rl(t)}else OS(t);else if(3==(i=e.o)||0==i&&0<t.pa||!(1==r&&function jH(t,e){return!(vS(t.h)>=t.h.j-(t.m?1:0)||(t.m?(t.i=e.D.concat(t.i),0):1==t.G||2==t.G||t.C>=(t.Za?0:t.$a)||(t.m=wa(_t(t.Ja,t,e),kS(t,t.C)),t.C++,0)))}(t,e)||2==r&&am(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),i){case 1:bi(t,5);break;case 4:bi(t,10);break;case 3:bi(t,6);break;default:bi(t,2)}}function kS(t,e){let n=t.Xa+Math.floor(Math.random()*t.bb);return t.l||(n*=2),n*e}function bi(t,e){if(t.j.info("Error code "+e),2==e){var n=null;t.l&&(n=null);var r=_t(t.kb,t);n||(n=new Ci("//www.google.com/images/cleardot.gif"),G.location&&"http"==G.location.protocol||Al(n,"https"),xl(n)),function RH(t,e){const n=new El;if(G.Image){const r=new Image;r.onload=pl(Nl,n,r,"TestLoadImage: loaded",!0,e),r.onerror=pl(Nl,n,r,"TestLoadImage: error",!1,e),r.onabort=pl(Nl,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=pl(Nl,n,r,"TestLoadImage: timeout",!1,e),G.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Mt(2);t.G=0,t.l&&t.l.va(e),LS(t),xS(t)}function LS(t){if(t.G=0,t.la=[],t.l){const e=DS(t.h);(0!=e.length||0!=t.i.length)&&(xI(t.la,e),xI(t.la,t.i),t.h.i.length=0,Sg(t.i),t.i.length=0),t.l.ua()}}function VS(t,e,n){var r=n instanceof Ci?ar(n):new Ci(n,void 0);if(""!=r.g)e&&(r.g=e+"."+r.g),Ml(r,r.m);else{var i=G.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Ci(null,void 0);r&&Al(s,r),e&&(s.g=e),i&&Ml(s,i),n&&(s.l=n),r=s}return e=t.za,(n=t.D)&&e&&Se(r,n,e),Se(r,"VER",t.ma),Oa(t,r),r}function BS(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Oe(n&&t.Da&&!t.ra?new Ma({jb:!0}):t.ra)).Ka(t.H),e}function jS(){}function Ll(){if(Vs&&!(10<=Number(rH)))throw Error("Environmental error: no available transport.")}function Xt(t,e){et.call(this),this.g=new MS(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Yb)&&!gl(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!gl(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Us(this)}function US(t){Qg.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function $S(){Yg.call(this),this.status=1}function Us(t){this.g=t}(P=Oe.prototype).Ka=function(t){this.L=t},P.da=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Zg.g(),this.C=function nS(t){return t.h||(t.h=t.i())}(this.u?this.u:Zg),this.g.onreadystatechange=_t(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(s){return void CS(this,s)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())n.set(s,r.get(s))}r=Array.from(n.keys()).find(s=>"content-type"==s.toLowerCase()),i=G.FormData&&t instanceof G.FormData,!(0<=MI(VH,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{SS(this),0<this.B&&((this.K=function BH(t){return Vs&&function nH(){return function X$(t){var e=tH;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}(function(){let t=0;const e=NI(String(yl)).split("."),n=NI("9").split("."),r=Math.max(e.length,n.length);for(let o=0;0==t&&o<r;o++){var i=e[o]||"",s=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==i[0].length&&0==s[0].length)break;t=Tg(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||Tg(0==i[2].length,0==s[2].length)||Tg(i[2],s[2]),i=i[3],s=s[3]}while(0==t)}return 0<=t})}()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=_t(this.qa,this)):this.A=Wg(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){CS(this,s)}},P.qa=function(){typeof bg<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ut(this,"timeout"),this.abort(8))},P.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,ut(this,"complete"),ut(this,"abort"),Ol(this))},P.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ol(this,!0)),Oe.X.M.call(this)},P.Ha=function(){this.s||(this.F||this.v||this.l?IS(this):this.fb())},P.fb=function(){IS(this)},P.aa=function(){try{return 2<ur(this)?this.g.status:-1}catch{return-1}},P.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},P.Sa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),kH(e)}},P.Ea=function(){return this.m},P.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(P=MS.prototype).ma=8,P.G=1,P.Ja=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const i=new Ca(this,this.j,t,void 0);let s=this.s;if(this.S&&(s?(s=kI(s),VI(s,this.S)):s=this.S),null!==this.o||this.N||(i.H=s,s=null),this.O)e:{for(var e=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break e}if(4096===e||n===this.i.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=FS(this,i,e),Se(n=ar(this.F),"RID",t),Se(n,"CVER",22),this.D&&Se(n,"X-HTTP-Session-Id",this.D),Oa(this,n),s&&(this.N?e="headers="+encodeURIComponent(String(AS(s)))+"&"+e:this.o&&sm(n,this.o,s)),nm(this.h,i),this.Ya&&Se(n,"TYPE","init"),this.O?(Se(n,"$req",e),Se(n,"SID","null"),i.Z=!0,Jg(i,n,null)):Jg(i,n,e),this.G=2}}else 3==this.G&&(t?NS(this,t):0==this.i.length||yS(this.h)||NS(this))},P.Ia=function(){if(this.u=null,PS(this),this.$&&!(this.K||null==this.g||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=wa(_t(this.eb,this),t)}},P.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Mt(10),Pl(this),PS(this))},P.cb=function(){null!=this.v&&(this.v=null,Pl(this),am(this),Mt(19))},P.kb=function(t){t?(this.j.info("Successfully pinged google.com"),Mt(2)):(this.j.info("Failed to ping google.com"),Mt(1))},(P=jS.prototype).xa=function(){},P.wa=function(){},P.va=function(){},P.ua=function(){},P.Ra=function(){},Ll.prototype.g=function(t,e){return new Xt(t,e)},at(Xt,et),Xt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;Mt(0),t.V=e,t.ia=n||{},t.L=t.Y,t.F=VS(t,null,t.V),Rl(t)},Xt.prototype.close=function(){om(this.g)},Xt.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=Hg(t),t=n);e.i.push(new class{constructor(t,e){this.h=t,this.g=e}}(e.ab++,t)),3==e.G&&Rl(e)},Xt.prototype.M=function(){this.g.l=null,delete this.j,om(this.g),delete this.g,Xt.X.M.call(this)},at(US,Qg),at($S,Yg),at(Us,jS),Us.prototype.xa=function(){ut(this.g,"a")},Us.prototype.wa=function(t){ut(this.g,new US(t))},Us.prototype.va=function(t){ut(this.g,new $S)},Us.prototype.ua=function(){ut(this.g,"b")},Ll.prototype.createWebChannel=Ll.prototype.g,Xt.prototype.send=Xt.prototype.u,Xt.prototype.open=Xt.prototype.m,Xt.prototype.close=Xt.prototype.close,bl.NO_ERROR=0,bl.TIMEOUT=8,bl.HTTP_ERROR=6,tS.COMPLETE="complete",rS.EventType=Ea,Ea.OPEN="a",Ea.CLOSE="b",Ea.ERROR="c",Ea.MESSAGE="d",et.prototype.listen=et.prototype.N,Oe.prototype.listenOnce=Oe.prototype.O,Oe.prototype.getLastError=Oe.prototype.Oa,Oe.prototype.getLastErrorCode=Oe.prototype.Ea,Oe.prototype.getStatus=Oe.prototype.aa,Oe.prototype.getResponseJson=Oe.prototype.Sa,Oe.prototype.getResponseText=Oe.prototype.fa,Oe.prototype.send=Oe.prototype.da,Oe.prototype.setWithCredentials=Oe.prototype.Ka;var UH=or.createWebChannelTransport=function(){return new Ll},$H=or.getStatEventTarget=function(){return Cl()},cm=or.ErrorCode=bl,HH=or.EventType=tS,GH=or.Event=wi,HS=or.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},qH=or.FetchXmlHttpFactory=Ma,Vl=or.WebChannel=rS,zH=or.XhrIo=Oe;const GS="@firebase/firestore";class tt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}tt.UNAUTHENTICATED=new tt(null),tt.GOOGLE_CREDENTIALS=new tt("google-credentials-uid"),tt.FIRST_PARTY=new tt("first-party-uid"),tt.MOCK_USER=new tt("mock-user");let $s="9.20.0";const Mr=new lg("@firebase/firestore");function lm(){return Mr.logLevel}function b(t,...e){if(Mr.logLevel<=oe.DEBUG){const n=e.map(dm);Mr.debug(`Firestore (${$s}): ${t}`,...n)}}function je(t,...e){if(Mr.logLevel<=oe.ERROR){const n=e.map(dm);Mr.error(`Firestore (${$s}): ${t}`,...n)}}function On(t,...e){if(Mr.logLevel<=oe.WARN){const n=e.map(dm);Mr.warn(`Firestore (${$s}): ${t}`,...n)}}function dm(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch{return t}}function F(t="Unexpected state"){const e=`FIRESTORE (${$s}) INTERNAL ASSERTION FAILED: `+t;throw je(e),new Error(e)}function R(t,e){t||F()}function A(t,e){return t}const v={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class E extends yi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Xe{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}class qS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class QH{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(tt.UNAUTHENTICATED))}shutdown(){}}class YH{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class ZH{constructor(e){this.t=e,this.currentUser=tt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){var r=this;let i=this.i;const s=c=>this.i!==i?(i=this.i,n(c)):Promise.resolve();let o=new Xe;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Xe,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=o;e.enqueueRetryable(D(function*(){yield c.promise,yield s(r.currentUser)}))},u=c=>{b("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(b("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Xe)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(b("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(R("string"==typeof r.accessToken),new qS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return R(null===e||"string"==typeof e),new tt(e)}}class XH{constructor(e,n,r){this.h=e,this.l=n,this.m=r,this.type="FirstParty",this.user=tt.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class JH{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new XH(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(tt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class zS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eG{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,n){const r=s=>{null!=s.error&&b("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.T;return this.T=s.token,b("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{b("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?i(s):b("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(R("string"==typeof n.token),this.T=n.token,new zS(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function tG(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class WS{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=tG(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function q(t,e){return t<e?-1:t>e?1:0}function Hs(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function KS(t){return t+"\0"}class Te{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new E(v.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new E(v.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new E(v.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new E(v.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Te.fromMillis(Date.now())}static fromDate(e){return Te.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Te(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?q(this.nanoseconds,e.nanoseconds):q(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class k{constructor(e){this.timestamp=e}static fromTimestamp(e){return new k(e)}static min(){return new k(new Te(0,0))}static max(){return new k(new Te(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Pa{constructor(e,n,r){void 0===n?n=0:n>e.length&&F(),void 0===r?r=e.length-n:r>e.length-n&&F(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return 0===Pa.comparator(this,e)}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Pa?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ie extends Pa{construct(e,n,r){return new ie(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new E(v.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ie(n)}static emptyPath(){return new ie([])}}const nG=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pe extends Pa{construct(e,n,r){return new Pe(e,n,r)}static isValidIdentifier(e){return nG.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Pe(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(0===r.length)throw new E(v.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new E(v.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new E(v.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new E(v.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pe(n)}static emptyPath(){return new Pe([])}}class T{constructor(e){this.path=e}static fromPath(e){return new T(ie.fromString(e))}static fromName(e){return new T(ie.fromString(e).popFirst(5))}static empty(){return new T(ie.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ie.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,n){return ie.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new T(new ie(e.slice()))}}class Bl{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function hm(t){return t.fields.find(e=>2===e.kind)}function Ii(t){return t.fields.filter(e=>2!==e.kind)}Bl.UNKNOWN_ID=-1;class jl{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ra{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ra(0,Jt.min())}}function QS(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=k.fromTimestamp(1e9===r?new Te(n+1,0):new Te(n,r));return new Jt(i,T.empty(),e)}function YS(t){return new Jt(t.readTime,t.key,-1)}class Jt{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Jt(k.min(),T.empty(),-1)}static max(){return new Jt(k.max(),T.empty(),-1)}}function fm(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=T.comparator(t.documentKey,e.documentKey),0!==n?n:q(t.largestBatchId,e.largestBatchId))}const ZS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class XS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function xr(t){return pm.apply(this,arguments)}function pm(){return pm=D(function*(t){if(t.code!==v.FAILED_PRECONDITION||t.message!==ZS)throw t;b("LocalStore","Unexpectedly lost primary lease")}),pm.apply(this,arguments)}class y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&F(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new y((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof y?n:y.resolve(n)}catch(n){return y.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):y.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):y.reject(n)}static resolve(e){return new y((n,r)=>{n(e)})}static reject(e){return new y((n,r)=>{r(e)})}static waitFor(e){return new y((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=y.resolve(!1);for(const r of e)n=n.next(i=>i?y.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new y((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const c=u;n(e[c]).next(l=>{o[c]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new y((r,i)=>{const s=()=>{!0===e()?n().next(()=>{s()},i):r()};s()})}}class Ul{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.R=new Xe,this.transaction.oncomplete=()=>{this.R.resolve()},this.transaction.onabort=()=>{n.error?this.R.reject(new ka(e,n.error)):this.R.resolve()},this.transaction.onerror=r=>{const i=gm(r.target.error);this.R.reject(new ka(e,i))}}static open(e,n,r,i){try{return new Ul(n,e.transaction(i,r))}catch(s){throw new ka(n,s)}}get v(){return this.R.promise}abort(e){e&&this.R.reject(e),this.aborted||(b("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const n=this.transaction.objectStore(e);return new oG(n)}}class Dn{constructor(e,n,r){this.name=e,this.version=n,this.V=r,12.2===Dn.S(mi())&&je("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return b("SimpleDb","Removing database:",e),Si(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!iI())return!1;if(Dn.C())return!0;const e=mi(),n=Dn.S(e),r=0<n&&n<10,i=Dn.N(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.k)}static O(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static N(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}$(e){var n=this;return D(function*(){return n.db||(b("SimpleDb","Opening database:",n.name),n.db=yield new Promise((r,i)=>{const s=indexedDB.open(n.name,n.version);s.onsuccess=o=>{r(o.target.result)},s.onblocked=()=>{i(new ka(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;i("VersionError"===a.name?new E(v.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new E(v.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new ka(e,a))},s.onupgradeneeded=o=>{b("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',o.oldVersion),n.V.M(o.target.result,s.transaction,o.oldVersion,n.version).next(()=>{b("SimpleDb","Database upgrade to version "+n.version+" complete")})}})),n.F&&(n.db.onversionchange=r=>n.F(r)),n.db})()}B(e){this.F=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){var s=this;return D(function*(){const o="readonly"===n;let a=0;for(;;){++a;try{s.db=yield s.$(e);const u=Ul.open(s.db,e,o?"readonly":"readwrite",r),c=i(u).next(l=>(u.P(),l)).catch(l=>(u.abort(l),y.reject(l))).toPromise();return c.catch(()=>{}),yield u.v,c}catch(u){const c=u,l="FirebaseError"!==c.name&&a<3;if(b("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),s.close(),!l)return Promise.reject(c)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class sG{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return Si(this.L.delete())}}class ka extends E{constructor(e,n){super(v.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Nr(t){return"IndexedDbTransactionError"===t.name}class oG{constructor(e){this.store=e}put(e,n){let r;return void 0!==n?(b("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(b("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Si(r)}add(e){return b("SimpleDb","ADD",this.store.name,e,e),Si(this.store.add(e))}get(e){return Si(this.store.get(e)).next(n=>(void 0===n&&(n=null),b("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return b("SimpleDb","DELETE",this.store.name,e),Si(this.store.delete(e))}count(){return b("SimpleDb","COUNT",this.store.name),Si(this.store.count())}j(e,n){const r=this.options(e,n);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.W(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new y((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}H(e,n){const r=this.store.getAll(e,null===n?void 0:n);return new y((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}J(e,n){b("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.Y=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}Z(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}X(e){const n=this.cursor({});return new y((r,i)=>{n.onerror=s=>{const o=gm(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new y((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const u=new sG(a),c=n(a.primaryKey,a.value,u);if(c instanceof y){const l=c.catch(d=>(u.done(),y.reject(d)));r.push(l)}u.isDone?i():null===u.K?a.continue():a.continue(u.K)}}).next(()=>y.waitFor(r))}options(e,n){let r;return void 0!==e&&("string"==typeof e?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Si(t){return new y((e,n)=>{t.onsuccess=r=>{e(r.target.result)},t.onerror=r=>{const i=gm(r.target.error);n(i)}})}let JS=!1;function gm(t){const e=Dn.S(mi());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new E("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return JS||(JS=!0,setTimeout(()=>{throw r},0)),r}}return t}class aG{constructor(e,n){this.asyncQueue=e,this.tt=n,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){var n=this;b("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,D(function*(){n.task=null;try{b("IndexBackiller",`Documents written: ${yield n.tt.nt()}`)}catch(r){Nr(r)?b("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield xr(r)}yield n.et(6e4)}))}}class uG{constructor(e,n){this.localStore=e,this.persistence=n}nt(e=50){var n=this;return D(function*(){return n.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>n.st(r,e))})()}st(e,n){const r=new Set;let i=n,s=!0;return y.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!r.has(o))return b("IndexBackiller",`Processing collection: ${o}`),this.it(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}it(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.rt(i,s)).next(a=>(b("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}rt(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=YS(s);fm(o,r)>0&&(r=o)}),new Jt(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}let en=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.ot(i),this.ut=i=>r.writeSequenceNumber(i))}ot(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){const n=++this.previousValue;return this.ut&&this.ut(n),n}}return t.ct=-1,t})();function La(t){return null==t}function Va(t){return 0===t&&1/t==-1/0}function eT(t){return"number"==typeof t&&Number.isInteger(t)&&!Va(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function xt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=tT(e)),e=cG(t.get(n),e);return tT(e)}function cG(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=s}}return n}function tT(t){return t+"\x01\x01"}function Pn(t){const e=t.length;if(R(e>=2),2===e)return R("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ie.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("\x01",s);switch((o<0||o>n)&&F(),t.charAt(o+1)){case"\x01":const a=t.substring(s,o);let u;0===i.length?u=a:(i+=a,u=i,i=""),r.push(u);break;case"\x10":i+=t.substring(s,o),i+="\0";break;case"\x11":i+=t.substring(s,o+1);break;default:F()}s=o+2}return new ie(r)}const nT=["userId","batchId"];function $l(t,e){return[t,xt(e)]}function rT(t,e,n){return[t,xt(e),n]}const lG={},dG=["prefixPath","collectionGroup","readTime","documentId"],hG=["prefixPath","collectionGroup","documentId"],fG=["collectionGroup","readTime","prefixPath","documentId"],pG=["canonicalId","targetId"],gG=["targetId","path"],mG=["path","targetId"],yG=["collectionId","parent"],vG=["indexId","uid"],_G=["uid","sequenceNumber"],DG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],wG=["indexId","uid","orderedDocumentKey"],EG=["userId","collectionPath","documentId"],CG=["userId","collectionPath","largestBatchId"],bG=["userId","collectionGroup","largestBatchId"],iT=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],IG=[...iT,"documentOverlays"],sT=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],oT=sT,SG=[...oT,"indexConfiguration","indexState","indexEntries"];class mm extends XS{constructor(e,n){super(),this.at=e,this.currentSequenceNumber=n}}function nt(t,e){const n=A(t);return Dn.O(n.at,e)}function aT(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ti(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function uT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Re{constructor(e,n){this.comparator=e,this.root=n||ct.EMPTY}insert(e,n){return new Re(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ct.BLACK,null,null))}remove(e){return new Re(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ct.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Hl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Hl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Hl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Hl(this.root,e,this.comparator,!0)}}class Hl{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ct{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??ct.RED,this.left=i??ct.EMPTY,this.right=s??ct.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new ct(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):0===s?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ct.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return ct.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ct.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ct.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw F();const e=this.left.check();if(e!==this.right.check())throw F();return e+(this.isRed()?0:1)}}ct.EMPTY=null,ct.RED=!0,ct.BLACK=!1,ct.EMPTY=new class{constructor(){this.size=0}get key(){throw F()}get value(){throw F()}get color(){throw F()}get left(){throw F()}get right(){throw F()}copy(t,e,n,r,i){return this}insert(t,e,n){return new ct(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class pe{constructor(e){this.comparator=e,this.data=new Re(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=void 0!==n?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new cT(this.data.getIterator())}getIteratorFrom(e){return new cT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof pe)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new pe(this.comparator);return n.data=e,n}}class cT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Gs(t){return t.hasNext()?t.getNext():void 0}class Ut{constructor(e){this.fields=e,e.sort(Pe.comparator)}static empty(){return new Ut([])}unionWith(e){let n=new pe(Pe.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Ut(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Hs(this.fields,e.fields,(n,r)=>n.isEqual(r))}}class TG extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Je{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new TG("Invalid base64 string: "+i):i}}(e);return new Je(n)}static fromUint8Array(e){const n=function(r){let i="";for(let s=0;s<r.length;++s)i+=String.fromCharCode(r[s]);return i}(e);return new Je(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return q(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Je.EMPTY_BYTE_STRING=new Je("");const MG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fr(t){if(R(!!t),"string"==typeof t){let e=0;const n=MG.exec(t);if(R(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ke(t.seconds),nanos:ke(t.nanos)}}function ke(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ai(t){return"string"==typeof t?Je.fromBase64String(t):Je.fromUint8Array(t)}function ym(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=t?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function lT(t){const e=t.mapValue.fields.__previous_value__;return ym(e)?lT(e):e}function Ba(t){const e=Fr(t.mapValue.fields.__local_write_time__.timestampValue);return new Te(e.seconds,e.nanos)}class xG{constructor(e,n,r,i,s,o,a,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=u}}class Or{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Or("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Or&&e.projectId===this.projectId&&e.database===this.database}}const Pr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Gl={nullValue:"NULL_VALUE"};function Mi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ym(t)?4:pT(t)?9007199254740991:10:F()}function Rn(t,e){if(t===e)return!0;const n=Mi(t);if(n!==Mi(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ba(t).isEqual(Ba(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const s=Fr(r.timestampValue),o=Fr(i.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return i=e,Ai(t.bytesValue).isEqual(Ai(i.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return ke(r.geoPointValue.latitude)===ke(i.geoPointValue.latitude)&&ke(r.geoPointValue.longitude)===ke(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return ke(r.integerValue)===ke(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const s=ke(r.doubleValue),o=ke(i.doubleValue);return s===o?Va(s)===Va(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return Hs(t.arrayValue.values||[],e.arrayValue.values||[],Rn);case 10:return function(r,i){const s=r.mapValue.fields||{},o=i.mapValue.fields||{};if(aT(s)!==aT(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(void 0===o[a]||!Rn(s[a],o[a])))return!1;return!0}(t,e);default:return F()}var i}function ja(t,e){return void 0!==(t.values||[]).find(n=>Rn(n,e))}function Rr(t,e){if(t===e)return 0;const n=Mi(t),r=Mi(e);if(n!==r)return q(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return q(t.booleanValue,e.booleanValue);case 2:return function(i,s){const o=ke(i.integerValue||i.doubleValue),a=ke(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return dT(t.timestampValue,e.timestampValue);case 4:return dT(Ba(t),Ba(e));case 5:return q(t.stringValue,e.stringValue);case 6:return function(i,s){const o=Ai(i),a=Ai(s);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(i,s){const o=i.split("/"),a=s.split("/");for(let u=0;u<o.length&&u<a.length;u++){const c=q(o[u],a[u]);if(0!==c)return c}return q(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,s){const o=q(ke(i.latitude),ke(s.latitude));return 0!==o?o:q(ke(i.longitude),ke(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(i,s){const o=i.values||[],a=s.values||[];for(let u=0;u<o.length&&u<a.length;++u){const c=Rr(o[u],a[u]);if(c)return c}return q(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(i,s){if(i===Pr.mapValue&&s===Pr.mapValue)return 0;if(i===Pr.mapValue)return 1;if(s===Pr.mapValue)return-1;const o=i.fields||{},a=Object.keys(o),u=s.fields||{},c=Object.keys(u);a.sort(),c.sort();for(let l=0;l<a.length&&l<c.length;++l){const d=q(a[l],c[l]);if(0!==d)return d;const h=Rr(o[a[l]],u[c[l]]);if(0!==h)return h}return q(a.length,c.length)}(t.mapValue,e.mapValue);default:throw F()}}function dT(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return q(t,e);const n=Fr(t),r=Fr(e),i=q(n.seconds,r.seconds);return 0!==i?i:q(n.nanos,r.nanos)}function qs(t){return vm(t)}function vm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const i=Fr(r);return`time(${i.seconds},${i.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Ai(t.bytesValue).toBase64():"referenceValue"in t?T.fromName(t.referenceValue).toString():"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let i="[",s=!0;for(const o of r.values||[])s?s=!1:i+=",",i+=vm(o);return i+"]"}(t.arrayValue):"mapValue"in t?function(r){const i=Object.keys(r.fields||{}).sort();let s="{",o=!0;for(const a of i)o?o=!1:s+=",",s+=`${a}:${vm(r.fields[a])}`;return s+"}"}(t.mapValue):F();var e}function xi(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function _m(t){return!!t&&"integerValue"in t}function Ua(t){return!!t&&"arrayValue"in t}function hT(t){return!!t&&"nullValue"in t}function fT(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ql(t){return!!t&&"mapValue"in t}function $a(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ti(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=$a(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=$a(t.arrayValue.values[n]);return e}return Object.assign({},t)}function pT(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}function NG(t){return"nullValue"in t?Gl:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?xi(Or.empty(),T.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:F()}function FG(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?xi(Or.empty(),T.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Pr:F()}function gT(t,e){const n=Rr(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function mT(t,e){const n=Rr(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class rt{constructor(e){this.value=e}static empty(){return new rt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!ql(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=$a(n)}setAll(e){let n=Pe.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=$a(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());ql(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Rn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];ql(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ti(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new rt($a(this.value))}}function yT(t){const e=[];return Ti(t.fields,(n,r)=>{const i=new Pe([n]);if(ql(r)){const s=yT(r.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Ut(e)}class Ee{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ee(e,0,k.min(),k.min(),k.min(),rt.empty(),0)}static newFoundDocument(e,n,r,i){return new Ee(e,1,n,k.min(),r,i,0)}static newNoDocument(e,n){return new Ee(e,2,n,k.min(),k.min(),rt.empty(),0)}static newUnknownDocument(e,n){return new Ee(e,3,n,k.min(),k.min(),rt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(k.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=k.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ee&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ee(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class kr{constructor(e,n){this.position=e,this.inclusive=n}}function vT(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?T.comparator(T.fromName(o.referenceValue),n.key):Rr(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function _T(t,e){if(null===t)return null===e;if(null===e||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Rn(t.position[n],e.position[n]))return!1;return!0}class zs{constructor(e,n="asc"){this.field=e,this.dir=n}}function OG(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class DT{}class te extends DT{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?"in"===n||"not-in"===n?this.createKeyFieldInFilter(e,n,r):new PG(e,n,r):"array-contains"===n?new LG(e,r):"in"===n?new ST(e,r):"not-in"===n?new VG(e,r):"array-contains-any"===n?new BG(e,r):new te(e,n,r)}static createKeyFieldInFilter(e,n,r){return"in"===n?new RG(e,r):new kG(e,r)}matches(e){const n=e.data.field(this.field);return"!="===this.op?null!==n&&this.matchesComparison(Rr(n,this.value)):null!==n&&Mi(this.value)===Mi(n)&&this.matchesComparison(Rr(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return F()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class fe extends DT{constructor(e,n){super(),this.filters=e,this.op=n,this.ht=null}static create(e,n){return new fe(e,n)}matches(e){return Ws(this)?void 0===this.filters.find(n=>!n.matches(e)):void 0!==this.filters.find(n=>n.matches(e))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.lt(n=>n.isInequality());return null!==e?e.field:null}lt(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function Ws(t){return"and"===t.op}function Dm(t){return"or"===t.op}function wm(t){return wT(t)&&Ws(t)}function wT(t){for(const e of t.filters)if(e instanceof fe)return!1;return!0}function Em(t){if(t instanceof te)return t.field.canonicalString()+t.op.toString()+qs(t.value);if(wm(t))return t.filters.map(e=>Em(e)).join(",");{const e=t.filters.map(n=>Em(n)).join(",");return`${t.op}(${e})`}}function ET(t,e){return t instanceof te?(n=t,(r=e)instanceof te&&n.op===r.op&&n.field.isEqual(r.field)&&Rn(n.value,r.value)):t instanceof fe?function(n,r){return r instanceof fe&&n.op===r.op&&n.filters.length===r.filters.length&&n.filters.reduce((i,s,o)=>i&&ET(s,r.filters[o]),!0)}(t,e):void F();var n,r}function CT(t,e){const n=t.filters.concat(e);return fe.create(n,t.op)}function bT(t){return t instanceof te?`${(e=t).field.canonicalString()} ${e.op} ${qs(e.value)}`:t instanceof fe?function(e){return e.op.toString()+" {"+e.getFilters().map(bT).join(" ,")+"}"}(t):"Filter";var e}class PG extends te{constructor(e,n,r){super(e,n,r),this.key=T.fromName(r.referenceValue)}matches(e){const n=T.comparator(e.key,this.key);return this.matchesComparison(n)}}class RG extends te{constructor(e,n){super(e,"in",n),this.keys=IT(0,n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class kG extends te{constructor(e,n){super(e,"not-in",n),this.keys=IT(0,n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function IT(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(r=>T.fromName(r.referenceValue))}class LG extends te{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Ua(n)&&ja(n.arrayValue,this.value)}}class ST extends te{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return null!==n&&ja(this.value.arrayValue,n)}}class VG extends te{constructor(e,n){super(e,"not-in",n)}matches(e){if(ja(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return null!==n&&!ja(this.value.arrayValue,n)}}class BG extends te{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Ua(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ja(this.value.arrayValue,r))}}class jG{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ft=null}}function Cm(t,e=null,n=[],r=[],i=null,s=null,o=null){return new jG(t,e,n,r,i,s,o)}function Ni(t){const e=A(t);if(null===e.ft){let n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Em(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),La(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>qs(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>qs(r)).join(",")),e.ft=n}return e.ft}function Ha(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!OG(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!ET(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!_T(t.startAt,e.startAt)&&_T(t.endAt,e.endAt)}function zl(t){return T.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Wl(t,e){return t.filters.filter(n=>n instanceof te&&n.field.isEqual(e))}function TT(t,e,n){let r=Gl,i=!0;for(const s of Wl(t,e)){let o=Gl,a=!0;switch(s.op){case"<":case"<=":o=NG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Gl}gT({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];gT({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}return{value:r,inclusive:i}}function AT(t,e,n){let r=Pr,i=!0;for(const s of Wl(t,e)){let o=Pr,a=!0;switch(s.op){case">=":case">":o=FG(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Pr}mT({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];mT({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}return{value:r,inclusive:i}}class cr{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.dt=null,this.wt=null}}function MT(t,e,n,r,i,s,o,a){return new cr(t,e,n,r,i,s,o,a)}function Ks(t){return new cr(t)}function xT(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function bm(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Kl(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(null!==n)return n}return null}function Im(t){return null!==t.collectionGroup}function Fi(t){const e=A(t);if(null===e.dt){e.dt=[];const n=Kl(e),r=bm(e);if(null!==n&&null===r)n.isKeyField()||e.dt.push(new zs(n)),e.dt.push(new zs(Pe.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.dt.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new zs(Pe.keyField(),s))}}}return e.dt}function Nt(t){const e=A(t);if(!e.wt)if("F"===e.limitType)e.wt=Cm(e.path,e.collectionGroup,Fi(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const s of Fi(e))n.push(new zs(s.field,"desc"===s.dir?"asc":"desc"));const r=e.endAt?new kr(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new kr(e.startAt.position,e.startAt.inclusive):null;e.wt=Cm(e.path,e.collectionGroup,n,e.filters,e.limit,r,i)}return e.wt}function Sm(t,e){e.getFirstInequalityField(),Kl(t);const n=t.filters.concat([e]);return new cr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ql(t,e,n){return new cr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ga(t,e){return Ha(Nt(t),Nt(e))&&t.limitType===e.limitType}function NT(t){return`${Ni(Nt(t))}|lt:${t.limitType}`}function Tm(t){return`Query(target=${function(e){let n=e.path.canonicalString();return null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(r=>bT(r)).join(", ")}]`),La(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(r=>{return`${(i=r).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>qs(r)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>qs(r)).join(",")),`Target(${n})`}(Nt(t))}; limitType=${t.limitType})`}function qa(t,e){return e.isFoundDocument()&&function(n,r){const i=r.key.path;return null!==n.collectionGroup?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):T.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,r){for(const i of Fi(n))if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(t,e)&&function(n,r){for(const i of n.filters)if(!i.matches(r))return!1;return!0}(t,e)&&(r=e,!((n=t).startAt&&!function(i,s,o){const a=vT(i,s,o);return i.inclusive?a<=0:a<0}(n.startAt,Fi(n),r)||n.endAt&&!function(i,s,o){const a=vT(i,s,o);return i.inclusive?a>=0:a>0}(n.endAt,Fi(n),r)));var n,r}function FT(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function OT(t){return(e,n)=>{let r=!1;for(const i of Fi(t)){const s=UG(i,e,n);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function UG(t,e,n){const r=t.field.isKeyField()?T.comparator(e.key,n.key):function(i,s,o){const a=s.data.field(i),u=o.data.field(i);return null!==a&&null!==u?Rr(a,u):F()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return F()}}class Lr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ti(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return uT(this.inner)}size(){return this.innerSize}}const $G=new Re(T.comparator);function $t(){return $G}const PT=new Re(T.comparator);function za(...t){let e=PT;for(const n of t)e=e.insert(n.key,n);return e}function RT(t){let e=PT;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function kn(){return Wa()}function kT(){return Wa()}function Wa(){return new Lr(t=>t.toString(),(t,e)=>t.isEqual(e))}const HG=new Re(T.comparator),GG=new pe(T.comparator);function Y(...t){let e=GG;for(const n of t)e=e.add(n);return e}const qG=new pe(q);function Yl(){return qG}function LT(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Va(e)?"-0":e}}function VT(t){return{integerValue:""+t}}function BT(t,e){return eT(e)?VT(e):LT(t,e)}class Zl{constructor(){this._=void 0}}function zG(t,e,n){return t instanceof Qs?function(r,i){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(s.fields.__previous_value__=i),{mapValue:s}}(n,e):t instanceof Oi?UT(t,e):t instanceof Pi?$T(t,e):function(r,i){const s=jT(r,i),o=HT(s)+HT(r._t);return _m(s)&&_m(r._t)?VT(o):LT(r.serializer,o)}(t,e)}function WG(t,e,n){return t instanceof Oi?UT(t,e):t instanceof Pi?$T(t,e):n}function jT(t,e){return t instanceof Ys?_m(n=e)||(r=n)&&"doubleValue"in r?e:{integerValue:0}:null;var r,n}class Qs extends Zl{}class Oi extends Zl{constructor(e){super(),this.elements=e}}function UT(t,e){const n=GT(e);for(const r of t.elements)n.some(i=>Rn(i,r))||n.push(r);return{arrayValue:{values:n}}}class Pi extends Zl{constructor(e){super(),this.elements=e}}function $T(t,e){let n=GT(e);for(const r of t.elements)n=n.filter(i=>!Rn(i,r));return{arrayValue:{values:n}}}class Ys extends Zl{constructor(e,n){super(),this.serializer=e,this._t=n}}function HT(t){return ke(t.integerValue||t.doubleValue)}function GT(t){return Ua(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Ka{constructor(e,n){this.field=e,this.transform=n}}class QG{constructor(e,n){this.version=e,this.transformResults=n}}class Ae{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ae}static exists(e){return new Ae(void 0,e)}static updateTime(e){return new Ae(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Xl(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Jl{}function qT(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Xs(t.key,Ae.none()):new Zs(t.key,t.data,Ae.none());{const n=t.data,r=rt.empty();let i=new pe(Pe.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);null===o&&s.length>1&&(s=s.popLast(),o=n.field(s)),null===o?r.delete(s):r.set(s,o),i=i.add(s)}return new lr(t.key,r,new Ut(i.toArray()),Ae.none())}}function YG(t,e,n){t instanceof Zs?function(r,i,s){const o=r.value.clone(),a=KT(r.fieldTransforms,i,s.transformResults);o.setAll(a),i.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,n):t instanceof lr?function(r,i,s){if(!Xl(r.precondition,i))return void i.convertToUnknownDocument(s.version);const o=KT(r.fieldTransforms,i,s.transformResults),a=i.data;a.setAll(WT(r)),a.setAll(o),i.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(t,e,n):e.convertToNoDocument(n.version).setHasCommittedMutations()}function Qa(t,e,n,r){return t instanceof Zs?function(i,s,o,a){if(!Xl(i.precondition,s))return o;const u=i.value.clone(),c=QT(i.fieldTransforms,a,s);return u.setAll(c),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof lr?function(i,s,o,a){if(!Xl(i.precondition,s))return o;const u=QT(i.fieldTransforms,a,s),c=s.data;return c.setAll(WT(i)),c.setAll(u),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null===o?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(l=>l.field))}(t,e,n,r):(o=n,Xl(t.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o);var s,o}function ZG(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=jT(r.transform,i||null);null!=s&&(null===n&&(n=rt.empty()),n.set(r.field,s))}return n||null}function zT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(n=t.fieldTransforms)&&void 0===r||n&&r&&Hs(n,r,(i,s)=>function KG(t,e){return t.field.isEqual(e.field)&&(r=e.transform,(n=t.transform)instanceof Oi&&r instanceof Oi||n instanceof Pi&&r instanceof Pi?Hs(n.elements,r.elements,Rn):n instanceof Ys&&r instanceof Ys?Rn(n._t,r._t):n instanceof Qs&&r instanceof Qs);var n,r}(i,s))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var n,r}class Zs extends Jl{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class lr extends Jl{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function WT(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function KT(t,e,n){const r=new Map;R(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,WG(o,a,n[i]))}return r}function QT(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,zG(s,o,e))}return r}class Xs extends Jl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Am extends Jl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Mm{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&YG(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Qa(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Qa(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=kT();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const u=qT(o,a);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(k.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Y())}isEqual(e){return this.batchId===e.batchId&&Hs(this.mutations,e.mutations,(n,r)=>zT(n,r))&&Hs(this.baseMutations,e.baseMutations,(n,r)=>zT(n,r))}}class xm{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){R(e.mutations.length===r.length);let i=HG;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new xm(e,n,r,i)}}class Nm{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class eq{constructor(e){this.count=e}}var Ke,se;function YT(t){switch(t){default:return F();case v.CANCELLED:case v.UNKNOWN:case v.DEADLINE_EXCEEDED:case v.RESOURCE_EXHAUSTED:case v.INTERNAL:case v.UNAVAILABLE:case v.UNAUTHENTICATED:return!1;case v.INVALID_ARGUMENT:case v.NOT_FOUND:case v.ALREADY_EXISTS:case v.PERMISSION_DENIED:case v.FAILED_PRECONDITION:case v.ABORTED:case v.OUT_OF_RANGE:case v.UNIMPLEMENTED:case v.DATA_LOSS:return!0}}function ZT(t){if(void 0===t)return je("GRPC error has no .code"),v.UNKNOWN;switch(t){case Ke.OK:return v.OK;case Ke.CANCELLED:return v.CANCELLED;case Ke.UNKNOWN:return v.UNKNOWN;case Ke.DEADLINE_EXCEEDED:return v.DEADLINE_EXCEEDED;case Ke.RESOURCE_EXHAUSTED:return v.RESOURCE_EXHAUSTED;case Ke.INTERNAL:return v.INTERNAL;case Ke.UNAVAILABLE:return v.UNAVAILABLE;case Ke.UNAUTHENTICATED:return v.UNAUTHENTICATED;case Ke.INVALID_ARGUMENT:return v.INVALID_ARGUMENT;case Ke.NOT_FOUND:return v.NOT_FOUND;case Ke.ALREADY_EXISTS:return v.ALREADY_EXISTS;case Ke.PERMISSION_DENIED:return v.PERMISSION_DENIED;case Ke.FAILED_PRECONDITION:return v.FAILED_PRECONDITION;case Ke.ABORTED:return v.ABORTED;case Ke.OUT_OF_RANGE:return v.OUT_OF_RANGE;case Ke.UNIMPLEMENTED:return v.UNIMPLEMENTED;case Ke.DATA_LOSS:return v.DATA_LOSS;default:return F()}}(se=Ke||(Ke={}))[se.OK=0]="OK",se[se.CANCELLED=1]="CANCELLED",se[se.UNKNOWN=2]="UNKNOWN",se[se.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",se[se.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",se[se.NOT_FOUND=5]="NOT_FOUND",se[se.ALREADY_EXISTS=6]="ALREADY_EXISTS",se[se.PERMISSION_DENIED=7]="PERMISSION_DENIED",se[se.UNAUTHENTICATED=16]="UNAUTHENTICATED",se[se.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",se[se.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",se[se.ABORTED=10]="ABORTED",se[se.OUT_OF_RANGE=11]="OUT_OF_RANGE",se[se.UNIMPLEMENTED=12]="UNIMPLEMENTED",se[se.INTERNAL=13]="INTERNAL",se[se.UNAVAILABLE=14]="UNAVAILABLE",se[se.DATA_LOSS=15]="DATA_LOSS";class Om{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return ed}static getOrCreateInstance(){return null===ed&&(ed=new Om),ed}onExistenceFilterMismatch(e){const n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,e),()=>this.onExistenceFilterMismatchCallbacks.delete(n)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(n=>n(e))}}let ed=null;class Ya{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Za.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Ya(k.min(),i,Yl(),$t(),Y())}}class Za{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Za(r,n,Y(),Y(),Y())}}class td{constructor(e,n,r,i){this.It=e,this.removedTargetIds=n,this.key=r,this.Tt=i}}class XT{constructor(e,n){this.targetId=e,this.Et=n}}class JT{constructor(e,n,r=Je.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class eA{constructor(){this.At=0,this.Rt=nA(),this.vt=Je.EMPTY_BYTE_STRING,this.bt=!1,this.Pt=!0}get current(){return this.bt}get resumeToken(){return this.vt}get Vt(){return 0!==this.At}get St(){return this.Pt}Dt(e){e.approximateByteSize()>0&&(this.Pt=!0,this.vt=e)}Ct(){let e=Y(),n=Y(),r=Y();return this.Rt.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:F()}}),new Za(this.vt,this.bt,e,n,r)}xt(){this.Pt=!1,this.Rt=nA()}Nt(e,n){this.Pt=!0,this.Rt=this.Rt.insert(e,n)}kt(e){this.Pt=!0,this.Rt=this.Rt.remove(e)}Ot(){this.At+=1}$t(){this.At-=1}Mt(){this.Pt=!0,this.bt=!0}}class tq{constructor(e){this.Ft=e,this.Bt=new Map,this.Lt=$t(),this.qt=tA(),this.Ut=new pe(q)}Kt(e){for(const n of e.It)e.Tt&&e.Tt.isFoundDocument()?this.Gt(n,e.Tt):this.Qt(n,e.key,e.Tt);for(const n of e.removedTargetIds)this.Qt(n,e.key,e.Tt)}zt(e){this.forEachTarget(e,n=>{const r=this.jt(n);switch(e.state){case 0:this.Wt(n)&&r.Dt(e.resumeToken);break;case 1:r.$t(),r.Vt||r.xt(),r.Dt(e.resumeToken);break;case 2:r.$t(),r.Vt||this.removeTarget(n);break;case 3:this.Wt(n)&&(r.Mt(),r.Dt(e.resumeToken));break;case 4:this.Wt(n)&&(this.Ht(n),r.Dt(e.resumeToken));break;default:F()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Bt.forEach((r,i)=>{this.Wt(i)&&n(i)})}Jt(e){var n;const r=e.targetId,i=e.Et.count,s=this.Yt(r);if(s){const o=s.target;if(zl(o))if(0===i){const a=new T(o.path);this.Qt(r,a,Ee.newNoDocument(a,k.min()))}else R(1===i);else{const a=this.Zt(r);a!==i&&(this.Ht(r),this.Ut=this.Ut.add(r),null===(n=Om.instance)||void 0===n||n.notifyOnExistenceFilterMismatch({localCacheCount:a,existenceFilterCount:e.Et.count}))}}}Xt(e){const n=new Map;this.Bt.forEach((s,o)=>{const a=this.Yt(o);if(a){if(s.current&&zl(a.target)){const u=new T(a.target.path);null!==this.Lt.get(u)||this.te(o,u)||this.Qt(o,u,Ee.newNoDocument(u,e))}s.St&&(n.set(o,s.Ct()),s.xt())}});let r=Y();this.qt.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{const c=this.Yt(u);return!c||2===c.purpose||(a=!1,!1)}),a&&(r=r.add(s))}),this.Lt.forEach((s,o)=>o.setReadTime(e));const i=new Ya(e,n,this.Ut,this.Lt,r);return this.Lt=$t(),this.qt=tA(),this.Ut=new pe(q),i}Gt(e,n){if(!this.Wt(e))return;const r=this.te(e,n.key)?2:0;this.jt(e).Nt(n.key,r),this.Lt=this.Lt.insert(n.key,n),this.qt=this.qt.insert(n.key,this.ee(n.key).add(e))}Qt(e,n,r){if(!this.Wt(e))return;const i=this.jt(e);this.te(e,n)?i.Nt(n,1):i.kt(n),this.qt=this.qt.insert(n,this.ee(n).delete(e)),r&&(this.Lt=this.Lt.insert(n,r))}removeTarget(e){this.Bt.delete(e)}Zt(e){const n=this.jt(e).Ct();return this.Ft.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ot(e){this.jt(e).Ot()}jt(e){let n=this.Bt.get(e);return n||(n=new eA,this.Bt.set(e,n)),n}ee(e){let n=this.qt.get(e);return n||(n=new pe(q),this.qt=this.qt.insert(e,n)),n}Wt(e){const n=null!==this.Yt(e);return n||b("WatchChangeAggregator","Detected inactive target",e),n}Yt(e){const n=this.Bt.get(e);return n&&n.Vt?null:this.Ft.ne(e)}Ht(e){this.Bt.set(e,new eA),this.Ft.getRemoteKeysForTarget(e).forEach(n=>{this.Qt(e,n,null)})}te(e,n){return this.Ft.getRemoteKeysForTarget(e).has(n)}}function tA(){return new Re(T.comparator)}function nA(){return new Re(T.comparator)}const nq={asc:"ASCENDING",desc:"DESCENDING"},rq={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iq={and:"AND",or:"OR"};class sq{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Js(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function rA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function oq(t,e){return Js(t,e.toTimestamp())}function Ue(t){return R(!!t),k.fromTimestamp(function(e){const n=Fr(e);return new Te(n.seconds,n.nanos)}(t))}function Pm(t,e){return(n=t,new ie(["projects",n.projectId,"databases",n.database])).child("documents").child(e).canonicalString();var n}function iA(t){const e=ie.fromString(t);return R(fA(e)),e}function Xa(t,e){return Pm(t.databaseId,e.path)}function Ln(t,e){const n=iA(e);if(n.get(1)!==t.databaseId.projectId)throw new E(v.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new E(v.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new T(oA(n))}function Rm(t,e){return Pm(t.databaseId,e)}function sA(t){const e=iA(t);return 4===e.length?ie.emptyPath():oA(e)}function Ja(t){return new ie(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function oA(t){return R(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function aA(t,e,n){return{name:Xa(t,e),fields:n.value.mapValue.fields}}function uA(t,e,n){const r=Ln(t,e.name),i=Ue(e.updateTime),s=e.createTime?Ue(e.createTime):k.min(),o=new rt({mapValue:{fields:e.fields}}),a=Ee.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function eu(t,e){let n;if(e instanceof Zs)n={update:aA(t,e.key,e.value)};else if(e instanceof Xs)n={delete:Xa(t,e.key)};else if(e instanceof lr)n={update:aA(t,e.key,e.data),updateMask:pq(e.fieldMask)};else{if(!(e instanceof Am))return F();n={verify:Xa(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,s){const o=s.transform;if(o instanceof Qs)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Oi)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Pi)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Ys)return{fieldPath:s.field.canonicalString(),increment:o._t};throw F()}(0,r))),e.precondition.isNone||(n.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:oq(t,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:F()),n;var i}function km(t,e){const n=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?Ae.updateTime(Ue(i.updateTime)):void 0!==i.exists?Ae.exists(i.exists):Ae.none():Ae.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,o){let a=null;"setToServerValue"in o?(R("REQUEST_TIME"===o.setToServerValue),a=new Qs):"appendMissingElements"in o?a=new Oi(o.appendMissingElements.values||[]):"removeAllFromArray"in o?a=new Pi(o.removeAllFromArray.values||[]):"increment"in o?a=new Ys(s,o.increment):F();const u=Pe.fromServerFormat(o.fieldPath);return new Ka(u,a)}(t,i)):[];var i;if(e.update){const i=Ln(t,e.update.name),s=new rt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new Ut((e.updateMask.fieldPaths||[]).map(c=>Pe.fromServerFormat(c)));return new lr(i,s,o,n,r)}return new Zs(i,s,n,r)}if(e.delete){const i=Ln(t,e.delete);return new Xs(i,n)}if(e.verify){const i=Ln(t,e.verify);return new Am(i,n)}return F()}function cA(t,e){return{documents:[Rm(t,e.path)]}}function Lm(t,e){const n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Rm(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Rm(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(u){if(0!==u.length)return hA(fe.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(u){if(0!==u.length)return u.map(c=>{return{field:Vr((l=c).field),direction:dq(l.dir)};var l})}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=(c=e.limit,t.useProto3Json||La(c)?c:{value:c});var c,a,u;return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt={before:!(u=e.endAt).inclusive,values:u.position}),n}function lA(t){let e=sA(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){R(1===r);const l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(l){const d=dA(l);return d instanceof fe&&wm(d)?d.getFilters():[d]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(l=>{return new zs(eo((d=l).field),function(h){switch(h){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(d.direction));var d}));let a=null;n.limit&&(a=function(l){let d;return d="object"==typeof l?l.value:l,La(d)?null:d}(n.limit));let u=null;var l;n.startAt&&(u=new kr((l=n.startAt).values||[],!!l.before));let c=null;return n.endAt&&(c=function(l){return new kr(l.values||[],!l.before)}(n.endAt)),MT(e,i,o,s,a,"F",u,c)}function dA(t){return void 0!==t.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=eo(e.unaryFilter.field);return te.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=eo(e.unaryFilter.field);return te.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=eo(e.unaryFilter.field);return te.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=eo(e.unaryFilter.field);return te.create(s,"!=",{nullValue:"NULL_VALUE"});default:return F()}}(t):void 0!==t.fieldFilter?te.create(eo((e=t).fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return F()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==t.compositeFilter?function(e){return fe.create(e.compositeFilter.filters.map(n=>dA(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return F()}}(e.compositeFilter.op))}(t):F();var e}function dq(t){return nq[t]}function hq(t){return rq[t]}function fq(t){return iq[t]}function Vr(t){return{fieldPath:t.canonicalString()}}function eo(t){return Pe.fromServerFormat(t.fieldPath)}function hA(t){return t instanceof te?function(e){if("=="===e.op){if(fT(e.value))return{unaryFilter:{field:Vr(e.field),op:"IS_NAN"}};if(hT(e.value))return{unaryFilter:{field:Vr(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(fT(e.value))return{unaryFilter:{field:Vr(e.field),op:"IS_NOT_NAN"}};if(hT(e.value))return{unaryFilter:{field:Vr(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vr(e.field),op:hq(e.op),value:e.value}}}(t):t instanceof fe?function(e){const n=e.getFilters().map(r=>hA(r));return 1===n.length?n[0]:{compositeFilter:{op:fq(e.op),filters:n}}}(t):F()}function pq(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function fA(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class Br{constructor(e,n,r,i,s=k.min(),o=k.min(),a=Je.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new Br(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Br(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class pA{constructor(e){this.se=e}}function gA(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:nd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:Xa(i=t.se,(s=e).key),fields:s.data.value.mapValue.fields,updateTime:Js(i,s.version.toTimestamp()),createTime:Js(i,s.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ri(e.version)};else{if(!e.isUnknownDocument())return F();r.unknownDocument={path:n.path.toArray(),version:Ri(e.version)}}var i,s;return r}function nd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ri(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ki(t){const e=new Te(t.seconds,t.nanoseconds);return k.fromTimestamp(e)}function Li(t,e){const n=(e.baseMutations||[]).map(s=>km(t.se,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>km(t.se,s)),i=Te.fromMillis(e.localWriteTimeMs);return new Mm(e.batchId,i,n,r)}function tu(t){const e=ki(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?ki(t.lastLimboFreeSnapshotVersion):k.min();let r;var i;return void 0!==t.query.documents?(R(1===(i=t.query).documents.length),r=Nt(Ks(sA(i.documents[0])))):r=Nt(lA(t.query)),new Br(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Je.fromBase64String(t.resumeToken))}function mA(t,e){const n=Ri(e.snapshotVersion),r=Ri(e.lastLimboFreeSnapshotVersion);let i;i=zl(e.target)?cA(t.se,e.target):Lm(t.se,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ni(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Vm(t){const e=lA({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ql(e,e.limit,"L"):e}function Bm(t,e){return new Nm(e.largestBatchId,km(t.se,e.overlayMutation))}function yA(t,e){const n=e.path.lastSegment();return[t,xt(e.path.popLast()),n]}function vA(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Ri(r.readTime),documentKey:xt(r.documentKey.path),largestBatchId:r.largestBatchId}}class mq{getBundleMetadata(e,n){return _A(e).get(n).next(r=>{if(r)return{id:(i=r).bundleId,createTime:ki(i.createTime),version:i.version};var i})}saveBundleMetadata(e,n){return _A(e).put({bundleId:(r=n).id,createTime:Ri(Ue(r.createTime)),version:r.version});var r}getNamedQuery(e,n){return DA(e).get(n).next(r=>{if(r)return{name:(i=r).name,query:Vm(i.bundledQuery),readTime:ki(i.readTime)};var i})}saveNamedQuery(e,n){return DA(e).put({name:(r=n).name,readTime:Ri(Ue(r.readTime)),bundledQuery:r.bundledQuery});var r}}function _A(t){return nt(t,"bundles")}function DA(t){return nt(t,"namedQueries")}class rd{constructor(e,n){this.serializer=e,this.userId=n}static ie(e,n){return new rd(e,n.uid||"")}getOverlay(e,n){return nu(e).get(yA(this.userId,n)).next(r=>r?Bm(this.serializer,r):null)}getOverlays(e,n){const r=kn();return y.forEach(n,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new Nm(n,o);i.push(this.re(e,a))}),y.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(xt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(nu(e).J("collectionPathOverlayIndex",a))}),y.waitFor(s)}getOverlaysForCollection(e,n,r){const i=kn(),s=xt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return nu(e).j("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const c=Bm(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=kn();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return nu(e).Z({index:"collectionGroupOverlayIndex",range:a},(u,c,l)=>{const d=Bm(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}re(e,n){return nu(e).put(function(r,i,s){const[o,a,u]=yA(i,s.mutation.key);return{userId:i,collectionPath:a,documentId:u,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:eu(r.se,s.mutation)}}(this.serializer,this.userId,n))}}function nu(t){return nt(t,"documentOverlays")}class Vi{constructor(){}oe(e,n){this.ue(e,n),n.ce()}ue(e,n){if("nullValue"in e)this.ae(n,5);else if("booleanValue"in e)this.ae(n,10),n.he(e.booleanValue?1:0);else if("integerValue"in e)this.ae(n,15),n.he(ke(e.integerValue));else if("doubleValue"in e){const r=ke(e.doubleValue);isNaN(r)?this.ae(n,13):(this.ae(n,15),Va(r)?n.he(0):n.he(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ae(n,20),"string"==typeof r?n.le(r):(n.le(`${r.seconds||""}`),n.he(r.nanos||0))}else if("stringValue"in e)this.fe(e.stringValue,n),this.de(n);else if("bytesValue"in e)this.ae(n,30),n.we(Ai(e.bytesValue)),this.de(n);else if("referenceValue"in e)this._e(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.ae(n,45),n.he(r.latitude||0),n.he(r.longitude||0)}else"mapValue"in e?pT(e)?this.ae(n,Number.MAX_SAFE_INTEGER):(this.me(e.mapValue,n),this.de(n)):"arrayValue"in e?(this.ge(e.arrayValue,n),this.de(n)):F()}fe(e,n){this.ae(n,25),this.ye(e,n)}ye(e,n){n.le(e)}me(e,n){const r=e.fields||{};this.ae(n,55);for(const i of Object.keys(r))this.fe(i,n),this.ue(r[i],n)}ge(e,n){const r=e.values||[];this.ae(n,50);for(const i of r)this.ue(i,n)}_e(e,n){this.ae(n,37),T.fromName(e).path.forEach(r=>{this.ae(n,60),this.ye(r,n)})}ae(e,n){e.he(n)}de(e){e.he(2)}}function yq(t){if(0===t)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function wA(t){const e=64-function(n){let r=0;for(let i=0;i<8;++i){const s=yq(255&n[i]);if(r+=s,8!==s)break}return r}(t);return Math.ceil(e/8)}Vi.pe=new Vi;class vq{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ie(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Te(r.value),r=n.next();this.Ee()}Ae(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Re(r.value),r=n.next();this.ve()}be(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Te(r);else if(r<2048)this.Te(960|r>>>6),this.Te(128|63&r);else if(n<"\ud800"||"\udbff"<n)this.Te(480|r>>>12),this.Te(128|63&r>>>6),this.Te(128|63&r);else{const i=n.codePointAt(0);this.Te(240|i>>>18),this.Te(128|63&i>>>12),this.Te(128|63&i>>>6),this.Te(128|63&i)}}this.Ee()}Pe(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Re(r);else if(r<2048)this.Re(960|r>>>6),this.Re(128|63&r);else if(n<"\ud800"||"\udbff"<n)this.Re(480|r>>>12),this.Re(128|63&r>>>6),this.Re(128|63&r);else{const i=n.codePointAt(0);this.Re(240|i>>>18),this.Re(128|63&i>>>12),this.Re(128|63&i>>>6),this.Re(128|63&i)}}this.ve()}Ve(e){const n=this.Se(e),r=wA(n);this.De(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Ce(e){const n=this.Se(e),r=wA(n);this.De(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}xe(){this.Ne(255),this.Ne(255)}ke(){this.Oe(255),this.Oe(255)}reset(){this.position=0}seed(e){this.De(e.length),this.buffer.set(e,this.position),this.position+=e.length}$e(){return this.buffer.slice(0,this.position)}Se(e){const n=function(i){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,i,!1),new Uint8Array(s.buffer)}(e),r=0!=(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Te(e){const n=255&e;0===n?(this.Ne(0),this.Ne(255)):255===n?(this.Ne(255),this.Ne(0)):this.Ne(n)}Re(e){const n=255&e;0===n?(this.Oe(0),this.Oe(255)):255===n?(this.Oe(255),this.Oe(0)):this.Oe(e)}Ee(){this.Ne(0),this.Ne(1)}ve(){this.Oe(0),this.Oe(1)}Ne(e){this.De(1),this.buffer[this.position++]=e}Oe(e){this.De(1),this.buffer[this.position++]=~e}De(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class _q{constructor(e){this.Me=e}we(e){this.Me.Ie(e)}le(e){this.Me.be(e)}he(e){this.Me.Ve(e)}ce(){this.Me.xe()}}class Dq{constructor(e){this.Me=e}we(e){this.Me.Ae(e)}le(e){this.Me.Pe(e)}he(e){this.Me.Ce(e)}ce(){this.Me.ke()}}class ru{constructor(){this.Me=new vq,this.Fe=new _q(this.Me),this.Be=new Dq(this.Me)}seed(e){this.Me.seed(e)}Le(e){return 0===e?this.Fe:this.Be}$e(){return this.Me.$e()}reset(){this.Me.reset()}}class Bi{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}qe(){const e=this.directionalValue.length,n=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Bi(this.indexId,this.documentKey,this.arrayValue,r)}}function jr(t,e){let n=t.indexId-e.indexId;return 0!==n?n:(n=EA(t.arrayValue,e.arrayValue),0!==n?n:(n=EA(t.directionalValue,e.directionalValue),0!==n?n:T.comparator(t.documentKey,e.documentKey)))}function EA(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(0!==r)return r}return t.length-e.length}class wq{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.Ke=[];for(const n of e.filters){const r=n;r.isInequality()?this.Ge=r:this.Ke.push(r)}}Qe(e){R(e.collectionGroup===this.collectionId);const n=hm(e);if(void 0!==n&&!this.ze(n))return!1;const r=Ii(e);let i=0,s=0;for(;i<r.length&&this.ze(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.Ge){const o=r[i];if(!this.je(this.Ge,o)||!this.We(this.Ue[s++],o))return!1;++i}for(;i<r.length;++i)if(s>=this.Ue.length||!this.We(this.Ue[s++],r[i]))return!1;return!0}ze(e){for(const n of this.Ke)if(this.je(n,e))return!0;return!1}je(e,n){return!(void 0===e||!e.field.isEqual(n.fieldPath))&&2===n.kind==("array-contains"===e.op||"array-contains-any"===e.op)}We(e,n){return!!e.field.isEqual(n.fieldPath)&&(0===n.kind&&"asc"===e.dir||1===n.kind&&"desc"===e.dir)}}function CA(t){var e,n;if(R(t instanceof te||t instanceof fe),t instanceof te){if(t instanceof ST){const i=(null===(n=null===(e=t.value.arrayValue)||void 0===e?void 0:e.values)||void 0===n?void 0:n.map(s=>te.create(t.field,"==",s)))||[];return fe.create(i,"or")}return t}const r=t.filters.map(i=>CA(i));return fe.create(r,t.op)}function Eq(t){if(0===t.getFilters().length)return[];const e=$m(CA(t));return R(bA(e)),jm(e)||Um(e)?[e]:e.getFilters()}function jm(t){return t instanceof te}function Um(t){return t instanceof fe&&wm(t)}function bA(t){return jm(t)||Um(t)||function(e){if(e instanceof fe&&Dm(e)){for(const n of e.getFilters())if(!jm(n)&&!Um(n))return!1;return!0}return!1}(t)}function $m(t){if(R(t instanceof te||t instanceof fe),t instanceof te)return t;if(1===t.filters.length)return $m(t.filters[0]);const e=t.filters.map(r=>$m(r));let n=fe.create(e,t.op);return n=id(n),bA(n)?n:(R(n instanceof fe),R(Ws(n)),R(n.filters.length>1),n.filters.reduce((r,i)=>Hm(r,i)))}function Hm(t,e){let n;return R(t instanceof te||t instanceof fe),R(e instanceof te||e instanceof fe),n=t instanceof te?e instanceof te?fe.create([t,e],"and"):IA(t,e):e instanceof te?IA(e,t):function(r,i){if(R(r.filters.length>0&&i.filters.length>0),Ws(r)&&Ws(i))return CT(r,i.getFilters());const s=Dm(r)?r:i,o=Dm(r)?i:r,a=s.filters.map(u=>Hm(u,o));return fe.create(a,"or")}(t,e),id(n)}function IA(t,e){if(Ws(e))return CT(e,t.getFilters());{const n=e.filters.map(r=>Hm(t,r));return fe.create(n,"or")}}function id(t){if(R(t instanceof te||t instanceof fe),t instanceof te)return t;const e=t.getFilters();if(1===e.length)return id(e[0]);if(wT(t))return t;const n=e.map(i=>id(i)),r=[];return n.forEach(i=>{i instanceof te?r.push(i):i instanceof fe&&(i.op===t.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:fe.create(r,t.op)}class Cq{constructor(){this.He=new Gm}addToCollectionParentIndex(e,n){return this.He.add(n),y.resolve()}getCollectionParents(e,n){return y.resolve(this.He.getEntries(n))}addFieldIndex(e,n){return y.resolve()}deleteFieldIndex(e,n){return y.resolve()}getDocumentsMatchingTarget(e,n){return y.resolve(null)}getIndexType(e,n){return y.resolve(0)}getFieldIndexes(e,n){return y.resolve([])}getNextCollectionGroupToUpdate(e){return y.resolve(null)}getMinOffset(e,n){return y.resolve(Jt.min())}getMinOffsetFromCollectionGroup(e,n){return y.resolve(Jt.min())}updateCollectionGroup(e,n,r){return y.resolve()}updateIndexEntries(e,n){return y.resolve()}}class Gm{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new pe(ie.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new pe(ie.comparator)).toArray()}}const sd=new Uint8Array(0);class bq{constructor(e,n){this.user=e,this.databaseId=n,this.Je=new Gm,this.Ye=new Lr(r=>Ni(r),(r,i)=>Ha(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Je.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.Je.add(n)});const s={collectionId:r,parent:xt(i)};return SA(e).put(s)}return y.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[KS(n),""],!1,!0);return SA(e).j(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Pn(o.parent))}return r})}addFieldIndex(e,n){const r=od(e),i={indexId:(o=n).indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])};var o;delete i.indexId;const s=r.add(i);if(n.indexState){const o=su(e);return s.next(a=>{o.put(vA(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=od(e),i=su(e),s=iu(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const r=iu(e);let i=!0;const s=new Map;return y.forEach(this.Ze(n),o=>this.Xe(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Y();const a=[];return y.forEach(s,(u,c)=>{var l;b("IndexedDbIndexManager",`Using index ${l=u,`id=${l.indexId}|cg=${l.collectionGroup}|f=${l.fields.map(_=>`${_.fieldPath}:${_.kind}`).join(",")}`} to execute ${Ni(n)}`);const d=function(_,O){const j=hm(O);if(void 0===j)return null;for(const H of Wl(_,j.fieldPath))switch(H.op){case"array-contains-any":return H.value.arrayValue.values||[];case"array-contains":return[H.value]}return null}(c,u),h=function(_,O){const j=new Map;for(const H of Ii(O))for(const Gt of Wl(_,H.fieldPath))switch(Gt.op){case"==":case"in":j.set(H.fieldPath.canonicalString(),Gt.value);break;case"not-in":case"!=":return j.set(H.fieldPath.canonicalString(),Gt.value),Array.from(j.values())}return null}(c,u),f=function(_,O){const j=[];let H=!0;for(const Gt of Ii(O)){const Xr=0===Gt.kind?TT(_,Gt.fieldPath,_.startAt):AT(_,Gt.fieldPath,_.startAt);j.push(Xr.value),H&&(H=Xr.inclusive)}return new kr(j,H)}(c,u),p=function(_,O){const j=[];let H=!0;for(const Gt of Ii(O)){const Xr=0===Gt.kind?AT(_,Gt.fieldPath,_.endAt):TT(_,Gt.fieldPath,_.endAt);j.push(Xr.value),H&&(H=Xr.inclusive)}return new kr(j,H)}(c,u),g=this.tn(u,c,f),m=this.tn(u,c,p),w=this.en(u,c,h),I=this.nn(u.indexId,d,g,f.inclusive,m,p.inclusive,w);return y.forEach(I,_=>r.H(_,n.limit).next(O=>{O.forEach(j=>{const H=T.fromSegments(j.documentKey);o.has(H)||(o=o.add(H),a.push(H))})}))}).next(()=>a)}return y.resolve(null)})}Ze(e){let n=this.Ye.get(e);return n||(n=0===e.filters.length?[e]:Eq(fe.create(e.filters,"and")).map(r=>Cm(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Ye.set(e,n),n)}nn(e,n,r,i,s,o,a){const u=(null!=n?n.length:1)*Math.max(r.length,s.length),c=u/(null!=n?n.length:1),l=[];for(let d=0;d<u;++d){const h=n?this.sn(n[d/c]):sd,f=this.rn(e,h,r[d%c],i),p=this.on(e,h,s[d%c],o),g=a.map(m=>this.rn(e,h,m,!0));l.push(...this.createRange(f,p,g))}return l}rn(e,n,r,i){const s=new Bi(e,T.empty(),n,r);return i?s:s.qe()}on(e,n,r,i){const s=new Bi(e,T.empty(),n,r);return i?s.qe():s}Xe(e,n){const r=new wq(n),i=null!=n.collectionGroup?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.Qe(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.Ze(n);return y.forEach(i,s=>this.Xe(e,s).next(o=>{o?0!==r&&o.fields.length<function(a){let u=new pe(Pe.comparator),c=!1;for(const l of a.filters)for(const d of l.getFlattenedFilters())d.field.isKeyField()||("array-contains"===d.op||"array-contains-any"===d.op?c=!0:u=u.add(d.field));for(const l of a.orderBy)l.field.isKeyField()||(u=u.add(l.field));return u.size+(c?1:0)}(s)&&(r=1):r=0})).next(()=>null!==n.limit&&i.length>1&&2===r?1:r)}un(e,n){const r=new ru;for(const i of Ii(e)){const s=n.data.field(i.fieldPath);if(null==s)return null;const o=r.Le(i.kind);Vi.pe.oe(s,o)}return r.$e()}sn(e){const n=new ru;return Vi.pe.oe(e,n.Le(0)),n.$e()}cn(e,n){const r=new ru;return Vi.pe.oe(xi(this.databaseId,n),r.Le(function(i){const s=Ii(i);return 0===s.length?0:s[s.length-1].kind}(e))),r.$e()}en(e,n,r){if(null===r)return[];let i=[];i.push(new ru);let s=0;for(const o of Ii(e)){const a=r[s++];for(const u of i)if(this.an(n,o.fieldPath)&&Ua(a))i=this.hn(i,o,a);else{const c=u.Le(o.kind);Vi.pe.oe(a,c)}}return this.ln(i)}tn(e,n,r){return this.en(e,n,r.position)}ln(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].$e();return n}hn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const u=new ru;u.seed(a.$e()),Vi.pe.oe(o,u.Le(n.kind)),s.push(u)}return s}an(e,n){return!!e.filters.find(r=>r instanceof te&&r.field.isEqual(n)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,n){const r=od(e),i=su(e);return(n?r.j("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.j()).next(s=>{const o=[];return y.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(c,l){const d=l?new Ra(l.sequenceNumber,new Jt(ki(l.readTime),new T(Pn(l.documentKey)),l.largestBatchId)):Ra.empty(),h=c.fields.map(([f,p])=>new jl(Pe.fromServerFormat(f),p));return new Bl(c.indexId,c.collectionGroup,h,d)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>0===n.length?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:q(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=od(e),s=su(e);return this.fn(e).next(o=>i.j("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>y.forEach(a,u=>s.put(vA(u.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return y.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?y.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),y.forEach(a,u=>this.dn(e,i,u).next(c=>{const l=this.wn(s,u);return c.isEqual(l)?y.resolve():this._n(e,s,u,c,l)}))))})}mn(e,n,r,i){return iu(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.cn(r,n.key),documentKey:n.key.path.toArray()})}gn(e,n,r,i){return iu(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.cn(r,n.key),n.key.path.toArray()])}dn(e,n,r){const i=iu(e);let s=new pe(jr);return i.Z({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.cn(r,n)])},(o,a)=>{s=s.add(new Bi(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}wn(e,n){let r=new pe(jr);const i=this.un(n,e);if(null==i)return r;const s=hm(n);if(null!=s){const o=e.data.field(s.fieldPath);if(Ua(o))for(const a of o.arrayValue.values||[])r=r.add(new Bi(n.indexId,e.key,this.sn(a),i))}else r=r.add(new Bi(n.indexId,e.key,sd,i));return r}_n(e,n,r,i,s){b("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,u,c,l,d){const h=a.getIterator(),f=u.getIterator();let p=Gs(h),g=Gs(f);for(;p||g;){let m=!1,w=!1;if(p&&g){const I=c(p,g);I<0?w=!0:I>0&&(m=!0)}else null!=p?w=!0:m=!0;m?(l(g),g=Gs(f)):w?(d(p),p=Gs(h)):(p=Gs(h),g=Gs(f))}}(i,s,jr,a=>{o.push(this.mn(e,n,r,a))},a=>{o.push(this.gn(e,n,r,a))}),y.waitFor(o)}fn(e){let n=1;return su(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>jr(o,a)).filter((o,a,u)=>!a||0!==jr(o,u[a-1]));const i=[];i.push(e);for(const o of r){const a=jr(o,e),u=jr(o,n);if(0===a)i[0]=e.qe();else if(a>0&&u<0)i.push(o),i.push(o.qe());else if(u>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.yn(i[o],i[o+1]))return[];s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,sd,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,sd,[]]))}return s}yn(e,n){return jr(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(TA)}getMinOffset(e,n){return y.mapArray(this.Ze(n),r=>this.Xe(e,r).next(i=>i||F())).next(TA)}}function SA(t){return nt(t,"collectionParents")}function iu(t){return nt(t,"indexEntries")}function od(t){return nt(t,"indexConfiguration")}function su(t){return nt(t,"indexState")}function TA(t){R(0!==t.length);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;fm(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Jt(e.readTime,e.documentKey,n)}const AA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ht{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Ht(e,Ht.DEFAULT_COLLECTION_PERCENTILE,Ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function MA(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const u=r.Z({range:o},(l,d,h)=>(a++,h.delete()));s.push(u.next(()=>{R(1===a)}));const c=[];for(const l of n.mutations){const d=rT(e,l.key.path,n.batchId);s.push(i.delete(d)),c.push(l.key)}return y.waitFor(s).next(()=>c)}function ad(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw F();e=t.noDocument}return JSON.stringify(e).length}Ht.DEFAULT_COLLECTION_PERCENTILE=10,Ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ht.DEFAULT=new Ht(41943040,Ht.DEFAULT_COLLECTION_PERCENTILE,Ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ht.DISABLED=new Ht(-1,0,0);class ud{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.pn={}}static ie(e,n,r,i){R(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new ud(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ur(e).Z({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=to(e),o=Ur(e);return o.add({}).next(a=>{R("number"==typeof a);const u=new Mm(a,n,r,i),c=function(h,f,p){const g=p.baseMutations.map(w=>eu(h.se,w)),m=p.mutations.map(w=>eu(h.se,w));return{userId:f,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:g,mutations:m}}(this.serializer,this.userId,u),l=[];let d=new pe((h,f)=>q(h.canonicalString(),f.canonicalString()));for(const h of i){const f=rT(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(c)),l.push(s.put(f,lG))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.pn[a]=u.keys()}),y.waitFor(l).next(()=>u)})}lookupMutationBatch(e,n){return Ur(e).get(n).next(r=>r?(R(r.userId===this.userId),Li(this.serializer,r)):null)}In(e,n){return this.pn[n]?y.resolve(this.pn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.pn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ur(e).Z({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(R(a.batchId>=r),s=Li(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ur(e).Z({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ur(e).j("userMutationsIndex",n).next(r=>r.map(i=>Li(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=$l(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return to(e).Z({range:i},(o,a,u)=>{const[c,l,d]=o,h=Pn(l);if(c===this.userId&&n.path.isEqual(h))return Ur(e).get(d).next(f=>{if(!f)throw F();R(f.userId===this.userId),s.push(Li(this.serializer,f))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new pe(q);const i=[];return n.forEach(s=>{const o=$l(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=to(e).Z({range:a},(c,l,d)=>{const[h,f,p]=c,g=Pn(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(u)}),y.waitFor(i).next(()=>this.Tn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=$l(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new pe(q);return to(e).Z({range:o},(u,c,l)=>{const[d,h,f]=u,p=Pn(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Tn(e,a))}Tn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ur(e).get(s).next(o=>{if(null===o)throw F();R(o.userId===this.userId),r.push(Li(this.serializer,o))}))}),y.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return MA(e.at,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.En(n.batchId)}),y.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}En(e){delete this.pn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return y.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return to(e).Z({range:r},(s,o,a)=>{if(s[0]===this.userId){const u=Pn(s[1]);i.push(u)}else a.done()}).next(()=>{R(0===i.length)})})}containsKey(e,n){return xA(e,this.userId,n)}An(e){return NA(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function xA(t,e,n){const r=$l(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return to(t).Z({range:s,Y:!0},(a,u,c)=>{const[l,d,h]=a;l===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function Ur(t){return nt(t,"mutations")}function to(t){return nt(t,"documentMutations")}function NA(t){return nt(t,"mutationQueues")}class ji{constructor(e){this.Rn=e}next(){return this.Rn+=2,this.Rn}static vn(){return new ji(0)}static bn(){return new ji(-1)}}class Iq{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Pn(e).next(n=>{const r=new ji(n.highestTargetId);return n.highestTargetId=r.next(),this.Vn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Pn(e).next(n=>k.fromTimestamp(new Te(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Pn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Pn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Vn(e,i)))}addTargetData(e,n){return this.Sn(e,n).next(()=>this.Pn(e).next(r=>(r.targetCount+=1,this.Dn(n,r),this.Vn(e,r))))}updateTargetData(e,n){return this.Sn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>no(e).delete(n.targetId)).next(()=>this.Pn(e)).next(r=>(R(r.targetCount>0),r.targetCount-=1,this.Vn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return no(e).Z((o,a)=>{const u=tu(a);u.sequenceNumber<=n&&null===r.get(u.targetId)&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>y.waitFor(s)).next(()=>i)}forEachTarget(e,n){return no(e).Z((r,i)=>{const s=tu(i);n(s)})}Pn(e){return FA(e).get("targetGlobalKey").next(n=>(R(null!==n),n))}Vn(e,n){return FA(e).put("targetGlobalKey",n)}Sn(e,n){return no(e).put(mA(this.serializer,n))}Dn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Pn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Ni(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return no(e).Z({range:i,index:"queryTargetsIndex"},(o,a,u)=>{const c=tu(a);Ha(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=$r(e);return n.forEach(o=>{const a=xt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),y.waitFor(i)}removeMatchingKeys(e,n,r){const i=$r(e);return y.forEach(n,s=>{const o=xt(s.path);return y.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=$r(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=$r(e);let s=Y();return i.Z({range:r,Y:!0},(o,a,u)=>{const c=Pn(o[1]),l=new T(c);s=s.add(l)}).next(()=>s)}containsKey(e,n){const r=xt(n.path),i=IDBKeyRange.bound([r],[KS(r)],!1,!0);let s=0;return $r(e).Z({index:"documentTargetsIndex",Y:!0,range:i},([o,a],u,c)=>{0!==o&&(s++,c.done())}).next(()=>s>0)}ne(e,n){return no(e).get(n).next(r=>r?tu(r):null)}}function no(t){return nt(t,"targets")}function FA(t){return nt(t,"targetGlobal")}function $r(t){return nt(t,"targetDocuments")}function OA([t,e],[n,r]){const i=q(t,n);return 0===i?q(e,r):i}class Sq{constructor(e){this.Cn=e,this.buffer=new pe(OA),this.xn=0}Nn(){return++this.xn}kn(e){const n=[e,this.Nn()];if(this.buffer.size<this.Cn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();OA(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Tq{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.On=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.$n(6e4)}stop(){this.On&&(this.On.cancel(),this.On=null)}get started(){return null!==this.On}$n(e){var n=this;b("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.On=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,D(function*(){n.On=null;try{yield n.localStore.collectGarbage(n.garbageCollector)}catch(r){Nr(r)?b("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield xr(r)}yield n.$n(3e5)}))}}class Aq{constructor(e,n){this.Mn=e,this.params=n}calculateTargetCount(e,n){return this.Mn.Fn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(0===n)return y.resolve(en.ct);const r=new Sq(n);return this.Mn.forEachTarget(e,i=>r.kn(i.sequenceNumber)).next(()=>this.Mn.Bn(e,i=>r.kn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Mn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Mn.removeOrphanedDocuments(e,n)}collect(e,n){return-1===this.params.cacheSizeCollectionThreshold?(b("LruGarbageCollector","Garbage collection skipped; disabled"),y.resolve(AA)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(b("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),AA):this.Ln(e,n))}getCacheSize(e){return this.Mn.getCacheSize(e)}Ln(e,n){let r,i,s,o,a,u,c;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(b("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),lm()<=oe.DEBUG&&b("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-l}ms\n\tDetermined least recently used ${i} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(u-a)+`ms\n\tRemoved ${d} documents in `+(c-u)+`ms\nTotal Duration: ${c-l}ms`),y.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}}class Mq{constructor(e,n){this.db=e,this.garbageCollector=new Aq(this,n)}Fn(e){const n=this.qn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}qn(e){let n=0;return this.Bn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Bn(e,n){return this.Un(e,(r,i)=>n(i))}addReference(e,n,r){return cd(e,r)}removeReference(e,n,r){return cd(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return cd(e,n)}Kn(e,n){return function(r,i){let s=!1;return NA(r).X(o=>xA(r,o,i).next(a=>(a&&(s=!0),y.resolve(!a)))).next(()=>s)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Un(e,(o,a)=>{if(a<=n){const u=this.Kn(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,k.min()),$r(e).delete([0,xt(o.path)])))});i.push(u)}}).next(()=>y.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return cd(e,n)}Un(e,n){const r=$r(e);let i,s=en.ct;return r.Z({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{0===o?(s!==en.ct&&n(new T(Pn(i)),s),s=c,i=u):s=en.ct}).next(()=>{s!==en.ct&&n(new T(Pn(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function cd(t,e){return $r(t).put((r=t.currentSequenceNumber,{targetId:0,path:xt(e.path),sequenceNumber:r}));var r}class PA{constructor(){this.changes=new Lr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ee.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return void 0!==r?y.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class xq{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ui(e).put(r)}removeEntry(e,n,r){return Ui(e).delete(function(i,s){const o=i.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],nd(s),o[o.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Gn(e,r)))}getEntry(e,n){let r=Ee.newInvalidDocument(n);return Ui(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(ou(n))},(i,s)=>{r=this.Qn(n,s)}).next(()=>r)}zn(e,n){let r={size:0,document:Ee.newInvalidDocument(n)};return Ui(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(ou(n))},(i,s)=>{r={document:this.Qn(n,s),size:ad(s)}}).next(()=>r)}getEntries(e,n){let r=$t();return this.jn(e,n,(i,s)=>{const o=this.Qn(i,s);r=r.insert(i,o)}).next(()=>r)}Wn(e,n){let r=$t(),i=new Re(T.comparator);return this.jn(e,n,(s,o)=>{const a=this.Qn(s,o);r=r.insert(s,a),i=i.insert(s,ad(o))}).next(()=>({documents:r,Hn:i}))}jn(e,n,r){if(n.isEmpty())return y.resolve();let i=new pe(VA);n.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(ou(i.first()),ou(i.last())),o=i.getIterator();let a=o.getNext();return Ui(e).Z({index:"documentKeyIndex",range:s},(u,c,l)=>{const d=T.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&VA(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?l.G(ou(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i){const s=n.path,o=[s.popLast().toArray(),s.lastSegment(),nd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ui(e).j(IDBKeyRange.bound(o,a,!0)).next(u=>{let c=$t();for(const l of u){const d=this.Qn(T.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);d.isFoundDocument()&&(qa(n,d)||i.has(d.key))&&(c=c.insert(d.key,d))}return c})}getAllFromCollectionGroup(e,n,r,i){let s=$t();const o=LA(n,r),a=LA(n,Jt.max());return Ui(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,l)=>{const d=this.Qn(T.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new Nq(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return kA(e).get("remoteDocumentGlobalKey").next(n=>(R(!!n),n))}Gn(e,n){return kA(e).put("remoteDocumentGlobalKey",n)}Qn(e,n){if(n){const r=function gq(t,e){let n;if(e.document)n=uA(t.se,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=T.fromSegments(e.noDocument.path),i=ki(e.noDocument.readTime);n=Ee.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return F();{const r=T.fromSegments(e.unknownDocument.path),i=ki(e.unknownDocument.version);n=Ee.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(r){const i=new Te(r[0],r[1]);return k.fromTimestamp(i)}(e.readTime)),n}(this.serializer,n);if(!r.isNoDocument()||!r.version.isEqual(k.min()))return r}return Ee.newInvalidDocument(e)}}function RA(t){return new xq(t)}class Nq extends PA{constructor(e,n){super(),this.Jn=e,this.trackRemovals=n,this.Yn=new Lr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new pe((s,o)=>q(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Yn.get(s);if(n.push(this.Jn.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=gA(this.Jn.serializer,o);i=i.add(s.path.popLast());const c=ad(u);r+=c-a.size,n.push(this.Jn.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){const u=gA(this.Jn.serializer,o.convertToNoDocument(k.min()));n.push(this.Jn.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this.Jn.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Jn.updateMetadata(e,r)),y.waitFor(n)}getFromCache(e,n){return this.Jn.zn(e,n).next(r=>(this.Yn.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Jn.Wn(e,n).next(({documents:r,Hn:i})=>(i.forEach((s,o)=>{this.Yn.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function kA(t){return nt(t,"remoteDocumentGlobal")}function Ui(t){return nt(t,"remoteDocumentsV14")}function ou(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function LA(t,e){const n=e.documentKey.path.toArray();return[t,nd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function VA(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=q(n[s],r[s]),i)return i;return i=q(n.length,r.length),i||(i=q(n[n.length-2],r[r.length-2]),i||q(n[n.length-1],r[r.length-1]))}class Fq{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class BA{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(null!==r&&Qa(r.mutation,i,Ut.empty(),Te.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Y()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Y()){const i=kn();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=za();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=kn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Y()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=$t();const o=Wa(),a=Wa();return n.forEach((u,c)=>{const l=r.get(c.key);i.has(c.key)&&(void 0===l||l.mutation instanceof lr)?s=s.insert(c.key,c):void 0!==l?(o.set(c.key,l.mutation.getFieldMask()),Qa(l.mutation,c,l.mutation.getFieldMask(),Te.now())):o.set(c.key,Ut.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,l)=>o.set(c,l)),n.forEach((c,l)=>{var d;return a.set(c,new Fq(l,null!==(d=o.get(c))&&void 0!==d?d:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Wa();let i=new Re((o,a)=>o-a),s=Y();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(u=>{const c=n.get(u);if(null===c)return;let l=r.get(u)||Ut.empty();l=a.applyToLocalView(c,l),r.set(u,l);const d=(i.get(a.batchId)||Y()).add(u);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,l=u.value,d=kT();l.forEach(h=>{if(!s.has(h)){const f=qT(n.get(h),r.get(h));null!==f&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return y.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return T.isDocumentKey((i=n).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,n.path):Im(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r);var i}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):y.resolve(kn());let a=-1,u=s;return o.next(c=>y.forEach(c,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?y.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{u=u.insert(l,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,Y())).next(l=>({batchId:a,changes:RT(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new T(n)).next(r=>{let i=za();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const i=n.collectionGroup;let s=za();return this.indexManager.getCollectionParents(e,i).next(o=>y.forEach(o,a=>{const u=(c=n,l=a.child(i),new cr(l,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt));var c,l;return this.getDocumentsMatchingCollectionQuery(e,u,r).next(c=>{c.forEach((l,d)=>{s=s.insert(l,d)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i))).next(s=>{i.forEach((a,u)=>{const c=u.getKey();null===s.get(c)&&(s=s.insert(c,Ee.newInvalidDocument(c)))});let o=za();return s.forEach((a,u)=>{const c=i.get(a);void 0!==c&&Qa(c.mutation,u,Ut.empty(),Te.now()),qa(n,u)&&(o=o.insert(a,u))}),o})}}class Oq{constructor(e){this.serializer=e,this.Zn=new Map,this.Xn=new Map}getBundleMetadata(e,n){return y.resolve(this.Zn.get(n))}saveBundleMetadata(e,n){var r;return this.Zn.set(n.id,{id:(r=n).id,version:r.version,createTime:Ue(r.createTime)}),y.resolve()}getNamedQuery(e,n){return y.resolve(this.Xn.get(n))}saveNamedQuery(e,n){return this.Xn.set(n.name,{name:(r=n).name,query:Vm(r.bundledQuery),readTime:Ue(r.readTime)}),y.resolve();var r}}class Pq{constructor(){this.overlays=new Re(T.comparator),this.ts=new Map}getOverlay(e,n){return y.resolve(this.overlays.get(n))}getOverlays(e,n){const r=kn();return y.forEach(n,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.re(e,n,s)}),y.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.ts.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.ts.delete(r)),y.resolve()}getOverlaysForCollection(e,n,r){const i=kn(),s=n.length+1,o=new T(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return y.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Re((c,l)=>c-l);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let l=s.get(c.largestBatchId);null===l&&(l=kn(),s=s.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}const a=kn(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(c,l)),!(a.size()>=i)););return y.resolve(a)}re(e,n,r){const i=this.overlays.get(r.key);if(null!==i){const o=this.ts.get(i.largestBatchId).delete(r.key);this.ts.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Nm(n,r));let s=this.ts.get(n);void 0===s&&(s=Y(),this.ts.set(n,s)),this.ts.set(n,s.add(r.key))}}class qm{constructor(){this.es=new pe(it.ns),this.ss=new pe(it.rs)}isEmpty(){return this.es.isEmpty()}addReference(e,n){const r=new it(e,n);this.es=this.es.add(r),this.ss=this.ss.add(r)}os(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.us(new it(e,n))}cs(e,n){e.forEach(r=>this.removeReference(r,n))}hs(e){const n=new T(new ie([])),r=new it(n,e),i=new it(n,e+1),s=[];return this.ss.forEachInRange([r,i],o=>{this.us(o),s.push(o.key)}),s}ls(){this.es.forEach(e=>this.us(e))}us(e){this.es=this.es.delete(e),this.ss=this.ss.delete(e)}fs(e){const n=new T(new ie([])),r=new it(n,e),i=new it(n,e+1);let s=Y();return this.ss.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new it(e,0),r=this.es.firstAfterOrEqual(n);return null!==r&&e.isEqual(r.key)}}class it{constructor(e,n){this.key=e,this.ds=n}static ns(e,n){return T.comparator(e.key,n.key)||q(e.ds,n.ds)}static rs(e,n){return q(e.ds,n.ds)||T.comparator(e.key,n.key)}}class Rq{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.ws=1,this._s=new pe(it.ns)}checkEmpty(e){return y.resolve(0===this.mutationQueue.length)}addMutationBatch(e,n,r,i){const s=this.ws;this.ws++;const o=new Mm(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this._s=this._s.add(new it(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return y.resolve(o)}lookupMutationBatch(e,n){return y.resolve(this.gs(n))}getNextMutationBatchAfterBatchId(e,n){const i=this.ys(n+1),s=i<0?0:i;return y.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return y.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new it(n,0),i=new it(n,Number.POSITIVE_INFINITY),s=[];return this._s.forEachInRange([r,i],o=>{const a=this.gs(o.ds);s.push(a)}),y.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new pe(q);return n.forEach(i=>{const s=new it(i,0),o=new it(i,Number.POSITIVE_INFINITY);this._s.forEachInRange([s,o],a=>{r=r.add(a.ds)})}),y.resolve(this.ps(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;T.isDocumentKey(s)||(s=s.child(""));const o=new it(new T(s),0);let a=new pe(q);return this._s.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.ds)),!0)},o),y.resolve(this.ps(a))}ps(e){const n=[];return e.forEach(r=>{const i=this.gs(r);null!==i&&n.push(i)}),n}removeMutationBatch(e,n){R(0===this.Is(n.batchId,"removed")),this.mutationQueue.shift();let r=this._s;return y.forEach(n.mutations,i=>{const s=new it(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this._s=r})}En(e){}containsKey(e,n){const r=new it(n,0),i=this._s.firstAfterOrEqual(r);return y.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return y.resolve()}Is(e,n){return this.ys(e)}ys(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}gs(e){const n=this.ys(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class kq{constructor(e){this.Ts=e,this.docs=new Re(T.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Ts(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return y.resolve(r?r.document.mutableCopy():Ee.newInvalidDocument(n))}getEntries(e,n){let r=$t();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ee.newInvalidDocument(i))}),y.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=$t();const o=n.path,a=new T(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:c,value:{document:l}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||fm(YS(l),r)<=0||(i.has(l.key)||qa(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return y.resolve(s)}getAllFromCollectionGroup(e,n,r,i){F()}Es(e,n){return y.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Lq(this)}getSize(e){return y.resolve(this.size)}}class Lq extends PA{constructor(e){super(),this.Jn=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Jn.addEntry(e,i)):this.Jn.removeEntry(r)}),y.waitFor(n)}getFromCache(e,n){return this.Jn.getEntry(e,n)}getAllFromCache(e,n){return this.Jn.getEntries(e,n)}}class Vq{constructor(e){this.persistence=e,this.As=new Lr(n=>Ni(n),Ha),this.lastRemoteSnapshotVersion=k.min(),this.highestTargetId=0,this.Rs=0,this.vs=new qm,this.targetCount=0,this.bs=ji.vn()}forEachTarget(e,n){return this.As.forEach((r,i)=>n(i)),y.resolve()}getLastRemoteSnapshotVersion(e){return y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return y.resolve(this.Rs)}allocateTargetId(e){return this.highestTargetId=this.bs.next(),y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Rs&&(this.Rs=n),y.resolve()}Sn(e){this.As.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.bs=new ji(n),this.highestTargetId=n),e.sequenceNumber>this.Rs&&(this.Rs=e.sequenceNumber)}addTargetData(e,n){return this.Sn(n),this.targetCount+=1,y.resolve()}updateTargetData(e,n){return this.Sn(n),y.resolve()}removeTargetData(e,n){return this.As.delete(n.target),this.vs.hs(n.targetId),this.targetCount-=1,y.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.As.forEach((o,a)=>{a.sequenceNumber<=n&&null===r.get(a.targetId)&&(this.As.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),y.waitFor(s).next(()=>i)}getTargetCount(e){return y.resolve(this.targetCount)}getTargetData(e,n){const r=this.As.get(n)||null;return y.resolve(r)}addMatchingKeys(e,n,r){return this.vs.os(n,r),y.resolve()}removeMatchingKeys(e,n,r){this.vs.cs(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),y.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.vs.hs(n),y.resolve()}getMatchingKeysForTargetId(e,n){const r=this.vs.fs(n);return y.resolve(r)}containsKey(e,n){return y.resolve(this.vs.containsKey(n))}}class jA{constructor(e,n){this.Ps={},this.overlays={},this.Vs=new en(0),this.Ss=!1,this.Ss=!0,this.referenceDelegate=e(this),this.Ds=new Vq(this),this.indexManager=new Cq,this.remoteDocumentCache=new kq(r=>this.referenceDelegate.Cs(r)),this.serializer=new pA(n),this.xs=new Oq(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ss=!1,Promise.resolve()}get started(){return this.Ss}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Pq,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Ps[e.toKey()];return r||(r=new Rq(n,this.referenceDelegate),this.Ps[e.toKey()]=r),r}getTargetCache(){return this.Ds}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.xs}runTransaction(e,n,r){b("MemoryPersistence","Starting transaction:",e);const i=new Bq(this.Vs.next());return this.referenceDelegate.Ns(),r(i).next(s=>this.referenceDelegate.ks(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Os(e,n){return y.or(Object.values(this.Ps).map(r=>()=>r.containsKey(e,n)))}}class Bq extends XS{constructor(e){super(),this.currentSequenceNumber=e}}class ld{constructor(e){this.persistence=e,this.$s=new qm,this.Ms=null}static Fs(e){return new ld(e)}get Bs(){if(this.Ms)return this.Ms;throw F()}addReference(e,n,r){return this.$s.addReference(r,n),this.Bs.delete(r.toString()),y.resolve()}removeReference(e,n,r){return this.$s.removeReference(r,n),this.Bs.add(r.toString()),y.resolve()}markPotentiallyOrphaned(e,n){return this.Bs.add(n.toString()),y.resolve()}removeTarget(e,n){this.$s.hs(n.targetId).forEach(i=>this.Bs.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Bs.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ns(){this.Ms=new Set}ks(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return y.forEach(this.Bs,r=>{const i=T.fromPath(r);return this.Ls(e,i).next(s=>{s||n.removeEntry(i,k.min())})}).next(()=>(this.Ms=null,n.apply(e)))}updateLimboDocument(e,n){return this.Ls(e,n).next(r=>{r?this.Bs.delete(n.toString()):this.Bs.add(n.toString())})}Cs(e){return 0}Ls(e,n){return y.or([()=>y.resolve(this.$s.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Os(e,n)])}}class jq{constructor(e){this.serializer=e}M(e,n,r,i){const s=new Ul("createOrUpgrade",n);var a;r<1&&i>=1&&(e.createObjectStore("owner"),(a=e).createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",nT,{unique:!0}),a.createObjectStore("documentMutations"),UA(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=y.resolve();return r<3&&i>=3&&(0!==r&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),UA(e)),o=o.next(()=>function(a){const u=a.store("targetGlobal"),c={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:k.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",c)}(s))),r<4&&i>=4&&(0!==r&&(o=o.next(()=>function(a,u){return u.store("mutations").j().next(c=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",nT,{unique:!0});const l=u.store("mutations"),d=c.map(h=>l.put(h));return y.waitFor(d)})}(e,s))),o=o.next(()=>{!function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(o=o.next(()=>this.qs(s))),r<6&&i>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Us(s)))),r<7&&i>=7&&(o=o.next(()=>this.Ks(s))),r<8&&i>=8&&(o=o.next(()=>this.Gs(e,s))),r<9&&i>=9&&(o=o.next(()=>{!function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(o=o.next(()=>this.Qs(s))),r<11&&i>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{!function(a){const u=a.createObjectStore("documentOverlays",{keyPath:EG});u.createIndex("collectionPathOverlayIndex",CG,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",bG,{unique:!1})}(e)})),r<13&&i>=13&&(o=o.next(()=>function(a){const u=a.createObjectStore("remoteDocumentsV14",{keyPath:dG});u.createIndex("documentKeyIndex",hG),u.createIndex("collectionGroupIndex",fG)}(e)).next(()=>this.zs(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.js(e,s))),r<15&&i>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:vG}).createIndex("sequenceNumberIndex",_G,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:DG}).createIndex("documentKeyIndex",wG,{unique:!1})}(e))),o}Us(e){let n=0;return e.store("remoteDocuments").Z((r,i)=>{n+=ad(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}qs(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.j().next(i=>y.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.j("userMutationsIndex",o).next(a=>y.forEach(a,u=>{R(u.userId===s.userId);const c=Li(this.serializer,u);return MA(e,s.userId,c).next(()=>{})}))}))}Ks(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Z((o,a)=>{const u=new ie(o),c=[0,xt(u)];s.push(n.get(c).next(l=>l?y.resolve():n.put({targetId:0,path:xt(u),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>y.waitFor(s))})}Gs(e,n){e.createObjectStore("collectionParents",{keyPath:yG});const r=n.store("collectionParents"),i=new Gm,s=o=>{if(i.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:xt(u)})}};return n.store("remoteDocuments").Z({Y:!0},(o,a)=>{const u=new ie(o);return s(u.popLast())}).next(()=>n.store("documentMutations").Z({Y:!0},([o,a,u],c)=>{const l=Pn(a);return s(l.popLast())}))}Qs(e){const n=e.store("targets");return n.Z((r,i)=>{const s=tu(i),o=mA(this.serializer,s);return n.put(o)})}zs(e,n){const r=n.store("remoteDocuments"),i=[];return r.Z((s,o)=>{const a=n.store("remoteDocumentsV14"),u=(c=o,c.document?new T(ie.fromString(c.document.name).popFirst(5)):c.noDocument?T.fromSegments(c.noDocument.path):c.unknownDocument?T.fromSegments(c.unknownDocument.path):F()).path.toArray();var c;const l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>y.waitFor(i))}js(e,n){const r=n.store("mutations"),i=RA(this.serializer),s=new jA(ld.Fs,this.serializer.se);return r.j().next(o=>{const a=new Map;return o.forEach(u=>{var c;let l=null!==(c=a.get(u.userId))&&void 0!==c?c:Y();Li(this.serializer,u).keys().forEach(d=>l=l.add(d)),a.set(u.userId,l)}),y.forEach(a,(u,c)=>{const l=new tt(c),d=rd.ie(this.serializer,l),h=s.getIndexManager(l),f=ud.ie(l,this.serializer,h,s.referenceDelegate);return new BA(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new mm(n,en.ct),u).next()})})}}function UA(t){t.createObjectStore("targetDocuments",{keyPath:gG}).createIndex("documentTargetsIndex",mG,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",pG,{unique:!0}),t.createObjectStore("targetGlobal")}const zm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Wm{constructor(e,n,r,i,s,o,a,u,c,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Ws=s,this.window=o,this.document=a,this.Hs=c,this.Js=l,this.Ys=d,this.Vs=null,this.Ss=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.Xs=null,this.ti=null,this.ei=Number.NEGATIVE_INFINITY,this.ni=h=>Promise.resolve(),!Wm.D())throw new E(v.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Mq(this,i),this.si=n+"main",this.serializer=new pA(u),this.ii=new Dn(this.si,this.Ys,new jq(this.serializer)),this.Ds=new Iq(this.referenceDelegate,this.serializer),this.remoteDocumentCache=RA(this.serializer),this.xs=new mq,this.window&&this.window.localStorage?this.ri=this.window.localStorage:(this.ri=null,!1===l&&je("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.oi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new E(v.FAILED_PRECONDITION,zm);return this.ui(),this.ci(),this.ai(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ds.getHighestSequenceNumber(e))}).then(e=>{this.Vs=new en(e,this.Hs)}).then(()=>{this.Ss=!0}).catch(e=>(this.ii&&this.ii.close(),Promise.reject(e)))}hi(e){var n=this;return this.ni=function(){var r=D(function*(i){if(n.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ii.B(function(){var n=D(function*(r){null===r.newVersion&&(yield e())});return function(r){return n.apply(this,arguments)}}())}setNetworkEnabled(e){var n=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Ws.enqueueAndForget(D(function*(){n.started&&(yield n.oi())})))}oi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>dd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.li(e).next(n=>{n||(this.isPrimary=!1,this.Ws.enqueueRetryable(()=>this.ni(!1)))})}).next(()=>this.fi(e)).next(n=>this.isPrimary&&!n?this.di(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(Nr(e))return b("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return b("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ws.enqueueRetryable(()=>this.ni(e)),this.isPrimary=e})}li(e){return au(e).get("owner").next(n=>y.resolve(this._i(n)))}mi(e){return dd(e).delete(this.clientId)}gi(){var e=this;return D(function*(){if(e.isPrimary&&!e.yi(e.ei,18e5)){e.ei=Date.now();const n=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=nt(r,"clientMetadata");return i.j().next(s=>{const o=e.pi(s,18e5),a=s.filter(u=>-1===o.indexOf(u));return y.forEach(a,u=>i.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(e.ri)for(const r of n)e.ri.removeItem(e.Ii(r.clientId))}})()}ai(){this.ti=this.Ws.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.oi().then(()=>this.gi()).then(()=>this.ai()))}_i(e){return!!e&&e.ownerId===this.clientId}fi(e){return this.Js?y.resolve(!0):au(e).get("owner").next(n=>{if(null!==n&&this.yi(n.leaseTimestampMs,5e3)&&!this.Ti(n.ownerId)){if(this._i(n)&&this.networkEnabled)return!0;if(!this._i(n)){if(!n.allowTabSynchronization)throw new E(v.FAILED_PRECONDITION,zm);return!1}}return!(!this.networkEnabled||!this.inForeground)||dd(e).j().next(r=>void 0===this.pi(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(n=>(this.isPrimary!==n&&b("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){var e=this;return D(function*(){e.Ss=!1,e.Ei(),e.ti&&(e.ti.cancel(),e.ti=null),e.Ai(),e.Ri(),yield e.ii.runTransaction("shutdown","readwrite",["owner","clientMetadata"],n=>{const r=new mm(n,en.ct);return e.di(r).next(()=>e.mi(r))}),e.ii.close(),e.vi()})()}pi(e,n){return e.filter(r=>this.yi(r.updateTimeMs,n)&&!this.Ti(r.clientId))}bi(){return this.runTransaction("getActiveClients","readonly",e=>dd(e).j().next(n=>this.pi(n,18e5).map(r=>r.clientId)))}get started(){return this.Ss}getMutationQueue(e,n){return ud.ie(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ds}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new bq(e,this.serializer.se.databaseId)}getDocumentOverlayCache(e){return rd.ie(this.serializer,e)}getBundleCache(){return this.xs}runTransaction(e,n,r){b("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===n?"readonly":"readwrite",s=15===(o=this.Ys)?SG:14===o?oT:13===o?sT:12===o?IG:11===o?iT:void F();var o;let a;return this.ii.runTransaction(e,i,s,u=>(a=new mm(u,this.Vs?this.Vs.next():en.ct),"readwrite-primary"===n?this.li(a).next(c=>!!c||this.fi(a)).next(c=>{if(!c)throw je(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ws.enqueueRetryable(()=>this.ni(!1)),new E(v.FAILED_PRECONDITION,ZS);return r(a)}).next(c=>this.wi(a).next(()=>c)):this.Pi(a).next(()=>r(a)))).then(u=>(a.raiseOnCommittedEvent(),u))}Pi(e){return au(e).get("owner").next(n=>{if(null!==n&&this.yi(n.leaseTimestampMs,5e3)&&!this.Ti(n.ownerId)&&!this._i(n)&&!(this.Js||this.allowTabSynchronization&&n.allowTabSynchronization))throw new E(v.FAILED_PRECONDITION,zm)})}wi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return au(e).put("owner",n)}static D(){return Dn.D()}di(e){const n=au(e);return n.get("owner").next(r=>this._i(r)?(b("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):y.resolve())}yi(e,n){const r=Date.now();return!(e<r-n||e>r&&(je(`Detected an update time that is in the future: ${e} > ${r}`),1))}ui(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Xs=()=>{this.Ws.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.oi()))},this.document.addEventListener("visibilitychange",this.Xs),this.inForeground="visible"===this.document.visibilityState)}Ai(){this.Xs&&(this.document.removeEventListener("visibilitychange",this.Xs),this.Xs=null)}ci(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=()=>{this.Ei();const n=/(?:Version|Mobile)\/1[456]/;(function pU(){return!function hU(){var t;const e=null===(t=al())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")})()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Ws.enterRestrictedMode(!0),this.Ws.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}Ri(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ti(e){var n;try{const r=null!==(null===(n=this.ri)||void 0===n?void 0:n.getItem(this.Ii(e)));return b("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return je("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ei(){if(this.ri)try{this.ri.setItem(this.Ii(this.clientId),String(Date.now()))}catch(e){je("Failed to set zombie client id.",e)}}vi(){if(this.ri)try{this.ri.removeItem(this.Ii(this.clientId))}catch{}}Ii(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function au(t){return nt(t,"owner")}function dd(t){return nt(t,"clientMetadata")}function Km(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class Qm{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Vi=r,this.Si=i}static Di(e,n){let r=Y(),i=Y();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Qm(e,n.fromCache,r,i)}}class $A{constructor(){this.Ci=!1}initialize(e,n){this.xi=e,this.indexManager=n,this.Ci=!0}getDocumentsMatchingQuery(e,n,r,i){return this.Ni(e,n).next(s=>s||this.ki(e,n,i,r)).next(s=>s||this.Oi(e,n))}Ni(e,n){if(xT(n))return y.resolve(null);let r=Nt(n);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==n.limit&&1===i&&(n=Ql(n,null,"F"),r=Nt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Y(...s);return this.xi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.$i(n,a);return this.Mi(n,c,o,u.readTime)?this.Ni(e,Ql(n,null,"F")):this.Fi(e,c,n,u)}))})))}ki(e,n,r,i){return xT(n)||i.isEqual(k.min())?this.Oi(e,n):this.xi.getDocuments(e,r).next(s=>{const o=this.$i(n,s);return this.Mi(n,o,r,i)?this.Oi(e,n):(lm()<=oe.DEBUG&&b("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Tm(n)),this.Fi(e,o,n,QS(i,-1)))})}$i(e,n){let r=new pe(OT(e));return n.forEach((i,s)=>{qa(e,s)&&(r=r.add(s))}),r}Mi(e,n,r,i){if(null===e.limit)return!1;if(r.size!==n.size)return!0;const s="F"===e.limitType?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Oi(e,n){return lm()<=oe.DEBUG&&b("QueryEngine","Using full collection scan to execute query:",Tm(n)),this.xi.getDocumentsMatchingQuery(e,n,Jt.min())}Fi(e,n,r,i){return this.xi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}class Uq{constructor(e,n,r,i){this.persistence=e,this.Bi=n,this.serializer=i,this.Li=new Re(q),this.qi=new Lr(s=>Ni(s),Ha),this.Ui=new Map,this.Ki=e.getRemoteDocumentCache(),this.Ds=e.getTargetCache(),this.xs=e.getBundleCache(),this.Gi(r)}Gi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new BA(this.Ki,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ki.setIndexManager(this.indexManager),this.Bi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Li))}}function HA(t,e,n,r){return new Uq(t,e,n,r)}function GA(t,e){return Ym.apply(this,arguments)}function Ym(){return Ym=D(function*(t,e){const n=A(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Gi(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let u=Y();for(const c of i){o.push(c.batchId);for(const l of c.mutations)u=u.add(l.key)}for(const c of s){a.push(c.batchId);for(const l of c.mutations)u=u.add(l.key)}return n.localDocuments.getDocuments(r,u).next(c=>({Qi:c,removedBatchIds:o,addedBatchIds:a}))})})}),Ym.apply(this,arguments)}function qA(t){const e=A(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ds.getLastRemoteSnapshotVersion(n))}function zA(t,e,n){let r=Y(),i=Y();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=$t();return n.forEach((a,u)=>{const c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(k.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||0===u.version.compareTo(c.version)&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):b("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{zi:o,ji:i}})}function Gq(t,e){const n=A(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ro(t,e){const n=A(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ds.getTargetData(r,e).next(s=>s?(i=s,y.resolve(i)):n.Ds.allocateTargetId(r).next(o=>(i=new Br(e,o,0,r.currentSequenceNumber),n.Ds.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Li.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Li=n.Li.insert(r.targetId,r),n.qi.set(e,r.targetId)),r})}function io(t,e,n){return Zm.apply(this,arguments)}function Zm(){return Zm=D(function*(t,e,n){const r=A(t),i=r.Li.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Nr(o))throw o;b("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Li=r.Li.remove(e),r.qi.delete(i.target)}),Zm.apply(this,arguments)}function hd(t,e,n){const r=A(t);let i=k.min(),s=Y();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,u,c){const l=A(a),d=l.qi.get(c);return void 0!==d?y.resolve(l.Li.get(d)):l.Ds.getTargetData(u,c)}(r,o,Nt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ds.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.Bi.getDocumentsMatchingQuery(o,e,n?i:k.min(),n?s:Y())).next(a=>(QA(r,FT(e),a),{documents:a,Wi:s})))}function WA(t,e){const n=A(t),r=A(n.Ds),i=n.Li.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ne(s,e).next(o=>o?o.target:null))}function KA(t,e){const n=A(t),r=n.Ui.get(e)||k.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.Ki.getAllFromCollectionGroup(i,e,QS(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(QA(n,e,i),i))}function QA(t,e,n){let r=t.Ui.get(e)||k.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Ui.set(e,r)}function Xm(){return Xm=D(function*(t,e,n,r){const i=A(t);let s=Y(),o=$t();for(const c of n){const l=e.Hi(c.metadata.name);c.document&&(s=s.add(l));const d=e.Ji(c);d.setReadTime(e.Yi(c.metadata.readTime)),o=o.insert(l,d)}const a=i.Ki.newChangeBuffer({trackRemovals:!0}),u=yield ro(i,(c=r,Nt(Ks(ie.fromString(`__bundle__/docs/${c}`)))));var c;return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>zA(c,a,o).next(l=>(a.apply(c),l)).next(l=>i.Ds.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.Ds.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,l.zi,l.ji)).next(()=>l.zi)))}),Xm.apply(this,arguments)}function zq(t,e){return Jm.apply(this,arguments)}function Jm(){return Jm=D(function*(t,e,n=Y()){const r=yield ro(t,Nt(Vm(e.bundledQuery))),i=A(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=Ue(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.xs.saveNamedQuery(s,e);const a=r.withResumeToken(Je.EMPTY_BYTE_STRING,o);return i.Li=i.Li.insert(a.targetId,a),i.Ds.updateTargetData(s,a).next(()=>i.Ds.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Ds.addMatchingKeys(s,n,r.targetId)).next(()=>i.xs.saveNamedQuery(s,e))})}),Jm.apply(this,arguments)}function YA(t,e){return`firestore_clients_${t}_${e}`}function ZA(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function ey(t,e){return`firestore_targets_${t}_${e}`}class fd{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Zi(e,n,r){const i=JSON.parse(r);let s,o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code,o&&(s=new E(i.error.code,i.error.message))),o?new fd(e,n,i.state,s):(je("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Xi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class uu{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Zi(e,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new E(r.error.code,r.error.message))),s?new uu(e,r.state,i):(je("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Xi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pd{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Zi(e,n){const r=JSON.parse(n);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=Yl();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=eT(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new pd(e,s):(je("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class ty{constructor(e,n){this.clientId=e,this.onlineState=n}static Zi(e){const n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new ty(n.clientId,n.onlineState):(je("SharedClientState",`Failed to parse online state: ${e}`),null)}}class ny{constructor(){this.activeTargetIds=Yl()}tr(e){this.activeTargetIds=this.activeTargetIds.add(e)}er(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Xi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ry{constructor(e,n,r,i,s){this.window=e,this.Ws=n,this.persistenceKey=r,this.nr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.sr=this.ir.bind(this),this.rr=new Re(q),this.started=!1,this.ur=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.cr=YA(this.persistenceKey,this.nr),this.ar=`firestore_sequence_number_${this.persistenceKey}`,this.rr=this.rr.insert(this.nr,new ny),this.hr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.lr=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.dr=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.wr=`firestore_online_state_${this.persistenceKey}`,this._r=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.sr)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return D(function*(){const n=yield e.syncEngine.bi();for(const i of n){if(i===e.nr)continue;const s=e.getItem(YA(e.persistenceKey,i));if(s){const o=pd.Zi(i,s);o&&(e.rr=e.rr.insert(o.clientId,o))}}e.mr();const r=e.storage.getItem(e.wr);if(r){const i=e.gr(r);i&&e.yr(i)}for(const i of e.ur)e.ir(i);e.ur=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ar,JSON.stringify(e))}getAllActiveQueryTargets(){return this.pr(this.rr)}isActiveQueryTarget(e){let n=!1;return this.rr.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ir(e,"pending")}updateMutationState(e,n,r){this.Ir(e,n,r),this.Tr(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(ey(this.persistenceKey,e));if(r){const i=uu.Zi(e,r);i&&(n=i.state)}}return this.Er.tr(e),this.mr(),n}removeLocalQueryTarget(e){this.Er.er(e),this.mr()}isLocalQueryTarget(e){return this.Er.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(ey(this.persistenceKey,e))}updateQueryState(e,n,r){this.Ar(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Tr(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Rr(e)}notifyBundleLoaded(e){this.vr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.sr),this.removeItem(this.cr),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return b("SharedClientState","READ",e,n),n}setItem(e,n){b("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){b("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ir(e){var n=this;const r=e;if(r.storageArea===this.storage){if(b("SharedClientState","EVENT",r.key,r.newValue),r.key===this.cr)return void je("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ws.enqueueRetryable(D(function*(){if(n.started){if(null!==r.key)if(n.hr.test(r.key)){if(null==r.newValue){const i=n.br(r.key);return n.Pr(i,null)}{const i=n.Vr(r.key,r.newValue);if(i)return n.Pr(i.clientId,i)}}else if(n.lr.test(r.key)){if(null!==r.newValue){const i=n.Sr(r.key,r.newValue);if(i)return n.Dr(i)}}else if(n.dr.test(r.key)){if(null!==r.newValue){const i=n.Cr(r.key,r.newValue);if(i)return n.Nr(i)}}else if(r.key===n.wr){if(null!==r.newValue){const i=n.gr(r.newValue);if(i)return n.yr(i)}}else if(r.key===n.ar){const i=function(s){let o=en.ct;if(null!=s)try{const a=JSON.parse(s);R("number"==typeof a),o=a}catch(a){je("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(r.newValue);i!==en.ct&&n.sequenceNumberHandler(i)}else if(r.key===n._r){const i=n.kr(r.newValue);yield Promise.all(i.map(s=>n.syncEngine.Or(s)))}}else n.ur.push(r)}))}}get Er(){return this.rr.get(this.nr)}mr(){this.setItem(this.cr,this.Er.Xi())}Ir(e,n,r){const i=new fd(this.currentUser,e,n,r),s=ZA(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Xi())}Tr(e){const n=ZA(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Rr(e){this.storage.setItem(this.wr,JSON.stringify({clientId:this.nr,onlineState:e}))}Ar(e,n,r){const i=ey(this.persistenceKey,e),s=new uu(e,n,r);this.setItem(i,s.Xi())}vr(e){const n=JSON.stringify(Array.from(e));this.setItem(this._r,n)}br(e){const n=this.hr.exec(e);return n?n[1]:null}Vr(e,n){const r=this.br(e);return pd.Zi(r,n)}Sr(e,n){const r=this.lr.exec(e),i=Number(r[1]);return fd.Zi(new tt(void 0!==r[2]?r[2]:null),i,n)}Cr(e,n){const r=this.dr.exec(e),i=Number(r[1]);return uu.Zi(i,n)}gr(e){return ty.Zi(e)}kr(e){return JSON.parse(e)}Dr(e){var n=this;return D(function*(){if(e.user.uid===n.currentUser.uid)return n.syncEngine.$r(e.batchId,e.state,e.error);b("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Nr(e){return this.syncEngine.Mr(e.targetId,e.state,e.error)}Pr(e,n){const r=n?this.rr.insert(e,n):this.rr.remove(e),i=this.pr(this.rr),s=this.pr(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.Fr(o,a).then(()=>{this.rr=r})}yr(e){this.rr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}pr(e){let n=Yl();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class XA{constructor(){this.Br=new ny,this.Lr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Br.tr(e),this.Lr[e]||"not-current"}updateQueryState(e,n,r){this.Lr[e]=n}removeLocalQueryTarget(e){this.Br.er(e)}isLocalQueryTarget(e){return this.Br.activeTargetIds.has(e)}clearQueryState(e){delete this.Lr[e]}getAllActiveQueryTargets(){return this.Br.activeTargetIds}isActiveQueryTarget(e){return this.Br.activeTargetIds.has(e)}start(){return this.Br=new ny,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Wq{qr(e){}shutdown(){}}class JA{constructor(){this.Ur=()=>this.Kr(),this.Gr=()=>this.Qr(),this.zr=[],this.jr()}qr(e){this.zr.push(e)}shutdown(){window.removeEventListener("online",this.Ur),window.removeEventListener("offline",this.Gr)}jr(){window.addEventListener("online",this.Ur),window.addEventListener("offline",this.Gr)}Kr(){b("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.zr)e(0)}Qr(){b("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.zr)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let gd=null;function iy(){return null===gd?gd=268435456+Math.round(2147483648*Math.random()):gd++,"0x"+gd.toString(16)}const Kq={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Qq{constructor(e){this.Wr=e.Wr,this.Hr=e.Hr}Jr(e){this.Yr=e}Zr(e){this.Xr=e}onMessage(e){this.eo=e}close(){this.Hr()}send(e){this.Wr(e)}no(){this.Yr()}so(e){this.Xr(e)}io(e){this.eo(e)}}const wt="WebChannelConnection";class Yq extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.ro=(e.ssl?"https":"http")+"://"+e.host,this.oo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get uo(){return!1}co(e,n,r,i,s){const o=iy(),a=this.ao(e,n);b("RestConnection",`Sending RPC '${e}' ${o}:`,a,r);const u={};return this.ho(u,i,s),this.lo(e,a,u,r).then(c=>(b("RestConnection",`Received RPC '${e}' ${o}: `,c),c),c=>{throw On("RestConnection",`RPC '${e}' ${o} failed with error: `,c,"url: ",a,"request:",r),c})}fo(e,n,r,i,s,o){return this.co(e,n,r,i,s)}ho(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+$s,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}ao(e,n){return`${this.ro}/v1/${n}:${Kq[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}lo(e,n,r,i){const s=iy();return new Promise((o,a)=>{const u=new zH;u.setWithCredentials(!0),u.listenOnce(HH.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case cm.NO_ERROR:const l=u.getResponseJson();b(wt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case cm.TIMEOUT:b(wt,`RPC '${e}' ${s} timed out`),a(new E(v.DEADLINE_EXCEEDED,"Request time out"));break;case cm.HTTP_ERROR:const d=u.getStatus();if(b(wt,`RPC '${e}' ${s} failed with status:`,d,"response text:",u.getResponseText()),d>0){let h=u.getResponseJson();Array.isArray(h)&&(h=h[0]);const f=h?.error;if(f&&f.status&&f.message){const p=function(g){const m=g.toLowerCase().replace(/_/g,"-");return Object.values(v).indexOf(m)>=0?m:v.UNKNOWN}(f.status);a(new E(p,f.message))}else a(new E(v.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new E(v.UNAVAILABLE,"Connection failed."));break;default:F()}}finally{b(wt,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);b(wt,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}wo(e,n,r){const i=iy(),s=[this.ro,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=UH(),a=$H(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(u.xmlHttpFactory=new qH({})),this.ho(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const c=s.join("");b(wt,`Creating RPC '${e}' stream ${i}: ${c}`,u);const l=o.createWebChannel(c,u);let d=!1,h=!1;const f=new Qq({Wr:g=>{h?b(wt,`Not sending because RPC '${e}' stream ${i} is closed:`,g):(d||(b(wt,`Opening RPC '${e}' stream ${i} transport.`),l.open(),d=!0),b(wt,`RPC '${e}' stream ${i} sending:`,g),l.send(g))},Hr:()=>l.close()}),p=(g,m,w)=>{g.listen(m,I=>{try{w(I)}catch(_){setTimeout(()=>{throw _},0)}})};return p(l,Vl.EventType.OPEN,()=>{h||b(wt,`RPC '${e}' stream ${i} transport opened.`)}),p(l,Vl.EventType.CLOSE,()=>{h||(h=!0,b(wt,`RPC '${e}' stream ${i} transport closed`),f.so())}),p(l,Vl.EventType.ERROR,g=>{h||(h=!0,On(wt,`RPC '${e}' stream ${i} transport errored:`,g),f.so(new E(v.UNAVAILABLE,"The operation could not be completed")))}),p(l,Vl.EventType.MESSAGE,g=>{var m;if(!h){const w=g.data[0];R(!!w);const _=w.error||(null===(m=w[0])||void 0===m?void 0:m.error);if(_){b(wt,`RPC '${e}' stream ${i} received error:`,_);const O=_.status;let j=function(Gt){const Xr=Ke[Gt];if(void 0!==Xr)return ZT(Xr)}(O),H=_.message;void 0===j&&(j=v.INTERNAL,H="Unknown error status: "+O+" with message "+_.message),h=!0,f.so(new E(j,H)),l.close()}else b(wt,`RPC '${e}' stream ${i} received:`,w),f.io(w)}}),p(a,GH.STAT_EVENT,g=>{g.stat===HS.PROXY?b(wt,`RPC '${e}' stream ${i} detected buffering proxy`):g.stat===HS.NOPROXY&&b(wt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{f.no()},0),f}}function eM(){return typeof window<"u"?window:null}function md(){return typeof document<"u"?document:null}function cu(t){return new sq(t,!0)}class sy{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Ws=e,this.timerId=n,this._o=r,this.mo=i,this.yo=s,this.po=0,this.Io=null,this.To=Date.now(),this.reset()}reset(){this.po=0}Eo(){this.po=this.yo}Ao(e){this.cancel();const n=Math.floor(this.po+this.Ro()),r=Math.max(0,Date.now()-this.To),i=Math.max(0,n-r);i>0&&b("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.po} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Io=this.Ws.enqueueAfterDelay(this.timerId,i,()=>(this.To=Date.now(),e())),this.po*=this.mo,this.po<this._o&&(this.po=this._o),this.po>this.yo&&(this.po=this.yo)}vo(){null!==this.Io&&(this.Io.skipDelay(),this.Io=null)}cancel(){null!==this.Io&&(this.Io.cancel(),this.Io=null)}Ro(){return(Math.random()-.5)*this.po}}class tM{constructor(e,n,r,i,s,o,a,u){this.Ws=e,this.bo=r,this.Po=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Vo=0,this.So=null,this.Do=null,this.stream=null,this.Co=new sy(e,n)}xo(){return 1===this.state||5===this.state||this.No()}No(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.ko()}stop(){var e=this;return D(function*(){e.xo()&&(yield e.close(0))})()}Oo(){this.state=0,this.Co.reset()}$o(){this.No()&&null===this.So&&(this.So=this.Ws.enqueueAfterDelay(this.bo,6e4,()=>this.Mo()))}Fo(e){this.Bo(),this.stream.send(e)}Mo(){var e=this;return D(function*(){if(e.No())return e.close(0)})()}Bo(){this.So&&(this.So.cancel(),this.So=null)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}close(e,n){var r=this;return D(function*(){r.Bo(),r.Lo(),r.Co.cancel(),r.Vo++,4!==e?r.Co.reset():n&&n.code===v.RESOURCE_EXHAUSTED?(je(n.toString()),je("Using maximum backoff delay to prevent overloading the backend."),r.Co.Eo()):n&&n.code===v.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Zr(n)})()}qo(){}auth(){this.state=1;const e=this.Uo(this.Vo),n=this.Vo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Vo===n&&this.Ko(r,i)},r=>{e(()=>{const i=new E(v.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Go(i)})})}Ko(e,n){const r=this.Uo(this.Vo);this.stream=this.Qo(e,n),this.stream.Jr(()=>{r(()=>(this.state=2,this.Do=this.Ws.enqueueAfterDelay(this.Po,1e4,()=>(this.No()&&(this.state=3),Promise.resolve())),this.listener.Jr()))}),this.stream.Zr(i=>{r(()=>this.Go(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}ko(){var e=this;this.state=5,this.Co.Ao(D(function*(){e.state=0,e.start()}))}Go(e){return b("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Uo(e){return n=>{this.Ws.enqueueAndForget(()=>this.Vo===e?n():(b("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Zq extends tM{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}Qo(e,n){return this.connection.wo("Listen",e,n)}onMessage(e){this.Co.reset();const n=function uq(t,e){let n;if("targetChange"in e){const r="NO_CHANGE"===(u=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:F(),i=e.targetChange.targetIds||[],s=function(u,c){return u.useProto3Json?(R(void 0===c||"string"==typeof c),Je.fromBase64String(c||"")):(R(void 0===c||c instanceof Uint8Array),Je.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const c=void 0===u.code?v.UNKNOWN:ZT(u.code);return new E(c,u.message||"")}(o);n=new JT(r,i,s,a||null)}else if("documentChange"in e){const r=e.documentChange,i=Ln(t,r.document.name),s=Ue(r.document.updateTime),o=r.document.createTime?Ue(r.document.createTime):k.min(),a=new rt({mapValue:{fields:r.document.fields}}),u=Ee.newFoundDocument(i,s,o,a);n=new td(r.targetIds||[],r.removedTargetIds||[],u.key,u)}else if("documentDelete"in e){const r=e.documentDelete,i=Ln(t,r.document),s=r.readTime?Ue(r.readTime):k.min(),o=Ee.newNoDocument(i,s);n=new td([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const r=e.documentRemove,i=Ln(t,r.document);n=new td([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return F();{const r=e.filter,s=new eq(r.count||0);n=new XT(r.targetId,s)}}var u;return n}(this.serializer,e),r=function(i){if(!("targetChange"in i))return k.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?k.min():s.readTime?Ue(s.readTime):k.min()}(e);return this.listener.zo(n,r)}jo(e){const n={};n.database=Ja(this.serializer),n.addTarget=function(i,s){let o;const a=s.target;return o=zl(a)?{documents:cA(i,a)}:{query:Lm(i,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0?o.resumeToken=rA(i,s.resumeToken):s.snapshotVersion.compareTo(k.min())>0&&(o.readTime=Js(i,s.snapshotVersion.toTimestamp())),o}(this.serializer,e);const r=function lq(t,e){const n=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return F()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);r&&(n.labels=r),this.Fo(n)}Wo(e){const n={};n.database=Ja(this.serializer),n.removeTarget=e,this.Fo(n)}}class Xq extends tM{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.Ho=!1}get Jo(){return this.Ho}start(){this.Ho=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Ho&&this.Yo([])}Qo(e,n){return this.connection.wo("Write",e,n)}onMessage(e){if(R(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Ho){this.Co.reset();const n=function cq(t,e){return t&&t.length>0?(R(void 0!==e),t.map(n=>function(r,i){let s=Ue(r.updateTime?r.updateTime:i);return s.isEqual(k.min())&&(s=Ue(i)),new QG(s,r.transformResults||[])}(n,e))):[]}(e.writeResults,e.commitTime),r=Ue(e.commitTime);return this.listener.Zo(r,n)}return R(!e.writeResults||0===e.writeResults.length),this.Ho=!0,this.listener.Xo()}tu(){const e={};e.database=Ja(this.serializer),this.Fo(e)}Yo(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>eu(this.serializer,r))};this.Fo(n)}}class Jq extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.eu=!1}nu(){if(this.eu)throw new E(v.FAILED_PRECONDITION,"The client has already been terminated.")}co(e,n,r){return this.nu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.co(e,n,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===v.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new E(v.UNKNOWN,i.toString())})}fo(e,n,r,i){return this.nu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.fo(e,n,r,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===v.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new E(v.UNKNOWN,s.toString())})}terminate(){this.eu=!0}}class tz{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.su=0,this.iu=null,this.ru=!0}ou(){0===this.su&&(this.uu("Unknown"),this.iu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.iu=null,this.cu("Backend didn't respond within 10 seconds."),this.uu("Offline"),Promise.resolve())))}au(e){"Online"===this.state?this.uu("Unknown"):(this.su++,this.su>=1&&(this.hu(),this.cu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.uu("Offline")))}set(e){this.hu(),this.su=0,"Online"===e&&(this.ru=!1),this.uu(e)}uu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}cu(e){const n=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ru?(je(n),this.ru=!1):b("OnlineStateTracker",n)}hu(){null!==this.iu&&(this.iu.cancel(),this.iu=null)}}class nz{constructor(e,n,r,i,s){var o=this;this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.lu=[],this.fu=new Map,this.du=new Set,this.wu=[],this._u=s,this._u.qr(a=>{r.enqueueAndForget(D(function*(){var u;Hr(o)&&(b("RemoteStore","Restarting streams for network reachability change."),yield(u=D(function*(c){const l=A(c);l.du.add(4),yield so(l),l.mu.set("Unknown"),l.du.delete(4),yield lu(l)}),function(c){return u.apply(this,arguments)})(o))}))}),this.mu=new tz(r,i)}}function lu(t){return ay.apply(this,arguments)}function ay(){return ay=D(function*(t){if(Hr(t))for(const e of t.wu)yield e(!0)}),ay.apply(this,arguments)}function so(t){return uy.apply(this,arguments)}function uy(){return uy=D(function*(t){for(const e of t.wu)yield e(!1)}),uy.apply(this,arguments)}function yd(t,e){const n=A(t);n.fu.has(e.targetId)||(n.fu.set(e.targetId,e),dy(n)?ly(n):ao(n).No()&&cy(n,e))}function du(t,e){const n=A(t),r=ao(n);n.fu.delete(e),r.No()&&nM(n,e),0===n.fu.size&&(r.No()?r.$o():Hr(n)&&n.mu.set("Unknown"))}function cy(t,e){t.gu.Ot(e.targetId),ao(t).jo(e)}function nM(t,e){t.gu.Ot(e),ao(t).Wo(e)}function ly(t){t.gu=new tq({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ne:e=>t.fu.get(e)||null}),ao(t).start(),t.mu.ou()}function dy(t){return Hr(t)&&!ao(t).xo()&&t.fu.size>0}function Hr(t){return 0===A(t).du.size}function rM(t){t.gu=void 0}function rz(t){return hy.apply(this,arguments)}function hy(){return hy=D(function*(t){t.fu.forEach((e,n)=>{cy(t,e)})}),hy.apply(this,arguments)}function iz(t,e){return fy.apply(this,arguments)}function fy(){return fy=D(function*(t,e){rM(t),dy(t)?(t.mu.au(e),ly(t)):t.mu.set("Unknown")}),fy.apply(this,arguments)}function sz(t,e,n){return py.apply(this,arguments)}function py(){return py=D(function*(t,e,n){if(t.mu.set("Online"),e instanceof JT&&2===e.state&&e.cause)try{yield(r=D(function*(i,s){const o=s.cause;for(const a of s.targetIds)i.fu.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.fu.delete(a),i.gu.removeTarget(a))}),function(i,s){return r.apply(this,arguments)})(t,e)}catch(r){b("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield vd(t,r)}else if(e instanceof td?t.gu.Kt(e):e instanceof XT?t.gu.Jt(e):t.gu.zt(e),!n.isEqual(k.min()))try{const r=yield qA(t.localStore);n.compareTo(r)>=0&&(yield function(i,s){const o=i.gu.Xt(s);return o.targetChanges.forEach((a,u)=>{if(a.resumeToken.approximateByteSize()>0){const c=i.fu.get(u);c&&i.fu.set(u,c.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach(a=>{const u=i.fu.get(a);if(!u)return;i.fu.set(a,u.withResumeToken(Je.EMPTY_BYTE_STRING,u.snapshotVersion)),nM(i,a);const c=new Br(u.target,a,1,u.sequenceNumber);cy(i,c)}),i.remoteSyncer.applyRemoteEvent(o)}(t,n))}catch(r){b("RemoteStore","Failed to raise snapshot:",r),yield vd(t,r)}var r}),py.apply(this,arguments)}function vd(t,e,n){return gy.apply(this,arguments)}function gy(){return gy=D(function*(t,e,n){if(!Nr(e))throw e;t.du.add(1),yield so(t),t.mu.set("Offline"),n||(n=()=>qA(t.localStore)),t.asyncQueue.enqueueRetryable(D(function*(){b("RemoteStore","Retrying IndexedDB access"),yield n(),t.du.delete(1),yield lu(t)}))}),gy.apply(this,arguments)}function iM(t,e){return e().catch(n=>vd(t,n,e))}function oo(t){return my.apply(this,arguments)}function my(){return my=D(function*(t){const e=A(t),n=Gr(e);let r=e.lu.length>0?e.lu[e.lu.length-1].batchId:-1;for(;oz(e);)try{const i=yield Gq(e.localStore,r);if(null===i){0===e.lu.length&&n.$o();break}r=i.batchId,az(e,i)}catch(i){yield vd(e,i)}sM(e)&&oM(e)}),my.apply(this,arguments)}function oz(t){return Hr(t)&&t.lu.length<10}function az(t,e){t.lu.push(e);const n=Gr(t);n.No()&&n.Jo&&n.Yo(e.mutations)}function sM(t){return Hr(t)&&!Gr(t).xo()&&t.lu.length>0}function oM(t){Gr(t).start()}function uz(t){return yy.apply(this,arguments)}function yy(){return yy=D(function*(t){Gr(t).tu()}),yy.apply(this,arguments)}function cz(t){return vy.apply(this,arguments)}function vy(){return vy=D(function*(t){const e=Gr(t);for(const n of t.lu)e.Yo(n.mutations)}),vy.apply(this,arguments)}function lz(t,e,n){return _y.apply(this,arguments)}function _y(){return _y=D(function*(t,e,n){const r=t.lu.shift(),i=xm.from(r,e,n);yield iM(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield oo(t)}),_y.apply(this,arguments)}function dz(t,e){return Dy.apply(this,arguments)}function Dy(){return Dy=D(function*(t,e){var n;e&&Gr(t).Jo&&(yield(n=D(function*(r,i){if(YT(s=i.code)&&s!==v.ABORTED){const o=r.lu.shift();Gr(r).Oo(),yield iM(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield oo(r)}var s}),function(r,i){return n.apply(this,arguments)})(t,e)),sM(t)&&oM(t)}),Dy.apply(this,arguments)}function aM(t,e){return wy.apply(this,arguments)}function wy(){return wy=D(function*(t,e){const n=A(t);n.asyncQueue.verifyOperationInProgress(),b("RemoteStore","RemoteStore received new credentials");const r=Hr(n);n.du.add(3),yield so(n),r&&n.mu.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.du.delete(3),yield lu(n)}),wy.apply(this,arguments)}function Ey(t,e){return Cy.apply(this,arguments)}function Cy(){return Cy=D(function*(t,e){const n=A(t);e?(n.du.delete(2),yield lu(n)):e||(n.du.add(2),yield so(n),n.mu.set("Unknown"))}),Cy.apply(this,arguments)}function ao(t){return t.yu||(t.yu=function(e,n,r){const i=A(e);return i.nu(),new Zq(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Jr:rz.bind(null,t),Zr:iz.bind(null,t),zo:sz.bind(null,t)}),t.wu.push(function(){var e=D(function*(n){n?(t.yu.Oo(),dy(t)?ly(t):t.mu.set("Unknown")):(yield t.yu.stop(),rM(t))});return function(n){return e.apply(this,arguments)}}())),t.yu}function Gr(t){return t.pu||(t.pu=function(e,n,r){const i=A(e);return i.nu(),new Xq(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Jr:uz.bind(null,t),Zr:dz.bind(null,t),Xo:cz.bind(null,t),Zo:lz.bind(null,t)}),t.wu.push(function(){var e=D(function*(n){n?(t.pu.Oo(),yield oo(t)):(yield t.pu.stop(),t.lu.length>0&&(b("RemoteStore",`Stopping write stream with ${t.lu.length} pending writes`),t.lu=[]))});return function(n){return e.apply(this,arguments)}}())),t.pu}class by{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Xe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new by(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new E(v.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uo(t,e){if(je("AsyncQueue",`${e}: ${t}`),Nr(t))return new E(v.UNAVAILABLE,`${e}: ${t}`);throw t}class co{constructor(e){this.comparator=e?(n,r)=>e(n,r)||T.comparator(n.key,r.key):(n,r)=>T.comparator(n.key,r.key),this.keyedMap=za(),this.sortedSet=new Re(this.comparator)}static emptySet(e){return new co(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof co)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,n){const r=new co;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class uM{constructor(){this.Iu=new Re(T.comparator)}track(e){const n=e.doc.key,r=this.Iu.get(n);r?0!==e.type&&3===r.type?this.Iu=this.Iu.insert(n,e):3===e.type&&1!==r.type?this.Iu=this.Iu.insert(n,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Iu=this.Iu.insert(n,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Iu=this.Iu.insert(n,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Iu=this.Iu.remove(n):1===e.type&&2===r.type?this.Iu=this.Iu.insert(n,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Iu=this.Iu.insert(n,{type:2,doc:e.doc}):F():this.Iu=this.Iu.insert(n,e)}Tu(){const e=[];return this.Iu.inorderTraversal((n,r)=>{e.push(r)}),e}}class lo{constructor(e,n,r,i,s,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new lo(e,n,co.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ga(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}class hz{constructor(){this.Eu=void 0,this.listeners=[]}}class fz{constructor(){this.queries=new Lr(e=>NT(e),Ga),this.onlineState="Unknown",this.Au=new Set}}function Iy(t,e){return Sy.apply(this,arguments)}function Sy(){return Sy=D(function*(t,e){const n=A(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new hz),i)try{s.Eu=yield n.onListen(r)}catch(o){const a=uo(o,`Initialization of query '${Tm(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Ru(n.onlineState),s.Eu&&e.vu(s.Eu)&&My(n)}),Sy.apply(this,arguments)}function Ty(t,e){return Ay.apply(this,arguments)}function Ay(){return Ay=D(function*(t,e){const n=A(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}),Ay.apply(this,arguments)}function pz(t,e){const n=A(t);let r=!1;for(const i of e){const o=n.queries.get(i.query);if(o){for(const a of o.listeners)a.vu(i)&&(r=!0);o.Eu=i}}r&&My(n)}function gz(t,e,n){const r=A(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function My(t){t.Au.forEach(e=>{e.next()})}class xy{constructor(e,n,r){this.query=e,this.bu=n,this.Pu=!1,this.Vu=null,this.onlineState="Unknown",this.options=r||{}}vu(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new lo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Pu?this.Su(e)&&(this.bu.next(e),n=!0):this.Du(e,this.onlineState)&&(this.Cu(e),n=!0),this.Vu=e,n}onError(e){this.bu.error(e)}Ru(e){this.onlineState=e;let n=!1;return this.Vu&&!this.Pu&&this.Du(this.Vu,e)&&(this.Cu(this.Vu),n=!0),n}Du(e,n){return!e.fromCache||(!this.options.xu||!("Offline"!==n))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===n)}Su(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Vu&&this.Vu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Cu(e){e=lo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Pu=!0,this.bu.next(e)}}class mz{constructor(e,n){this.Nu=e,this.byteLength=n}ku(){return"metadata"in this.Nu}}class cM{constructor(e){this.serializer=e}Hi(e){return Ln(this.serializer,e)}Ji(e){return e.metadata.exists?uA(this.serializer,e.document,!1):Ee.newNoDocument(this.Hi(e.metadata.name),this.Yi(e.metadata.readTime))}Yi(e){return Ue(e)}}class yz{constructor(e,n,r){this.Ou=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=lM(e)}$u(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Nu.namedQuery)this.queries.push(e.Nu.namedQuery);else if(e.Nu.documentMetadata){this.documents.push({metadata:e.Nu.documentMetadata}),e.Nu.documentMetadata.exists||++n;const r=ie.fromString(e.Nu.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Nu.document&&(this.documents[this.documents.length-1].document=e.Nu.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}Mu(e){const n=new Map,r=new cM(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.Hi(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||Y()).add(s);n.set(o,a)}}return n}complete(){var e=this;return D(function*(){const n=yield function qq(t,e,n,r){return Xm.apply(this,arguments)}(e.localStore,new cM(e.serializer),e.documents,e.Ou.id),r=e.Mu(e.documents);for(const i of e.queries)yield zq(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Fu:e.collectionGroups,Bu:n}})()}}function lM(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}class dM{constructor(e){this.key=e}}class hM{constructor(e){this.key=e}}class fM{constructor(e,n){this.query=e,this.Lu=n,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Uu=Y(),this.mutatedKeys=Y(),this.Ku=OT(e),this.Gu=new co(this.Ku)}get Qu(){return this.Lu}zu(e,n){const r=n?n.ju:new uM,i=n?n.Gu:this.Gu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{const h=i.get(l),f=qa(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let m=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),m=!0):this.Wu(h,f)||(r.track({type:2,doc:f}),m=!0,(u&&this.Ku(f,u)>0||c&&this.Ku(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),m=!0):h&&!f&&(r.track({type:1,doc:h}),m=!0,(u||c)&&(a=!0)),m&&(f?(o=o.add(f),s=g?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{Gu:o,ju:r,Mi:a,mutatedKeys:s}}Wu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const i=this.Gu;this.Gu=e.Gu,this.mutatedKeys=e.mutatedKeys;const s=e.ju.Tu();s.sort((c,l)=>function(d,h){const f=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return F()}};return f(d)-f(h)}(c.type,l.type)||this.Ku(c.doc,l.doc)),this.Hu(r);const o=n?this.Ju():[],a=0===this.Uu.size&&this.current?1:0,u=a!==this.qu;return this.qu=a,0!==s.length||u?{snapshot:new lo(this.query,e.Gu,i,s,e.mutatedKeys,0===a,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Yu:o}:{Yu:o}}Ru(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Gu:this.Gu,ju:new uM,mutatedKeys:this.mutatedKeys,Mi:!1},!1)):{Yu:[]}}Zu(e){return!this.Lu.has(e)&&!!this.Gu.has(e)&&!this.Gu.get(e).hasLocalMutations}Hu(e){e&&(e.addedDocuments.forEach(n=>this.Lu=this.Lu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Lu=this.Lu.delete(n)),this.current=e.current)}Ju(){if(!this.current)return[];const e=this.Uu;this.Uu=Y(),this.Gu.forEach(r=>{this.Zu(r.key)&&(this.Uu=this.Uu.add(r.key))});const n=[];return e.forEach(r=>{this.Uu.has(r)||n.push(new hM(r))}),this.Uu.forEach(r=>{e.has(r)||n.push(new dM(r))}),n}Xu(e){this.Lu=e.Wi,this.Uu=Y();const n=this.zu(e.documents);return this.applyChanges(n,!0)}tc(){return lo.fromInitialDocuments(this.query,this.Gu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class vz{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class _z{constructor(e){this.key=e,this.ec=!1}}class Dz{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.nc={},this.sc=new Lr(a=>NT(a),Ga),this.ic=new Map,this.rc=new Set,this.oc=new Re(T.comparator),this.uc=new Map,this.cc=new qm,this.ac={},this.hc=new Map,this.lc=ji.bn(),this.onlineState="Unknown",this.fc=void 0}get isPrimaryClient(){return!0===this.fc}}function wz(t,e){return Ny.apply(this,arguments)}function Ny(){return Ny=D(function*(t,e){const n=ev(t);let r,i;const s=n.sc.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.tc();else{const o=yield ro(n.localStore,Nt(e));n.isPrimaryClient&&yd(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield Fy(n,e,r,"current"===a,o.resumeToken)}return i}),Ny.apply(this,arguments)}function Fy(t,e,n,r,i){return Oy.apply(this,arguments)}function Oy(){return Oy=D(function*(t,e,n,r,i){t.dc=(d,h,f)=>{return(p=D(function*(g,m,w,I){let _=m.view.zu(w);_.Mi&&(_=yield hd(g.localStore,m.query,!1).then(({documents:H})=>m.view.zu(H,_)));const O=I&&I.targetChanges.get(m.targetId),j=m.view.applyChanges(_,g.isPrimaryClient,O);return Hy(g,m.targetId,j.Yu),j.snapshot}),function(g,m,w,I){return p.apply(this,arguments)})(t,d,h,f);var p};const s=yield hd(t.localStore,e,!0),o=new fM(e,s.Wi),a=o.zu(s.documents),u=Za.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState,i),c=o.applyChanges(a,t.isPrimaryClient,u);Hy(t,n,c.Yu);const l=new vz(e,n,o);return t.sc.set(e,l),t.ic.has(n)?t.ic.get(n).push(e):t.ic.set(n,[e]),c.snapshot}),Oy.apply(this,arguments)}function Ez(t,e){return Py.apply(this,arguments)}function Py(){return Py=D(function*(t,e){const n=A(t),r=n.sc.get(e),i=n.ic.get(r.targetId);if(i.length>1)return n.ic.set(r.targetId,i.filter(s=>!Ga(s,e))),void n.sc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield io(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),du(n.remoteStore,r.targetId),ho(n,r.targetId)}).catch(xr))):(ho(n,r.targetId),yield io(n.localStore,r.targetId,!0))}),Py.apply(this,arguments)}function Ry(){return Ry=D(function*(t,e,n){const r=tv(t);try{const i=yield function(s,o){const a=A(s),u=Te.now(),c=o.reduce((h,f)=>h.add(f.key),Y());let l,d;return a.persistence.runTransaction("Locally write mutations","readwrite",h=>{let f=$t(),p=Y();return a.Ki.getEntries(h,c).next(g=>{f=g,f.forEach((m,w)=>{w.isValidDocument()||(p=p.add(m))})}).next(()=>a.localDocuments.getOverlayedDocuments(h,f)).next(g=>{l=g;const m=[];for(const w of o){const I=ZG(w,l.get(w.key).overlayedDocument);null!=I&&m.push(new lr(w.key,I,yT(I.value.mapValue),Ae.exists(!0)))}return a.mutationQueue.addMutationBatch(h,u,m,o)}).next(g=>{d=g;const m=g.applyToLocalDocumentSet(l,p);return a.documentOverlayCache.saveOverlays(h,g.batchId,m)})}).then(()=>({batchId:d.batchId,changes:RT(l)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,o,a){let u=s.ac[s.currentUser.toKey()];u||(u=new Re(q)),u=u.insert(o,a),s.ac[s.currentUser.toKey()]=u}(r,i.batchId,n),yield dr(r,i.changes),yield oo(r.remoteStore)}catch(i){const s=uo(i,"Failed to persist write");n.reject(s)}}),Ry.apply(this,arguments)}function pM(t,e){return ky.apply(this,arguments)}function ky(){return ky=D(function*(t,e){const n=A(t);try{const r=yield function Hq(t,e){const n=A(t),r=e.snapshotVersion;let i=n.Li;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ki.newChangeBuffer({trackRemovals:!0});i=n.Li;const a=[];e.targetChanges.forEach((l,d)=>{const h=i.get(d);if(!h)return;a.push(n.Ds.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.Ds.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);var p,g,m;e.targetMismatches.has(d)?f=f.withResumeToken(Je.EMPTY_BYTE_STRING,k.min()).withLastLimboFreeSnapshotVersion(k.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),g=f,m=l,(0===(p=h).resumeToken.approximateByteSize()||g.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8||m.addedDocuments.size+m.modifiedDocuments.size+m.removedDocuments.size>0)&&a.push(n.Ds.updateTargetData(s,f))});let u=$t(),c=Y();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(zA(s,o,e.documentUpdates).next(l=>{u=l.zi,c=l.ji})),!r.isEqual(k.min())){const l=n.Ds.getLastRemoteSnapshotVersion(s).next(d=>n.Ds.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return y.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.Li=i,s))}(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.uc.get(s);o&&(R(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.ec=!0:i.modifiedDocuments.size>0?R(o.ec):i.removedDocuments.size>0&&(R(o.ec),o.ec=!1))}),yield dr(n,r,e)}catch(r){yield xr(r)}}),ky.apply(this,arguments)}function gM(t,e,n){const r=A(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const i=[];r.sc.forEach((s,o)=>{const a=o.view.Ru(e);a.snapshot&&i.push(a.snapshot)}),function(s,o){const a=A(s);a.onlineState=o;let u=!1;a.queries.forEach((c,l)=>{for(const d of l.listeners)d.Ru(o)&&(u=!0)}),u&&My(a)}(r.eventManager,e),i.length&&r.nc.zo(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function bz(t,e,n){return Ly.apply(this,arguments)}function Ly(){return Ly=D(function*(t,e,n){const r=A(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.uc.get(e),s=i&&i.key;if(s){let o=new Re(T.comparator);o=o.insert(s,Ee.newNoDocument(s,k.min()));const a=Y().add(s),u=new Ya(k.min(),new Map,new pe(q),o,a);yield pM(r,u),r.oc=r.oc.remove(s),r.uc.delete(e),Gy(r)}else yield io(r.localStore,e,!1).then(()=>ho(r,e,n)).catch(xr)}),Ly.apply(this,arguments)}function Iz(t,e){return Vy.apply(this,arguments)}function Vy(){return Vy=D(function*(t,e){const n=A(t),r=e.batch.batchId;try{const i=yield function $q(t,e){const n=A(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ki.newChangeBuffer({trackRemovals:!0});return function(o,a,u,c){const l=u.batch,d=l.keys();let h=y.resolve();return d.forEach(f=>{h=h.next(()=>c.getEntry(a,f)).next(p=>{const g=u.docVersions.get(f);R(null!==g),p.version.compareTo(g)<0&&(l.applyToRemoteDocument(p,u),p.isValidDocument()&&(p.setReadTime(u.commitVersion),c.addEntry(p)))})}),h.next(()=>o.mutationQueue.removeMutationBatch(a,l))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=Y();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(a=a.add(o.batch.mutations[u].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}(n.localStore,e);$y(n,r,null),Uy(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield dr(n,i)}catch(i){yield xr(i)}}),Vy.apply(this,arguments)}function Sz(t,e,n){return By.apply(this,arguments)}function By(){return By=D(function*(t,e,n){const r=A(t);try{const i=yield function(s,o){const a=A(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let c;return a.mutationQueue.lookupMutationBatch(u,o).next(l=>(R(null!==l),c=l.keys(),a.mutationQueue.removeMutationBatch(u,l))).next(()=>a.mutationQueue.performConsistencyCheck(u)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(u,c,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,c)).next(()=>a.localDocuments.getDocuments(u,c))})}(r.localStore,e);$y(r,e,n),Uy(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield dr(r,i)}catch(i){yield xr(i)}}),By.apply(this,arguments)}function jy(){return jy=D(function*(t,e){const n=A(t);Hr(n.remoteStore)||b("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(s){const o=A(s);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(-1===r)return void e.resolve();const i=n.hc.get(r)||[];i.push(e),n.hc.set(r,i)}catch(r){const i=uo(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),jy.apply(this,arguments)}function Uy(t,e){(t.hc.get(e)||[]).forEach(n=>{n.resolve()}),t.hc.delete(e)}function $y(t,e,n){const r=A(t);let i=r.ac[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.ac[r.currentUser.toKey()]=i}}function ho(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.ic.get(e))t.sc.delete(r),n&&t.nc.wc(r,n);t.ic.delete(e),t.isPrimaryClient&&t.cc.hs(e).forEach(r=>{t.cc.containsKey(r)||mM(t,r)})}function mM(t,e){t.rc.delete(e.path.canonicalString());const n=t.oc.get(e);null!==n&&(du(t.remoteStore,n),t.oc=t.oc.remove(e),t.uc.delete(n),Gy(t))}function Hy(t,e,n){for(const r of n)r instanceof dM?(t.cc.addReference(r.key,e),Az(t,r)):r instanceof hM?(b("SyncEngine","Document no longer in limbo: "+r.key),t.cc.removeReference(r.key,e),t.cc.containsKey(r.key)||mM(t,r.key)):F()}function Az(t,e){const n=e.key,r=n.path.canonicalString();t.oc.get(n)||t.rc.has(r)||(b("SyncEngine","New document in limbo: "+n),t.rc.add(r),Gy(t))}function Gy(t){for(;t.rc.size>0&&t.oc.size<t.maxConcurrentLimboResolutions;){const e=t.rc.values().next().value;t.rc.delete(e);const n=new T(ie.fromString(e)),r=t.lc.next();t.uc.set(r,new _z(n)),t.oc=t.oc.insert(n,r),yd(t.remoteStore,new Br(Nt(Ks(n.path)),r,2,en.ct))}}function dr(t,e,n){return qy.apply(this,arguments)}function qy(){return qy=D(function*(t,e,n){const r=A(t),i=[],s=[],o=[];var a;r.sc.isEmpty()||(r.sc.forEach((a,u)=>{o.push(r.dc(u,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c?.fromCache?"not-current":"current"),c){i.push(c);const l=Qm.Di(u.targetId,c);s.push(l)}}))}),yield Promise.all(o),r.nc.zo(i),yield(a=D(function*(u,c){const l=A(u);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>y.forEach(c,h=>y.forEach(h.Vi,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>y.forEach(h.Si,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Nr(d))throw d;b("LocalStore","Failed to update sequence numbers: "+d)}for(const d of c){const h=d.targetId;if(!d.fromCache){const f=l.Li.get(h),g=f.withLastLimboFreeSnapshotVersion(f.snapshotVersion);l.Li=l.Li.insert(h,g)}}}),function(u,c){return a.apply(this,arguments)})(r.localStore,s))}),qy.apply(this,arguments)}function Mz(t,e){return zy.apply(this,arguments)}function zy(){return zy=D(function*(t,e){const n=A(t);if(!n.currentUser.isEqual(e)){b("SyncEngine","User change. New user:",e.toKey());const r=yield GA(n.localStore,e);n.currentUser=e,(i=n).hc.forEach(o=>{o.forEach(a=>{a.reject(new E(v.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.hc.clear(),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield dr(n,r.Qi)}var i}),zy.apply(this,arguments)}function xz(t,e){const n=A(t),r=n.uc.get(e);if(r&&r.ec)return Y().add(r.key);{let i=Y();const s=n.ic.get(e);if(!s)return i;for(const o of s){const a=n.sc.get(o);i=i.unionWith(a.view.Qu)}return i}}function Nz(t,e){return Wy.apply(this,arguments)}function Wy(){return Wy=D(function*(t,e){const n=A(t),r=yield hd(n.localStore,e.query,!0),i=e.view.Xu(r);return n.isPrimaryClient&&Hy(n,e.targetId,i.Yu),i}),Wy.apply(this,arguments)}function Fz(t,e){return Ky.apply(this,arguments)}function Ky(){return Ky=D(function*(t,e){const n=A(t);return KA(n.localStore,e).then(r=>dr(n,r))}),Ky.apply(this,arguments)}function Oz(t,e,n,r){return Qy.apply(this,arguments)}function Qy(){return Qy=D(function*(t,e,n,r){const i=A(t),s=yield function(o,a){const u=A(o),c=A(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",l=>c.In(l,a).next(d=>d?u.localDocuments.getDocuments(l,d):y.resolve(null)))}(i.localStore,e);var a;null!==s?("pending"===n?yield oo(i.remoteStore):"acknowledged"===n||"rejected"===n?($y(i,e,r||null),Uy(i,e),a=e,A(A(i.localStore).mutationQueue).En(a)):F(),yield dr(i,s)):b("SyncEngine","Cannot apply mutation batch with id: "+e)}),Qy.apply(this,arguments)}function Yy(){return Yy=D(function*(t,e){const n=A(t);if(ev(n),tv(n),!0===e&&!0!==n.fc){const r=n.sharedClientState.getAllActiveQueryTargets(),i=yield yM(n,r.toArray());n.fc=!0,yield Ey(n.remoteStore,!0);for(const s of i)yd(n.remoteStore,s)}else if(!1===e&&!1!==n.fc){const r=[];let i=Promise.resolve();n.ic.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(ho(n,o),io(n.localStore,o,!0))),du(n.remoteStore,o)}),yield i,yield yM(n,r),function(s){const o=A(s);o.uc.forEach((a,u)=>{du(o.remoteStore,u)}),o.cc.ls(),o.uc=new Map,o.oc=new Re(T.comparator)}(n),n.fc=!1,yield Ey(n.remoteStore,!1)}}),Yy.apply(this,arguments)}function yM(t,e,n){return Zy.apply(this,arguments)}function Zy(){return Zy=D(function*(t,e,n){const r=A(t),i=[],s=[];for(const o of e){let a;const u=r.ic.get(o);if(u&&0!==u.length){a=yield ro(r.localStore,Nt(u[0]));for(const c of u){const l=r.sc.get(c),d=yield Nz(r,l);d.snapshot&&s.push(d.snapshot)}}else{const c=yield WA(r.localStore,o);a=yield ro(r.localStore,c),yield Fy(r,vM(c),o,!1,a.resumeToken)}i.push(a)}return r.nc.zo(s),i}),Zy.apply(this,arguments)}function vM(t){return MT(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Rz(t){const e=A(t);return A(A(e.localStore).persistence).bi()}function kz(t,e,n,r){return Xy.apply(this,arguments)}function Xy(){return Xy=D(function*(t,e,n,r){const i=A(t);if(i.fc)return void b("SyncEngine","Ignoring unexpected query state notification.");const s=i.ic.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=yield KA(i.localStore,FT(s[0])),a=Ya.createSynthesizedRemoteEventForCurrentChange(e,"current"===n,Je.EMPTY_BYTE_STRING);yield dr(i,o,a);break}case"rejected":yield io(i.localStore,e,!0),ho(i,e,r);break;default:F()}}),Xy.apply(this,arguments)}function Lz(t,e,n){return Jy.apply(this,arguments)}function Jy(){return Jy=D(function*(t,e,n){const r=ev(t);if(r.fc){for(const i of e){if(r.ic.has(i)){b("SyncEngine","Adding an already active target "+i);continue}const s=yield WA(r.localStore,i),o=yield ro(r.localStore,s);yield Fy(r,vM(s),o.targetId,!1,o.resumeToken),yd(r.remoteStore,o)}for(const i of n)r.ic.has(i)&&(yield io(r.localStore,i,!1).then(()=>{du(r.remoteStore,i),ho(r,i)}).catch(xr))}}),Jy.apply(this,arguments)}function ev(t){const e=A(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=pM.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=xz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=bz.bind(null,e),e.nc.zo=pz.bind(null,e.eventManager),e.nc.wc=gz.bind(null,e.eventManager),e}function tv(t){const e=A(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Iz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Sz.bind(null,e),e}class _d{constructor(){this.synchronizeTabs=!1}initialize(e){var n=this;return D(function*(){n.serializer=cu(e.databaseInfo.databaseId),n.sharedClientState=n.createSharedClientState(e),n.persistence=n.createPersistence(e),yield n.persistence.start(),n.localStore=n.createLocalStore(e),n.gcScheduler=n.createGarbageCollectionScheduler(e,n.localStore),n.indexBackfillerScheduler=n.createIndexBackfillerScheduler(e,n.localStore)})()}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return HA(this.persistence,new $A,e.initialUser,this.serializer)}createPersistence(e){return new jA(ld.Fs,this.serializer)}createSharedClientState(e){return new XA}terminate(){var e=this;return D(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class nv extends _d{constructor(e,n,r){super(),this.mc=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var n=()=>super.initialize,r=this;return D(function*(){yield n().call(r,e),yield r.mc.initialize(r,e),yield tv(r.mc.syncEngine),yield oo(r.mc.remoteStore),yield r.persistence.hi(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return HA(this.persistence,new $A,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){return new Tq(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new uG(n,this.persistence);return new aG(e.asyncQueue,r)}createPersistence(e){const n=Km(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Ht.withCacheSize(this.cacheSizeBytes):Ht.DEFAULT;return new Wm(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,eM(),md(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new XA}}class _M extends nv{constructor(e,n){super(e,n,!1),this.mc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){var n=()=>super.initialize,r=this;return D(function*(){yield n().call(r,e);const i=r.mc.syncEngine;r.sharedClientState instanceof ry&&(r.sharedClientState.syncEngine={$r:Oz.bind(null,i),Mr:kz.bind(null,i),Fr:Lz.bind(null,i),bi:Rz.bind(null,i),Or:Fz.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.hi(function(){var s=D(function*(o){yield function Pz(t,e){return Yy.apply(this,arguments)}(r.mc.syncEngine,o),r.gcScheduler&&(o&&!r.gcScheduler.started?r.gcScheduler.start():o||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(o&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():o||r.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const n=eM();if(!ry.D(n))throw new E(v.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Km(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ry(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class fo{initialize(e,n){var r=this;return D(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>gM(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=Mz.bind(null,r.syncEngine),yield Ey(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new fz}createDatastore(e){const n=cu(e.databaseInfo.databaseId),r=new Yq(e.databaseInfo);return new Jq(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,i=e.asyncQueue,s=a=>gM(this.syncEngine,a,0),o=JA.D()?new JA:new Wq,new nz(n,r,i,s,o);var n,r,i,s,o}createSyncEngine(e,n){return function(r,i,s,o,a,u,c){const l=new Dz(r,i,s,o,a,u);return c&&(l.fc=!0),l}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return(e=D(function*(n){const r=A(n);b("RemoteStore","RemoteStore shutting down."),r.du.add(5),yield so(r),r._u.shutdown(),r.mu.set("Unknown")}),function(n){return e.apply(this,arguments)})(this.remoteStore);var e}}function DM(t,e=10240){let n=0;return{read:()=>D(function*(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}})(),cancel:()=>D(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class Dd{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.gc(this.observer.next,e)}error(e){this.observer.error?this.gc(this.observer.error,e):je("Uncaught Error in snapshot listener:",e.toString())}yc(){this.muted=!0}gc(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}class Bz{constructor(e,n){this.Ic=e,this.serializer=n,this.metadata=new Xe,this.buffer=new Uint8Array,this.Tc=new TextDecoder("utf-8"),this.Ec().then(r=>{r&&r.ku()?this.metadata.resolve(r.Nu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Nu)}`))},r=>this.metadata.reject(r))}close(){return this.Ic.cancel()}getMetadata(){var e=this;return D(function*(){return e.metadata.promise})()}_c(){var e=this;return D(function*(){return yield e.getMetadata(),e.Ec()})()}Ec(){var e=this;return D(function*(){const n=yield e.Ac();if(null===n)return null;const r=e.Tc.decode(n),i=Number(r);isNaN(i)&&e.Rc(`length string (${r}) is not valid number`);const s=yield e.vc(i);return new mz(JSON.parse(s),n.length+i)})()}bc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Ac(){var e=this;return D(function*(){for(;e.bc()<0&&!(yield e.Pc()););if(0===e.buffer.length)return null;const n=e.bc();n<0&&e.Rc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,n);return e.buffer=e.buffer.slice(n),r})()}vc(e){var n=this;return D(function*(){for(;n.buffer.length<e;)(yield n.Pc())&&n.Rc("Reached the end of bundle when more is expected.");const r=n.Tc.decode(n.buffer.slice(0,e));return n.buffer=n.buffer.slice(e),r})()}Rc(e){throw this.Ic.cancel(),new Error(`Invalid bundle format: ${e}`)}Pc(){var e=this;return D(function*(){const n=yield e.Ic.read();if(!n.done){const r=new Uint8Array(e.buffer.length+n.value.length);r.set(e.buffer),r.set(n.value,e.buffer.length),e.buffer=r}return n.done})()}}class jz{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var n=this;return D(function*(){if(n.ensureCommitNotCalled(),n.mutations.length>0)throw new E(v.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=D(function*(s,o){const a=A(s),u=Ja(a.serializer)+"/documents",c={documents:o.map(f=>Xa(a.serializer,f))},l=yield a.fo("BatchGetDocuments",u,c,o.length),d=new Map;l.forEach(f=>{const p=function aq(t,e){return"found"in e?function(n,r){R(!!r.found);const i=Ln(n,r.found.name),s=Ue(r.found.updateTime),o=r.found.createTime?Ue(r.found.createTime):k.min(),a=new rt({mapValue:{fields:r.found.fields}});return Ee.newFoundDocument(i,s,o,a)}(t,e):"missing"in e?function(n,r){R(!!r.missing),R(!!r.readTime);const i=Ln(n,r.missing),s=Ue(r.readTime);return Ee.newNoDocument(i,s)}(t,e):F()}(a.serializer,f);d.set(p.key.toString(),p)});const h=[];return o.forEach(f=>{const p=d.get(f.toString());R(!!p),h.push(p)}),h}),function(s,o){return i.apply(this,arguments)})(n.datastore,e);var i;return r.forEach(i=>n.recordVersion(i)),r})()}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Xs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return D(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const n=e.readVersions;var r;e.mutations.forEach(r=>{n.delete(r.key.toString())}),n.forEach((r,i)=>{const s=T.fromPath(i);e.mutations.push(new Am(s,e.precondition(s)))}),yield(r=D(function*(i,s){const o=A(i),a=Ja(o.serializer)+"/documents",u={writes:s.map(c=>eu(o.serializer,c))};yield o.co("Commit",a,u)}),function(i,s){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw F();n=k.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new E(v.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(k.min())?Ae.exists(!1):Ae.updateTime(n):Ae.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(k.min()))throw new E(v.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ae.updateTime(n)}return Ae.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Uz{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Vc=r.maxAttempts,this.Co=new sy(this.asyncQueue,"transaction_retry")}run(){this.Vc-=1,this.Sc()}Sc(){var e=this;this.Co.Ao(D(function*(){const n=new jz(e.datastore),r=e.Dc(n);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>n.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.Cc(s)}))}).catch(i=>{e.Cc(i)})}))}Dc(e){try{const n=this.updateFunction(e);return!La(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Cc(e){this.Vc>0&&this.xc(e)?(this.Vc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Sc(),Promise.resolve()))):this.deferred.reject(e)}xc(e){if("FirebaseError"===e.name){const n=e.code;return"aborted"===n||"failed-precondition"===n||"already-exists"===n||!YT(n)}return!1}}class $z{constructor(e,n,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=tt.UNAUTHENTICATED,this.clientId=WS.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=D(function*(a){b("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(b("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return D(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new E(v.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const n=new Xe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(D(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),n.resolve()}catch(r){const i=uo(r,"Failed to shutdown persistence");n.reject(i)}})),n.promise}}function wd(t,e){return rv.apply(this,arguments)}function rv(){return rv=D(function*(t,e){t.asyncQueue.verifyOperationInProgress(),b("FirestoreClient","Initializing OfflineComponentProvider");const n=yield t.getConfiguration();yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(function(){var i=D(function*(s){r.isEqual(s)||(yield GA(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}),rv.apply(this,arguments)}function iv(t,e){return sv.apply(this,arguments)}function sv(){return sv=D(function*(t,e){t.asyncQueue.verifyOperationInProgress();const n=yield ov(t);b("FirestoreClient","Initializing OnlineComponentProvider");const r=yield t.getConfiguration();yield e.initialize(n,r),t.setCredentialChangeListener(i=>aM(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>aM(e.remoteStore,s)),t._onlineComponents=e}),sv.apply(this,arguments)}function wM(t){return"FirebaseError"===t.name?t.code===v.FAILED_PRECONDITION||t.code===v.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}function ov(t){return av.apply(this,arguments)}function av(){return av=D(function*(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){b("FirestoreClient","Using user provided OfflineComponentProvider");try{yield wd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!wM(n))throw n;On("Error using user provided cache. Falling back to memory cache: "+n),yield wd(t,new _d)}}else b("FirestoreClient","Using default OfflineComponentProvider"),yield wd(t,new _d);return t._offlineComponents}),av.apply(this,arguments)}function Ed(t){return uv.apply(this,arguments)}function uv(){return uv=D(function*(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(b("FirestoreClient","Using user provided OnlineComponentProvider"),yield iv(t,t._uninitializedComponentsProvider._online)):(b("FirestoreClient","Using default OnlineComponentProvider"),yield iv(t,new fo))),t._onlineComponents}),uv.apply(this,arguments)}function EM(t){return ov(t).then(e=>e.persistence)}function Cd(t){return ov(t).then(e=>e.localStore)}function CM(t){return Ed(t).then(e=>e.remoteStore)}function cv(t){return Ed(t).then(e=>e.syncEngine)}function po(t){return lv.apply(this,arguments)}function lv(){return lv=D(function*(t){const e=yield Ed(t),n=e.eventManager;return n.onListen=wz.bind(null,e.syncEngine),n.onUnlisten=Ez.bind(null,e.syncEngine),n}),lv.apply(this,arguments)}function IM(t,e,n={}){const r=new Xe;return t.asyncQueue.enqueueAndForget(D(function*(){return function(i,s,o,a,u){const c=new Dd({next:d=>{s.enqueueAndForget(()=>Ty(i,l));const h=d.docs.has(o);!h&&d.fromCache?u.reject(new E(v.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&d.fromCache&&a&&"server"===a.source?u.reject(new E(v.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(d)},error:d=>u.reject(d)}),l=new xy(Ks(o.path),c,{includeMetadataChanges:!0,xu:!0});return Iy(i,l)}(yield po(t),t.asyncQueue,e,n,r)})),r.promise}function SM(t,e,n={}){const r=new Xe;return t.asyncQueue.enqueueAndForget(D(function*(){return function(i,s,o,a,u){const c=new Dd({next:d=>{s.enqueueAndForget(()=>Ty(i,l)),d.fromCache&&"server"===a.source?u.reject(new E(v.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(d)},error:d=>u.reject(d)}),l=new xy(o,c,{includeMetadataChanges:!0,xu:!0});return Iy(i,l)}(yield po(t),t.asyncQueue,e,n,r)})),r.promise}const TM=new Map;function dv(t,e,n){if(!n)throw new E(v.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function AM(t,e,n,r){if(!0===e&&!0===r)throw new E(v.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function MM(t){if(!T.isDocumentKey(t))throw new E(v.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function xM(t){if(T.isDocumentKey(t))throw new E(v.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function bd(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=(n=t).constructor?n.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var n;return"function"==typeof t?"a function":F()}function ne(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new E(v.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bd(t);throw new E(v.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function NM(t,e){if(e<=0)throw new E(v.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}class FM{constructor(e){var n;if(void 0===e.host){if(void 0!==e.ssl)throw new E(v.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(n=e.ssl)||void 0===n||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new E(v.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,AM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hu{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FM({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new E(v.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new E(v.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FM(e),void 0!==e.credentials&&(this._authCredentials=function(n){if(!n)return new QH;switch(n.type){case"firstParty":return new JH(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new E(v.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=TM.get(e);n&&(b("ComponentProvider","Removing Datastore"),TM.delete(e),n.terminate())}(this),Promise.resolve()}}class Ce{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ce(this.firestore,e,this._key)}}class lt{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new lt(this.firestore,e,this._query)}}class Vn extends lt{constructor(e,n,r){super(e,n,Ks(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ce(this.firestore,null,new T(e))}withConverter(e){return new Vn(this.firestore,e,this._path)}}function PM(t,e,...n){if(t=We(t),dv("collection","path",e),t instanceof hu){const r=ie.fromString(e,...n);return xM(r),new Vn(t,null,r)}{if(!(t instanceof Ce||t instanceof Vn))throw new E(v.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ie.fromString(e,...n));return xM(r),new Vn(t.firestore,null,r)}}function Id(t,e,...n){if(t=We(t),1===arguments.length&&(e=WS.A()),dv("doc","path",e),t instanceof hu){const r=ie.fromString(e,...n);return MM(r),new Ce(t,null,new T(r))}{if(!(t instanceof Ce||t instanceof Vn))throw new E(v.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ie.fromString(e,...n));return MM(r),new Ce(t.firestore,t instanceof Vn?t.converter:null,new T(r))}}function RM(t,e){return t=We(t),e=We(e),(t instanceof Ce||t instanceof Vn)&&(e instanceof Ce||e instanceof Vn)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function hv(t,e){return t=We(t),e=We(e),t instanceof lt&&e instanceof lt&&t.firestore===e.firestore&&Ga(t._query,e._query)&&t.converter===e.converter}class Xz{constructor(){this.Nc=Promise.resolve(),this.kc=[],this.Oc=!1,this.$c=[],this.Mc=null,this.Fc=!1,this.Bc=!1,this.Lc=[],this.Co=new sy(this,"async_queue_retry"),this.qc=()=>{const n=md();n&&b("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Co.vo()};const e=md();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.qc)}get isShuttingDown(){return this.Oc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Uc(),this.Kc(e)}enterRestrictedMode(e){if(!this.Oc){this.Oc=!0,this.Bc=e||!1;const n=md();n&&"function"==typeof n.removeEventListener&&n.removeEventListener("visibilitychange",this.qc)}}enqueue(e){if(this.Uc(),this.Oc)return new Promise(()=>{});const n=new Xe;return this.Kc(()=>this.Oc&&this.Bc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.kc.push(e),this.Gc()))}Gc(){var e=this;return D(function*(){if(0!==e.kc.length){try{yield e.kc[0](),e.kc.shift(),e.Co.reset()}catch(n){if(!Nr(n))throw n;b("AsyncQueue","Operation failed with retryable error: "+n)}e.kc.length>0&&e.Co.Ao(()=>e.Gc())}})()}Kc(e){const n=this.Nc.then(()=>(this.Fc=!0,e().catch(r=>{throw this.Mc=r,this.Fc=!1,je("INTERNAL UNHANDLED ERROR: ",function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),o}(r)),r}).then(r=>(this.Fc=!1,r))));return this.Nc=n,n}enqueueAfterDelay(e,n,r){this.Uc(),this.Lc.indexOf(e)>-1&&(n=0);const i=by.createAndSchedule(this,e,n,r,s=>this.Qc(s));return this.$c.push(i),i}Uc(){this.Mc&&F()}verifyOperationInProgress(){}zc(){var e=this;return D(function*(){let n;do{n=e.Nc,yield n}while(n!==e.Nc)})()}jc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Wc(e){return this.zc().then(()=>{this.$c.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),"all"!==e&&n.timerId===e)break;return this.zc()})}Hc(e){this.Lc.push(e)}Qc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}function fv(t){return function(e,n){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(t)}class Jz{constructor(){this._progressObserver={},this._taskCompletionResolver=new Xe,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class be extends hu{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Xz,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||kM(this),this._firestoreClient.terminate()}}function $e(t){return t._firestoreClient||kM(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function kM(t){var e,n,r;const i=t._freezeSettings(),s=(a=(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",new xG(t._databaseId,a,t._persistenceKey,(c=i).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,c.useFetchStreams));var a,c;t._firestoreClient=new $z(t._authCredentials,t._appCheckCredentials,t._queue,s),null!==(n=i.cache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=i.cache)&&void 0!==r&&r._onlineComponentProvider&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}function LM(t,e,n){const r=new Xe;return t.asyncQueue.enqueue(D(function*(){try{yield wd(t,n),yield iv(t,e),r.resolve()}catch(i){const s=i;if(!wM(s))throw s;On("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function VM(t){if(t._initialized||t._terminated)throw new E(v.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Bn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bn(Je.fromBase64String(e))}catch(n){throw new E(v.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Bn(Je.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class hr{constructor(...e){for(let n=0;n<e.length;++n)if(0===e[n].length)throw new E(v.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class $i{constructor(e){this._methodName=e}}class Sd{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new E(v.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new E(v.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return q(this._lat,e._lat)||q(this._long,e._long)}}const l3=/^__.*__$/;class d3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return null!==this.fieldMask?new lr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Zs(e,this.data,n,this.fieldTransforms)}}class BM{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new lr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function jM(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw F()}}class Td{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.Jc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Yc(){return this.settings.Yc}Zc(e){return new Td(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Xc(e){var n;const r=null===(n=this.path)||void 0===n?void 0:n.child(e),i=this.Zc({path:r,ta:!1});return i.ea(e),i}na(e){var n;const r=null===(n=this.path)||void 0===n?void 0:n.child(e),i=this.Zc({path:r,ta:!1});return i.Jc(),i}sa(e){return this.Zc({path:void 0,ta:!0})}ia(e){return xd(e,this.settings.methodName,this.settings.ra||!1,this.path,this.settings.oa)}contains(e){return void 0!==this.fieldMask.find(n=>e.isPrefixOf(n))||void 0!==this.fieldTransforms.find(n=>e.isPrefixOf(n.field))}Jc(){if(this.path)for(let e=0;e<this.path.length;e++)this.ea(this.path.get(e))}ea(e){if(0===e.length)throw this.ia("Document fields must not be empty");if(jM(this.Yc)&&l3.test(e))throw this.ia('Document fields cannot begin and end with "__"')}}class h3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||cu(e)}ua(e,n,r,i=!1){return new Td({Yc:e,methodName:n,oa:r,path:Pe.emptyPath(),ta:!1,ra:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hi(t){const e=t._freezeSettings(),n=cu(t._databaseId);return new h3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ad(t,e,n,r,i,s={}){const o=t.ua(s.merge||s.mergeFields?2:0,e,n,i);yv("Data must be an object, but it was:",o,r);const a=HM(r,o);let u,c;if(s.merge)u=new Ut(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const l=[];for(const d of s.mergeFields){const h=gu(e,d,n);if(!o.contains(h))throw new E(v.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);qM(l,h)||l.push(h)}u=new Ut(l),c=o.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,c=o.fieldTransforms;return new d3(new rt(a),u,c)}class pu extends $i{_toFieldTransform(e){if(2!==e.Yc)throw e.ia(1===e.Yc?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pu}}function UM(t,e,n){return new Td({Yc:3,oa:e.settings.oa,methodName:t._methodName,ta:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class pv extends $i{_toFieldTransform(e){return new Ka(e.path,new Qs)}isEqual(e){return e instanceof pv}}class f3 extends $i{constructor(e,n){super(e),this.ca=n}_toFieldTransform(e){const n=UM(this,e,!0),r=this.ca.map(s=>Gi(s,n)),i=new Oi(r);return new Ka(e.path,i)}isEqual(e){return this===e}}class p3 extends $i{constructor(e,n){super(e),this.ca=n}_toFieldTransform(e){const n=UM(this,e,!0),r=this.ca.map(s=>Gi(s,n)),i=new Pi(r);return new Ka(e.path,i)}isEqual(e){return this===e}}class g3 extends $i{constructor(e,n){super(e),this.aa=n}_toFieldTransform(e){const n=new Ys(e.serializer,BT(e.serializer,this.aa));return new Ka(e.path,n)}isEqual(e){return this===e}}function gv(t,e,n,r){const i=t.ua(1,e,n);yv("Data must be an object, but it was:",i,r);const s=[],o=rt.empty();Ti(r,(u,c)=>{const l=Md(e,u,n);c=We(c);const d=i.na(l);if(c instanceof pu)s.push(l);else{const h=Gi(c,d);null!=h&&(s.push(l),o.set(l,h))}});const a=new Ut(s);return new BM(o,a,i.fieldTransforms)}function mv(t,e,n,r,i,s){const o=t.ua(1,e,n),a=[gu(e,r,n)],u=[i];if(s.length%2!=0)throw new E(v.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(gu(e,s[h])),u.push(s[h+1]);const c=[],l=rt.empty();for(let h=a.length-1;h>=0;--h)if(!qM(c,a[h])){const f=a[h];let p=u[h];p=We(p);const g=o.na(f);if(p instanceof pu)c.push(f);else{const m=Gi(p,g);null!=m&&(c.push(f),l.set(f,m))}}const d=new Ut(c);return new BM(l,d,o.fieldTransforms)}function $M(t,e,n,r=!1){return Gi(n,t.ua(r?4:3,e))}function Gi(t,e){if(GM(t=We(t)))return yv("Unsupported field value:",e,t),HM(t,e);if(t instanceof $i)return function(n,r){if(!jM(r.Yc))throw r.ia(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ia(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.ta&&4!==e.Yc)throw e.ia("Nested arrays are not supported");return function(n,r){const i=[];let s=0;for(const o of n){let a=Gi(o,r.sa(s));null==a&&(a={nullValue:"NULL_VALUE"}),i.push(a),s++}return{arrayValue:{values:i}}}(t,e)}return function(n,r){if(null===(n=We(n)))return{nullValue:"NULL_VALUE"};if("number"==typeof n)return BT(r.serializer,n);if("boolean"==typeof n)return{booleanValue:n};if("string"==typeof n)return{stringValue:n};if(n instanceof Date){const i=Te.fromDate(n);return{timestampValue:Js(r.serializer,i)}}if(n instanceof Te){const i=new Te(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Js(r.serializer,i)}}if(n instanceof Sd)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Bn)return{bytesValue:rA(r.serializer,n._byteString)};if(n instanceof Ce){const i=r.databaseId,s=n.firestore._databaseId;if(!s.isEqual(i))throw r.ia(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Pm(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.ia(`Unsupported field value: ${bd(n)}`)}(t,e)}function HM(t,e){const n={};return uT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ti(t,(r,i)=>{const s=Gi(i,e.Xc(r));null!=s&&(n[r]=s)}),{mapValue:{fields:n}}}function GM(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Te||t instanceof Sd||t instanceof Bn||t instanceof Ce||t instanceof $i)}function yv(t,e,n){if(!GM(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=bd(n);throw e.ia("an object"===r?t+" a custom object":t+" "+r)}var r}function gu(t,e,n){if((e=We(e))instanceof hr)return e._internalPath;if("string"==typeof e)return Md(t,e);throw xd("Field path arguments must be of type string or ",t,!1,void 0,n)}const m3=new RegExp("[~\\*/\\[\\]]");function Md(t,e,n){if(e.search(m3)>=0)throw xd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new hr(...e.split("."))._internalPath}catch{throw xd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function xd(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new E(v.INVALID_ARGUMENT,a+t+u)}function qM(t,e){return t.some(n=>n.isEqual(e))}class mu{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ce(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new y3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Nd("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n)}}}class y3 extends mu{data(){return super.data()}}function Nd(t,e){return"string"==typeof e?Md(t,e):e instanceof hr?e._internalPath:e._delegate._internalPath}function zM(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new E(v.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vv{}class yu extends vv{}function qr(t,e,...n){let r=[];e instanceof vv&&r.push(e),r=r.concat(n),function(i){const s=i.filter(a=>a instanceof go).length,o=i.filter(a=>a instanceof vu).length;if(s>1||s>0&&o>0)throw new E(v.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class vu extends yu{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new vu(e,n,r)}_apply(e){const n=this._parse(e);return YM(e._query,n),new lt(e.firestore,e.converter,Sm(e._query,n))}_parse(e){const n=Hi(e.firestore);return function(i,s,o,a,u,c,l){let d;if(u.isKeyField()){if("array-contains"===c||"array-contains-any"===c)throw new E(v.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if("in"===c||"not-in"===c){QM(l,c);const h=[];for(const f of l)h.push(KM(a,i,f));d={arrayValue:{values:h}}}else d=KM(a,i,l)}else"in"!==c&&"not-in"!==c&&"array-contains-any"!==c||QM(l,c),d=$M(o,"where",l,"in"===c||"not-in"===c);return te.create(u,c,d)}(e._query,0,n,e.firestore._databaseId,this._field,this._op,this._value)}}class go extends vv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new go(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===n.length?n[0]:fe.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return 0===n.getFilters().length?e:(function(r,i){let s=r;const o=i.getFlattenedFilters();for(const a of o)YM(s,a),s=Sm(s,a)}(e._query,n),new lt(e.firestore,e.converter,Sm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class _v extends yu{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new _v(e,n)}_apply(e){const n=function(r,i,s){if(null!==r.startAt)throw new E(v.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new E(v.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new zs(i,s);return function(a,u){if(null===bm(a)){const c=Kl(a);null!==c&&ZM(0,c,u.field)}}(r,o),o}(e._query,this._field,this._direction);return new lt(e.firestore,e.converter,function(r,i){const s=r.explicitOrderBy.concat([i]);return new cr(r.path,r.collectionGroup,s,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}class Fd extends yu{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Fd(e,n,r)}_apply(e){return new lt(e.firestore,e.converter,Ql(e._query,this._limit,this._limitType))}}class Od extends yu{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Od(e,n,r)}_apply(e){const n=WM(e,this.type,this._docOrFields,this._inclusive);return new lt(e.firestore,e.converter,(i=n,new cr((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class Pd extends yu{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Pd(e,n,r)}_apply(e){const n=WM(e,this.type,this._docOrFields,this._inclusive);return new lt(e.firestore,e.converter,(i=n,new cr((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function WM(t,e,n,r){if(n[0]=We(n[0]),n[0]instanceof mu)return function(i,s,o,a,u){if(!a)throw new E(v.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const c=[];for(const l of Fi(i))if(l.field.isKeyField())c.push(xi(s,a.key));else{const d=a.data.field(l.field);if(ym(d))throw new E(v.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+l.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===d){const h=l.field.canonicalString();throw new E(v.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${h}' (used as the orderBy) does not exist.`)}c.push(d)}return new kr(c,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=Hi(t.firestore);return function(s,o,a,u,c,l){const d=s.explicitOrderBy;if(c.length>d.length)throw new E(v.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const h=[];for(let f=0;f<c.length;f++){const p=c[f];if(d[f].field.isKeyField()){if("string"!=typeof p)throw new E(v.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof p}`);if(!Im(s)&&-1!==p.indexOf("/"))throw new E(v.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${p}' contains a slash.`);const g=s.path.child(ie.fromString(p));if(!T.isDocumentKey(g))throw new E(v.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${g}' is not because it contains an odd number of segments.`);const m=new T(g);h.push(xi(o,m))}else{const g=$M(a,u,p);h.push(g)}}return new kr(h,l)}(t._query,t.firestore._databaseId,i,e,n,r)}}function KM(t,e,n){if("string"==typeof(n=We(n))){if(""===n)throw new E(v.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Im(e)&&-1!==n.indexOf("/"))throw new E(v.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ie.fromString(n));if(!T.isDocumentKey(r))throw new E(v.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xi(t,new T(r))}if(n instanceof Ce)return xi(t,n._key);throw new E(v.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bd(n)}.`)}function QM(t,e){if(!Array.isArray(t)||0===t.length)throw new E(v.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function YM(t,e){if(e.isInequality()){const r=Kl(t),i=e.field;if(null!==r&&!r.isEqual(i))throw new E(v.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);const s=bm(t);null!==s&&ZM(0,i,s)}const n=function(r,i){for(const s of r)for(const o of s.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw new E(v.INVALID_ARGUMENT,n===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function ZM(t,e,n){if(!n.isEqual(e))throw new E(v.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class Dv{convertValue(e,n="none"){switch(Mi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ke(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ai(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw F()}}convertObject(e,n){const r={};return Ti(e.fields,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Sd(ke(e.latitude),ke(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=lT(e);return null==r?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ba(e));default:return null}}convertTimestamp(e){const n=Fr(e);return new Te(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ie.fromString(e);R(fA(r));const i=new Or(r.get(1),r.get(3)),s=new T(r.popFirst(5));return i.isEqual(n)||je(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}function Rd(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class S3 extends Dv{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ce(this.firestore,null,n)}}class qi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fr extends mu{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new _u(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Nd("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class _u extends fr{data(e={}){return super.data(e)}}class zr{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new qi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new _u(this._firestore,this._userDataWriter,r.key,r,new qi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new E(v.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new _u(r._firestore,r._userDataWriter,o.doc.key,o.doc,new qi(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:s++}))}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>i||3!==o.type).map(o=>{const a=new _u(r._firestore,r._userDataWriter,o.doc.key,o.doc,new qi(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,c=-1;return 0!==o.type&&(u=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),1!==o.type&&(s=s.add(o.doc),c=s.indexOf(o.doc.key)),{type:A3(o.type),doc:a,oldIndex:u,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function A3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return F()}}function JM(t,e){return t instanceof fr&&e instanceof fr?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof zr&&e instanceof zr&&t._firestore===e._firestore&&hv(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}class Wr extends Dv{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ce(this.firestore,null,n)}}function ex(t,e,n){t=ne(t,Ce);const r=ne(t.firestore,be),i=Rd(t.converter,e,n);return mo(r,[Ad(Hi(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Ae.none())])}function tx(t,e,n,...r){t=ne(t,Ce);const i=ne(t.firestore,be),s=Hi(i);let o;return o="string"==typeof(e=We(e))||e instanceof hr?mv(s,"updateDoc",t._key,e,n,r):gv(s,"updateDoc",t._key,e),mo(i,[o.toMutation(t._key,Ae.exists(!0))])}function nx(t,...e){var n,r,i;t=We(t);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||fv(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(fv(e[o])){const d=e[o];e[o]=null===(n=d.next)||void 0===n?void 0:n.bind(d),e[o+1]=null===(r=d.error)||void 0===r?void 0:r.bind(d),e[o+2]=null===(i=d.complete)||void 0===i?void 0:i.bind(d)}let u,c,l;if(t instanceof Ce)c=ne(t.firestore,be),l=Ks(t._key.path),u={next:d=>{e[o]&&e[o](wv(c,t,d))},error:e[o+1],complete:e[o+2]};else{const d=ne(t,lt);c=ne(d.firestore,be),l=d._query;const h=new Wr(c);u={next:f=>{e[o]&&e[o](new zr(c,h,d,f))},error:e[o+1],complete:e[o+2]},zM(t._query)}return function(d,h,f,p){const g=new Dd(p),m=new xy(h,g,f);return d.asyncQueue.enqueueAndForget(D(function*(){return Iy(yield po(d),m)})),()=>{g.yc(),d.asyncQueue.enqueueAndForget(D(function*(){return Ty(yield po(d),m)}))}}($e(c),l,a,u)}function mo(t,e){return function(n,r){const i=new Xe;return n.asyncQueue.enqueueAndForget(D(function*(){return function Cz(t,e,n){return Ry.apply(this,arguments)}(yield cv(n),r,i)})),i.promise}($e(t),e)}function wv(t,e,n){const r=n.docs.get(e._key),i=new Wr(t);return new fr(t,i,e._key,r,new qi(n.hasPendingWrites,n.fromCache),e.converter)}const G3={maxAttempts:5};class rx{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Hi(e)}set(e,n,r){this._verifyNotCommitted();const i=Kr(e,this._firestore),s=Rd(i.converter,n,r),o=Ad(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(o.toMutation(i._key,Ae.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=Kr(e,this._firestore);let o;return o="string"==typeof(n=We(n))||n instanceof hr?mv(this._dataReader,"WriteBatch.update",s._key,n,r,i):gv(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Ae.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Kr(e,this._firestore);return this._mutations=this._mutations.concat(new Xs(n._key,Ae.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new E(v.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Kr(t,e){if((t=We(t)).firestore!==e)throw new E(v.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}class q3 extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Hi(e)}get(e){const n=Kr(e,this._firestore),r=new S3(this._firestore);return this._transaction.lookup([n._key]).then(i=>{if(!i||1!==i.length)return F();const s=i[0];if(s.isFoundDocument())return new mu(this._firestore,r,s.key,s,n.converter);if(s.isNoDocument())return new mu(this._firestore,r,n._key,null,n.converter);throw F()})}set(e,n,r){const i=Kr(e,this._firestore),s=Rd(i.converter,n,r),o=Ad(this._dataReader,"Transaction.set",i._key,s,null!==i.converter,r);return this._transaction.set(i._key,o),this}update(e,n,r,...i){const s=Kr(e,this._firestore);let o;return o="string"==typeof(n=We(n))||n instanceof hr?mv(this._dataReader,"Transaction.update",s._key,n,r,i):gv(this._dataReader,"Transaction.update",s._key,n),this._transaction.update(s._key,o),this}delete(e){const n=Kr(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Kr(e,this._firestore),r=new Wr(this._firestore);return super.get(e).then(i=>new fr(this._firestore,r,n._key,i._document,new qi(!1,!1),n.converter))}}!function(t,e=!0){$s=vg,Ls(new vi("firestore",(n,{instanceIdentifier:r,options:i})=>{const s=n.getProvider("app").getImmediate(),o=new be(new ZH(n.getProvider("auth-internal")),new eG(n.getProvider("app-check-internal")),function(a,u){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new E(v.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Or(a.options.projectId,u)}(s,r),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Sr(GS,"3.10.1",t),Sr(GS,"3.10.1","esm2017")}();function Ev(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new E("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function sx(){if(typeof Uint8Array>"u")throw new E("unimplemented","Uint8Arrays are not available in this environment.")}function ox(){if(!function AG(){return typeof atob<"u"}())throw new E("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Du{constructor(e){this._delegate=e}static fromBase64String(e){return ox(),new Du(Bn.fromBase64String(e))}static fromUint8Array(e){return sx(),new Du(Bn.fromUint8Array(e))}toBase64(){return ox(),this._delegate.toBase64()}toUint8Array(){return sx(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Cv(t){return function e8(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const r of e)if(r in n&&"function"==typeof n[r])return!0;return!1}(t,["next","error","complete"])}class t8{enableIndexedDbPersistence(e,n){return function t3(t,e){VM(t=ne(t,be));const n=$e(t);if(n._uninitializedComponentsProvider)throw new E(v.FAILED_PRECONDITION,"SDK cache is already specified.");On("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new fo;return LM(n,i,new nv(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return function n3(t){VM(t=ne(t,be));const e=$e(t);if(e._uninitializedComponentsProvider)throw new E(v.FAILED_PRECONDITION,"SDK cache is already specified.");On("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new fo;return LM(e,r,new _M(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function r3(t){if(t._initialized&&!t._terminated)throw new E(v.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Xe;return t._queue.enqueueAndForgetEvenWhileRestricted(D(function*(){try{yield(n=D(function*(r){if(!Dn.D())return Promise.resolve();const i=r+"main";yield Dn.delete(i)}),function(r){return n.apply(this,arguments)})(Km(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}var n})),e.promise}(e._delegate)}}class ax{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Or||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&On("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},n),e)).merge,this._delegate._setSettings(e)}useEmulator(e,n,r={}){!function OM(t,e,n,r={}){var i;const s=(t=ne(t,hu))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==e&&On("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${n}`,ssl:!1})),r.mockUserToken){let o,a;if("string"==typeof r.mockUserToken)o=r.mockUserToken,a=tt.MOCK_USER;else{o=function dU(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ol(JSON.stringify({alg:"none",type:"JWT"})),ol(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new E(v.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new tt(u)}t._authCredentials=new YH(new qS(o,a))}}(this._delegate,e,n,r)}enableNetwork(){return function s3(t){return function Hz(t){return t.asyncQueue.enqueue(D(function*(){const e=yield EM(t),n=yield CM(t);return e.setNetworkEnabled(!0),function(r){const i=A(r);return i.du.delete(0),lu(i)}(n)}))}($e(t=ne(t,be)))}(this._delegate)}disableNetwork(){return function o3(t){return function Gz(t){return t.asyncQueue.enqueue(D(function*(){const e=yield EM(t),n=yield CM(t);return e.setNetworkEnabled(!1),(r=D(function*(i){const s=A(i);s.du.add(0),yield so(s),s.mu.set("Offline")}),function(i){return r.apply(this,arguments)})(n);var r}))}($e(t=ne(t,be)))}(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,AM("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function i3(t){return function(e){const n=new Xe;return e.asyncQueue.enqueueAndForget(D(function*(){return function Tz(t,e){return jy.apply(this,arguments)}(yield cv(e),n)})),n.promise}($e(t=ne(t,be)))}(this._delegate)}onSnapshotsInSync(e){return function L3(t,e){return function Wz(t,e){const n=new Dd(e);return t.asyncQueue.enqueueAndForget(D(function*(){return r=yield po(t),i=n,A(r).Au.add(i),void i.next();var r,i})),()=>{n.yc(),t.asyncQueue.enqueueAndForget(D(function*(){return r=yield po(t),i=n,void A(r).Au.delete(i);var r,i}))}}($e(t=ne(t,be)),fv(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new E("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new yo(this,PM(this._delegate,e))}catch(n){throw Ft(n,"collection()","Firestore.collection()")}}doc(e){try{return new cn(this,Id(this._delegate,e))}catch(n){throw Ft(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ot(this,function Zz(t,e){if(t=ne(t,hu),dv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new E(v.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new lt(t,null,(n=e,new cr(ie.emptyPath(),n)));var n}(this._delegate,e))}catch(n){throw Ft(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function z3(t,e,n){t=ne(t,be);const r=Object.assign(Object.assign({},G3),n);return function(i){if(i.maxAttempts<1)throw new E(v.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,s,o){const a=new Xe;return i.asyncQueue.enqueueAndForget(D(function*(){const u=yield function bM(t){return Ed(t).then(e=>e.datastore)}(i);new Uz(i.asyncQueue,u,o,s,a).run()})),a.promise}($e(t),i=>e(new q3(t,i)),r)}(this._delegate,n=>e(new ux(this,n)))}batch(){return $e(this._delegate),new cx(new rx(this._delegate,e=>mo(this._delegate,e)))}loadBundle(e){return function a3(t,e){const n=$e(t=ne(t,be)),r=new Jz;return function Kz(t,e,n,r){const i=function(s,o){let a;return a="string"==typeof s?(new TextEncoder).encode(s):s,u=function(u,c){if(u instanceof Uint8Array)return DM(u,c);if(u instanceof ArrayBuffer)return DM(new Uint8Array(u),c);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),new Bz(u,o);var u}(n,cu(e));t.asyncQueue.enqueueAndForget(D(function*(){!function Vz(t,e,n){const r=A(t);var i;(i=D(function*(s,o,a){try{const u=yield o.getMetadata();if(yield function(h,f){const p=A(h),g=Ue(f.createTime);return p.persistence.runTransaction("hasNewerBundle","readonly",m=>p.xs.getBundleMetadata(m,f.id)).then(m=>!!m&&m.createTime.compareTo(g)>=0)}(s.localStore,u))return yield o.close(),a._completeWith({taskState:"Success",documentsLoaded:(h=u).totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}),Promise.resolve(new Set);a._updateProgress(lM(u));const c=new yz(u,s.localStore,o.serializer);let l=yield o._c();for(;l;){const h=yield c.$u(l);h&&a._updateProgress(h),l=yield o._c()}const d=yield c.complete();return yield dr(s,d.Bu,void 0),yield function(h,f){const p=A(h);return p.persistence.runTransaction("Save bundle","readwrite",g=>p.xs.saveBundleMetadata(g,f))}(s.localStore,u),a._completeWith(d.progress),Promise.resolve(d.Fu)}catch(u){return On("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}var h}),function(s,o,a){return i.apply(this,arguments)})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield cv(t),i,r)}))}(n,t._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function u3(t,e){return function Qz(t,e){return t.asyncQueue.enqueue(D(function*(){return function(n,r){const i=A(n);return i.persistence.runTransaction("Get named query","readonly",s=>i.xs.getNamedQuery(s,r))}(yield Cd(t),e)}))}($e(t=ne(t,be)),e).then(n=>n?new lt(t,null,n.query):null)}(this._delegate,e).then(n=>n?new Ot(this,n):null)}}class kd extends Dv{constructor(e){super(),this.firestore=e}convertBytes(e){return new Du(new Bn(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return cn.forKey(n,this.firestore,null)}}class ux{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new kd(e)}get(e){const n=Wi(e);return this._delegate.get(n).then(r=>new wu(this._firestore,new fr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=Wi(e);return r?(Ev("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Wi(e);return 2===arguments.length?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Wi(e);return this._delegate.delete(n),this}}class cx{constructor(e){this._delegate=e}set(e,n,r){const i=Wi(e);return r?(Ev("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Wi(e);return 2===arguments.length?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Wi(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class zi{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new _u(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Eu(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=zi.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new zi(e,new kd(e),n),i.set(n,s)),s}}zi.INSTANCES=new WeakMap;class cn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new kd(e)}static forPath(e,n,r){if(e.length%2!=0)throw new E("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new cn(n,new Ce(n._delegate,r,new T(e)))}static forKey(e,n,r){return new cn(n,new Ce(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new yo(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new yo(this.firestore,PM(this._delegate,e))}catch(n){throw Ft(n,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=We(e))instanceof Ce&&RM(this._delegate,e)}set(e,n){n=Ev("DocumentReference.set",n);try{return n?ex(this._delegate,e,n):ex(this._delegate,e)}catch(r){throw Ft(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return 1===arguments.length?tx(this._delegate,e):tx(this._delegate,e,n,...r)}catch(i){throw Ft(i,"updateDoc()","DocumentReference.update()")}}delete(){return function R3(t){return mo(ne(t.firestore,be),[new Xs(t._key,Ae.none())])}(this._delegate)}onSnapshot(...e){const n=lx(e),r=dx(e,i=>new wu(this.firestore,new fr(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return nx(this._delegate,n,r)}get(e){let n;return n="cache"===e?.source?function x3(t){t=ne(t,Ce);const e=ne(t.firestore,be),n=$e(e),r=new Wr(e);return function qz(t,e){const n=new Xe;return t.asyncQueue.enqueueAndForget(D(function*(){return(r=D(function*(i,s,o){try{const a=yield function(u,c){const l=A(u);return l.persistence.runTransaction("read document","readonly",d=>l.localDocuments.getDocument(d,c))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new E(v.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const u=uo(a,`Failed to get document '${s} from cache`);o.reject(u)}}),function(i,s,o){return r.apply(this,arguments)})(yield Cd(t),e,n);var r})),n.promise}(n,t._key).then(i=>new fr(e,r,t._key,i,new qi(null!==i&&i.hasLocalMutations,!0),t.converter))}(this._delegate):"server"===e?.source?function N3(t){t=ne(t,Ce);const e=ne(t.firestore,be);return IM($e(e),t._key,{source:"server"}).then(n=>wv(e,t,n))}(this._delegate):function M3(t){t=ne(t,Ce);const e=ne(t.firestore,be);return IM($e(e),t._key).then(n=>wv(e,t,n))}(this._delegate),n.then(r=>new wu(this.firestore,new fr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new cn(this.firestore,this._delegate.withConverter(e?zi.getInstance(this.firestore,e):null))}}function Ft(t,e,n){return t.message=t.message.replace(e,n),t}function lx(t){for(const e of t)if("object"==typeof e&&!Cv(e))return e;return{}}function dx(t,e){var n,r;let i;return i=Cv(t[0])?t[0]:Cv(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class wu{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new cn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return JM(this._delegate,e._delegate)}}class Eu extends wu{data(e){const n=this._delegate.data(e);return function KH(t,e){t||F()}(void 0!==n),n}}class Ot{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new kd(e)}where(e,n,r){try{return new Ot(this.firestore,qr(this._delegate,function v3(t,e,n){const r=e,i=Nd("where",t);return vu._create(i,r,n)}(e,n,r)))}catch(i){throw Ft(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new Ot(this.firestore,qr(this._delegate,function _3(t,e="asc"){const n=e,r=Nd("orderBy",t);return _v._create(r,n)}(e,n)))}catch(r){throw Ft(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ot(this.firestore,qr(this._delegate,function D3(t){return NM("limit",t),Fd._create("limit",t,"F")}(e)))}catch(n){throw Ft(n,"limit()","Query.limit()")}}limitToLast(e){try{return new Ot(this.firestore,qr(this._delegate,function w3(t){return NM("limitToLast",t),Fd._create("limitToLast",t,"L")}(e)))}catch(n){throw Ft(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ot(this.firestore,qr(this._delegate,function E3(...t){return Od._create("startAt",t,!0)}(...e)))}catch(n){throw Ft(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ot(this.firestore,qr(this._delegate,function C3(...t){return Od._create("startAfter",t,!1)}(...e)))}catch(n){throw Ft(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ot(this.firestore,qr(this._delegate,function b3(...t){return Pd._create("endBefore",t,!1)}(...e)))}catch(n){throw Ft(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ot(this.firestore,qr(this._delegate,function I3(...t){return Pd._create("endAt",t,!0)}(...e)))}catch(n){throw Ft(n,"endAt()","Query.endAt()")}}isEqual(e){return hv(this._delegate,e._delegate)}get(e){let n;return n="cache"===e?.source?function O3(t){t=ne(t,lt);const e=ne(t.firestore,be),n=$e(e),r=new Wr(e);return function zz(t,e){const n=new Xe;return t.asyncQueue.enqueueAndForget(D(function*(){return(r=D(function*(i,s,o){try{const a=yield hd(i,s,!0),u=new fM(s,a.Wi),c=u.zu(a.documents),l=u.applyChanges(c,!1);o.resolve(l.snapshot)}catch(a){const u=uo(a,`Failed to execute query '${s} against cache`);o.reject(u)}}),function(i,s,o){return r.apply(this,arguments)})(yield Cd(t),e,n);var r})),n.promise}(n,t._query).then(i=>new zr(e,r,t,i))}(this._delegate):"server"===e?.source?function P3(t){t=ne(t,lt);const e=ne(t.firestore,be),n=$e(e),r=new Wr(e);return SM(n,t._query,{source:"server"}).then(i=>new zr(e,r,t,i))}(this._delegate):function F3(t){t=ne(t,lt);const e=ne(t.firestore,be),n=$e(e),r=new Wr(e);return zM(t._query),SM(n,t._query).then(i=>new zr(e,r,t,i))}(this._delegate),n.then(r=>new bv(this.firestore,new zr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=lx(e),r=dx(e,i=>new bv(this.firestore,new zr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return nx(this._delegate,n,r)}withConverter(e){return new Ot(this.firestore,this._delegate.withConverter(e?zi.getInstance(this.firestore,e):null))}}class r8{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Eu(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class bv{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new Ot(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Eu(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new r8(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Eu(this._firestore,r))})}isEqual(e){return JM(this._delegate,e._delegate)}}class yo extends Ot{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new cn(this.firestore,e):null}doc(e){try{return new cn(this.firestore,void 0===e?Id(this._delegate):Id(this._delegate,e))}catch(n){throw Ft(n,"doc()","CollectionReference.doc()")}}add(e){return function k3(t,e){const n=ne(t.firestore,be),r=Id(t),i=Rd(t.converter,e);return mo(n,[Ad(Hi(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Ae.exists(!1))]).then(()=>r)}(this._delegate,e).then(n=>new cn(this.firestore,n))}isEqual(e){return RM(this._delegate,e._delegate)}withConverter(e){return new yo(this.firestore,this._delegate.withConverter(e?zi.getInstance(this.firestore,e):null))}}function Wi(t){return ne(t,Ce)}class Iv{constructor(...e){this._delegate=new hr(...e)}static documentId(){return new Iv(Pe.keyField().canonicalString())}isEqual(e){return(e=We(e))instanceof hr&&this._delegate._internalPath.isEqual(e._internalPath)}}class Ki{constructor(e){this._delegate=e}static serverTimestamp(){const e=function K3(){return new pv("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Ki(e)}static delete(){const e=function W3(){return new pu("deleteField")}();return e._methodName="FieldValue.delete",new Ki(e)}static arrayUnion(...e){const n=function Q3(...t){return new f3("arrayUnion",t)}(...e);return n._methodName="FieldValue.arrayUnion",new Ki(n)}static arrayRemove(...e){const n=function Y3(...t){return new p3("arrayRemove",t)}(...e);return n._methodName="FieldValue.arrayRemove",new Ki(n)}static increment(e){const n=function Z3(t){return new g3("increment",t)}(e);return n._methodName="FieldValue.increment",new Ki(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const i8={Firestore:ax,GeoPoint:Sd,Timestamp:Te,Blob:Du,Transaction:ux,WriteBatch:cx,DocumentReference:cn,DocumentSnapshot:wu,Query:Ot,QueryDocumentSnapshot:Eu,QuerySnapshot:bv,CollectionReference:yo,FieldPath:Iv,FieldValue:Ki,setLogLevel:function n8(t){!function WH(t){Mr.setLogLevel(t)}(t)},CACHE_SIZE_UNLIMITED:-1};!function o8(t){(function s8(t,e){t.INTERNAL.registerComponent(new vi("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},i8)))})(t,(e,n)=>new ax(e,n,new t8)),t.registerVersion("@firebase/firestore-compat","0.3.7")}(dl);const a8={apiKey:"AIzaSyCivcDk5rhJ4Okh8Kl0RPVkTJrifeMkwtY",authDomain:"fbvideo-frontend.firebaseapp.com",projectId:"fbvideo-frontend",storageBucket:"fbvideo-frontend.appspot.com",messagingSenderId:"684932412175",appId:"1:684932412175:web:3de521a17fb1570c78847a"};let u8=(()=>{class t{constructor(){this.message=[],this.firebaseApplication=dl.initializeApp(a8),this.firestore=dl.firestore(),this.getMessage()}sendMessage(n){let r={messageContent:n,timestamp:new Date,user:"John Duo"};this.firestore.collection("initCollection").add(r)}getMessage(){this.firestore.collection("initCollection").where("user","==","John Duo").onSnapshot(n=>{n.docChanges().forEach(r=>{if("added"==r.type&&this.message.push({id:r.doc.id,data:r.doc.data()}),"modified"==r.type){const i=this.message.findIndex(s=>s.id!=r.doc.id);this.message[i]={id:r.doc.id,data:r.doc.data()}}"removed"==r.type&&(this.message=this.message.filter(i=>i.id!=r.doc.id))})})}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ve({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const{isArray:c8}=Array,{getPrototypeOf:l8,prototype:d8,keys:h8}=Object;const{isArray:g8}=Array;function v8(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function _8(...t){const e=function qN(t){return He(oh(t))?t.pop():void 0}(t),{args:n,keys:r}=function f8(t){if(1===t.length){const e=t[0];if(c8(e))return{args:e,keys:null};if(function p8(t){return t&&"object"==typeof t&&l8(t)===d8}(e)){const n=h8(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}(t),i=new Ct(s=>{const{length:o}=n;if(!o)return void s.complete();const a=new Array(o);let u=o,c=o;for(let l=0;l<o;l++){let d=!1;Un(n[l]).subscribe(Co(s,h=>{d||(d=!0,c--),a[l]=h},()=>u--,void 0,()=>{(!u||!d)&&(c||s.next(r?v8(r,a):a),s.complete())}))}});return e?i.pipe(function y8(t){return ih(e=>function m8(t,e){return g8(e)?t(...e):t(e)}(t,e))}(e)):i}let hx=(()=>{class t{constructor(n,r){this._renderer=n,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(n,r){this._renderer.setProperty(this._elementRef.nativeElement,n,r)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return t.\u0275fac=function(n){return new(n||t)(S(ci),S(fn))},t.\u0275dir=W({type:t}),t})(),Qi=(()=>{class t extends hx{}return t.\u0275fac=function(){let e;return function(r){return(e||(e=function pt(t){return Hn(()=>{const e=t.prototype.constructor,n=e[qn]||Lh(e),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const s=i[qn]||Lh(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}(t)))(r||t)}}(),t.\u0275dir=W({type:t,features:[he]}),t})();const jn=new $("NgValueAccessor"),w8={provide:jn,useExisting:ye(()=>Ld),multi:!0},C8=new $("CompositionEventMode");let Ld=(()=>{class t extends hx{constructor(n,r,i){super(n,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function E8(){const t=ks()?ks().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return t.\u0275fac=function(n){return new(n||t)(S(ci),S(fn),S(C8,8))},t.\u0275dir=W({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,r){1&n&&Zt("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},features:[Ie([w8]),he]}),t})();const b8=!1,Et=new $("NgValidators"),Yr=new $("NgAsyncValidators");function Cx(t){return null!=t}function bx(t){const e=Tc(t)?E_(t):t;if(b8&&!TE(e)){let n="Expected async validator to return Promise or Observable.";throw"object"==typeof t&&(n+=" Are you using a synchronous validator where an async validator is expected?"),new M(-1101,n)}return e}function Ix(t){let e={};return t.forEach(n=>{e=null!=n?{...e,...n}:e}),0===Object.keys(e).length?null:e}function Sx(t,e){return e.map(n=>n(t))}function Tx(t){return t.map(e=>function S8(t){return!t.validate}(e)?e:n=>e.validate(n))}function Sv(t){return null!=t?function Ax(t){if(!t)return null;const e=t.filter(Cx);return 0==e.length?null:function(n){return Ix(Sx(n,e))}}(Tx(t)):null}function Tv(t){return null!=t?function Mx(t){if(!t)return null;const e=t.filter(Cx);return 0==e.length?null:function(n){return _8(Sx(n,e).map(bx)).pipe(ih(Ix))}}(Tx(t)):null}function xx(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}function Av(t){return t?Array.isArray(t)?t:[t]:[]}function Bd(t,e){return Array.isArray(t)?t.includes(e):t===e}function Ox(t,e){const n=Av(e);return Av(t).forEach(i=>{Bd(n,i)||n.push(i)}),n}function Px(t,e){return Av(e).filter(n=>!Bd(t,n))}class Rx{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Sv(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Tv(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,n){return!!this.control&&this.control.hasError(e,n)}getError(e,n){return this.control?this.control.getError(e,n):null}}class Pt extends Rx{get formDirective(){return null}get path(){return null}}class Zr extends Rx{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class kx{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Lx=(()=>{class t extends kx{constructor(n){super(n)}}return t.\u0275fac=function(n){return new(n||t)(S(Zr,2))},t.\u0275dir=W({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,r){2&n&&Mc("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[he]}),t})();const Cu="VALID",Ud="INVALID",vo="PENDING",bu="DISABLED";function $d(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class Ux{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Cu}get invalid(){return this.status===Ud}get pending(){return this.status==vo}get disabled(){return this.status===bu}get enabled(){return this.status!==bu}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Ox(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Ox(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Px(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Px(e,this._rawAsyncValidators))}hasValidator(e){return Bd(this._rawValidators,e)}hasAsyncValidator(e){return Bd(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=vo,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const n=this._parentMarkedDirty(e.onlySelf);this.status=bu,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:n}),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const n=this._parentMarkedDirty(e.onlySelf);this.status=Cu,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:n}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Cu||this.status===vo)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?bu:Cu}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=vo,this._hasOwnPendingAsyncValidator=!0;const n=bx(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(!1!==n.emitEvent)}get(e){let n=e;return null==n||(Array.isArray(n)||(n=n.split(".")),0===n.length)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){const r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new yt,this.statusChanges=new yt}_calculateStatus(){return this._allControlsDisabled()?bu:this.errors?Ud:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(vo)?vo:this._anyControlsHaveStatus(Ud)?Ud:Cu}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){$d(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function P8(t){return Array.isArray(t)?Sv(t):t||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function R8(t){return Array.isArray(t)?Tv(t):t||null}(this._rawAsyncValidators)}}const _o=new $("CallSetDisabledState",{providedIn:"root",factory:()=>Hd}),Hd="always";function Iu(t,e,n=Hd){(function Rv(t,e){const n=function Nx(t){return t._rawValidators}(t);null!==e.validator?t.setValidators(xx(n,e.validator)):"function"==typeof n&&t.setValidators([n]);const r=function Fx(t){return t._rawAsyncValidators}(t);null!==e.asyncValidator?t.setAsyncValidators(xx(r,e.asyncValidator)):"function"==typeof r&&t.setAsyncValidators([r]);const i=()=>t.updateValueAndValidity();zd(e._rawValidators,i),zd(e._rawAsyncValidators,i)})(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||"always"===n)&&e.valueAccessor.setDisabledState?.(t.disabled),function V8(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&$x(t,e)})}(t,e),function j8(t,e){const n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}(t,e),function B8(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&$x(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function L8(t,e){if(e.valueAccessor.setDisabledState){const n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}(t,e)}function zd(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function $x(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function qx(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function zx(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const Wx=class extends Ux{constructor(e=null,n,r){super(function Fv(t){return($d(t)?t.validators:t)||null}(n),function Ov(t,e){return($d(e)?e.asyncValidators:t)||null}(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),$d(n)&&(n.nonNullable||n.initialValueIsDefault)&&(this.defaultValue=zx(e)?e.value:e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==n.emitViewToModelChange)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){qx(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){qx(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){zx(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},K8={provide:Zr,useExisting:ye(()=>jv)},Yx=(()=>Promise.resolve())();let jv=(()=>{class t extends Zr{constructor(n,r,i,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new Wx,this._registered=!1,this.update=new yt,this._parent=n,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function Vv(t,e){if(!e)return null;let n,r,i;return Array.isArray(e),e.forEach(s=>{s.constructor===Ld?n=s:function H8(t){return Object.getPrototypeOf(t.constructor)===Qi}(s)?r=s:i=s}),i||r||n||null}(0,s)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const r=n.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),function Lv(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)}(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Iu(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){Yx.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const r=n.isDisabled.currentValue,i=0!==r&&function Fp(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}(r);Yx.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?function Gd(t,e){return[...e.path,t]}(n,this._parent):[n]}}return t.\u0275fac=function(n){return new(n||t)(S(Pt,9),S(Et,10),S(Yr,10),S(jn,10),S(n0,8),S(_o,8))},t.\u0275dir=W({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ie([K8]),he,Wn]}),t})(),Xx=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=mr({type:t}),t.\u0275inj=$n({}),t})(),_4=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=mr({type:t}),t.\u0275inj=$n({imports:[Xx]}),t})(),w4=(()=>{class t{static withConfig(n){return{ngModule:t,providers:[{provide:_o,useValue:n.callSetDisabledState??Hd}]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=mr({type:t}),t.\u0275inj=$n({imports:[_4]}),t})();function E4(t,e){if(1&t&&(di(0,"p"),Nc(1),function ub(t,e){const n=re();let r;const i=t+we;n.firstCreatePass?(r=function sV(t,e){if(e)for(let n=e.length-1;n>=0;n--){const r=e[n];if(t===r.name)return r}}(e,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks??(n.destroyHooks=[])).push(i,r.onDestroy)):r=n.data[i];const s=r.factory||(r.factory=ri(r.type)),o=nn(S);try{const a=Yu(!1),u=s();return Yu(a),function jR(t,e,n,r){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=r}(n,C(),i,u),u}finally{nn(o)}}(2,"json"),hi()),2&t){const n=e.$implicit;gc(1),Fc(" ",cb(2,1,n),"\n")}}let C4=(()=>{class t{constructor(n){this.fireService=n,this.title="frontend"}}return t.\u0275fac=function(n){return new(n||t)(S(u8))},t.\u0275cmp=F_({type:t,selectors:[["app-root"]],decls:6,vars:2,consts:[[3,"ngModel","ngModelChange"],[3,"click"],[4,"ngFor","ngForOf"]],template:function(n,r){1&n&&(di(0,"h1"),Nc(1,"Hello Welcome"),hi(),di(2,"input",0),Zt("ngModelChange",function(s){return r.sendThisMessage=s}),hi(),di(3,"button",1),Zt("click",function(){return r.fireService.sendMessage(r.sendThisMessage)}),Nc(4,"Send Message"),hi(),function CE(t,e,n,r,i,s,o,a){const u=C(),c=re(),l=t+we,d=c.firstCreatePass?function BR(t,e,n,r,i,s,o,a,u){const c=e.consts,l=Ds(e,t,4,o||null,yr(c,a));kf(e,n,l,yr(c,u)),qu(e,l);const d=l.tView=Rf(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}(l,c,u,e,n,r,i,s,o):c.data[l];In(d,!1);const h=u[J].createComment("");oc(c,u,h,d),gt(h,u),_c(u,u[l]=rE(h,u,h,d)),$u(d)&&Of(c,u,d),null!=o&&Pf(u,d,a)}(5,E4,3,3,"p",2)),2&n&&(gc(2),Sc("ngModel",r.sendThisMessage),gc(3),Sc("ngForOf",r.fireService.message))},dependencies:[b0,Ld,Lx,jv,A0]}),t})(),b4=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=mr({type:t,bootstrap:[C4]}),t.\u0275inj=$n({imports:[qj,w4]}),t})();Gj().bootstrapModule(b4).catch(t=>console.error(t))}},Kd=>{Kd(Kd.s=445)}]);